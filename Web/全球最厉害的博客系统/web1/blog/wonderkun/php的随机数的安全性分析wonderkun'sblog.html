<!DOCTYPE html>

<html lang="zh-cn">
<head>
<title>php的随机数的安全性分析 | wonderkun's|blog</title>
<link href="./php的随机数的安全性分析  wonderkun'sblog/style.css" rel="stylesheet"/>
<link href="./php的随机数的安全性分析  wonderkun'sblog/style.opacity.css" rel="stylesheet"/>
<link href="./php的随机数的安全性分析  wonderkun'sblog/11" rel="profile">
<link href="http://wonderkun.cc/index.html/xmlrpc.php" rel="pingback">
<link href="" rel="shortcut icon" type="image/x-icon"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible"/>
<meta content="dimpurr" name="author"/>
<meta content="wonderkun's|blog" name="application-name"/>
<meta charset="utf-8"/>
<link href="./php的随机数的安全性分析  wonderkun'sblog/index.html" rel="home"/>
<link href="./php的随机数的安全性分析  wonderkun'sblog/feed=rss2" rel="alternate" title="RSS 2.0" type="application/rss+xml"/>
<link href="./php的随机数的安全性分析  wonderkun'sblog/feed=rss" rel="alternate" title="RSS 1.0" type="application/rdf+xml"/>
<link href="./php的随机数的安全性分析  wonderkun'sblog/feed=atom" rel="alternate" title="ATOM 1.0" type="application/atom+xml"/>
<!--[if lt IE 9]>
<script src="http://wonderkun.cc/index.html/wp-content/themes/clearision/js/html5.js" type="text/javascript"></script>
<![endif]-->
<link href="./php的随机数的安全性分析  wonderkun'sblog/feed=rss2&amp;p=585" rel="alternate" title="wonderkun's|blog » php的随机数的安全性分析评论Feed" type="application/rss+xml"/>
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/wonderkun.cc\/index.html\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.5.9"}};
			!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;if(!g||!g.fillText)return!1;switch(g.textBaseline="top",g.font="600 32px Arial",a){case"flag":return g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3;case"diversity":return g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,d=c[0]+","+c[1]+","+c[2]+","+c[3],g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e;case"simple":return g.fillText(h(55357,56835),0,0),0!==g.getImageData(16,16,1,1).data[0];case"unicode8":return g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link href="./php的随机数的安全性分析  wonderkun'sblog/rest_route=" rel="https://api.w.org/"/>
<link href="http://wonderkun.cc/index.html/xmlrpc.php?rsd" rel="EditURI" title="RSD" type="application/rsd+xml"/>
<link href="./php的随机数的安全性分析  wonderkun'sblog/wlwmanifest.xml" rel="wlwmanifest" type="application/wlwmanifest+xml"/>
<link href="./php的随机数的安全性分析  wonderkun'sblog/p=577" rel="prev" title="有意思的线性表操作(捡起我遗忘多年的c语言)"/>
<meta content="WordPress 4.5.9" name="generator"/>
<link href="./php的随机数的安全性分析  wonderkun'sblog/p=585" rel="canonical"/>
<link href="./php的随机数的安全性分析  wonderkun'sblog/p=585" rel="shortlink"/>
<link href="./php的随机数的安全性分析  wonderkun'sblog/rest_route=%2Foembed%2F1.0%2Fembed&amp;url=http%3A%2F%2Fwonderkun.cc%2Findex.html%2F%3Fp%3D585" rel="alternate" type="application/json+oembed"/>
<link href="./php的随机数的安全性分析  wonderkun'sblog/rest_route=%2Foembed%2F1.0%2Fembed&amp;url=http%3A%2F%2Fwonderkun.cc%2Findex.html%2F%3Fp%3D585&amp;format=xml" rel="alternate" type="text/xml+oembed"/>
<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
<style id="syntaxhighlighteranchor" type="text/css"></style>
</link></link></head>
<body class="single single-post postid-585 single-format-standard">
<div id="page">
<hgroup id="ctn_header">
<div id="title">
<h1 id="site-title"><span><a href="http://wonderkun.cc/index.html/" rel="home" title="wonderkun's|blog">wonderkun's|blog</a></span></h1>
<h2 id="site-description">share with you!!</h2>
</div>
<div id="title_r">
<a href="http://wonderkun.cc" target="_blank" title="个人页"><button class="tr_profile"></button></a>
<a href="http://user.qzone.qq.com/729173164" target="_blank" title="QQ"><button class="tr_qqw"></button></a>
<a href="http://github.com/wonderkun" target="_blank" title="Github"><button class="tr_github"></button></a>
<a href="http://wonderkun.cc/index.html/?feed=rss2" target="_blank"><button id="tr_rss"></button></a>
<a href="http://wonderkun.cc/index.html/wp-admin/" target="_blank"><button id="tr_admin"></button></a>
<span id="tr_clear"></span>
<form action="http://wonderkun.cc/index.html/" id="tr_s_f" method="get">
<input id="s" name="s" placeholder="" size="10" type="text"/>
</form>
</div>
<div class="clearfix"></div>
</hgroup>
<div id="float">
<a href="http://wonderkun.cc/index.html/" rel="home" title="wonderkun's|blog"><img alt="wonderkun's|blog" id="logo" src="./php的随机数的安全性分析  wonderkun'sblog/09451H922-11.jpg" title="wonderkun's|blog"/></a>
<nav id="nav" role="navigation">
<div class="menu-%e4%b8%bb%e8%8f%9c%e5%8d%95-container"><ul class="menu" id="menu-%e4%b8%bb%e8%8f%9c%e5%8d%95"><li class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-18" id="menu-item-18"><a href="http://wonderkun.cc/index.html/?cat=1">hack_ctf</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-19" id="menu-item-19"><a href="http://wonderkun.cc/index.html/?cat=6">linux</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-20" id="menu-item-20"><a href="http://wonderkun.cc/index.html/?cat=7">代码控</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-21" id="menu-item-21"><a href="http://wonderkun.cc/index.html/?cat=8">技术宅</a></li>
</ul></div></nav>
<nav id="next" role="sencond_navigation">
<div class="menu-%e8%be%85%e5%8a%a9%e8%8f%9c%e5%8d%95-container"><ul class="menu" id="menu-%e8%be%85%e5%8a%a9%e8%8f%9c%e5%8d%95"><li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-23" id="menu-item-23"><a href="http://wonderkun.cc/index.html/?cat=9">名站推荐</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-24" id="menu-item-24"><a href="http://wonderkun.cc/index.html/?cat=10">我们的故事</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-25" id="menu-item-25"><a href="http://wonderkun.cc/index.html/?cat=11">技术共享</a></li>
<li class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-26" id="menu-item-26"><a href="http://wonderkun.cc/index.html/?cat=12">资源分享</a></li>
</ul></div></nav>
</div>
<div id="ctn">
<div id="content">
<article class="post_ctn">
<hgroup class="post_hctn">
<div class="post_time">
<div class="post_t_d">03/16</div>
<div class="post_t_u">14:18</div>
</div>
<div class="post_h_l">
<span class="post_ct"><a href="http://wonderkun.cc/index.html/?cat=1" rel="category">hack_ctf</a></span>
<h2 class="post_h"><a href="http://wonderkun.cc/index.html/?p=585">php的随机数的安全性分析</a></h2>
<div class="post_tag">
<span class="post_c"><a class="wp-postviews">wonderkun 撰写</a></span>
<span class="post_c"><a href="http://wonderkun.cc/index.html/?p=585#comments">11条回复</a></span>
<span class="post_c"></span>
</div>
</div>
</hgroup>
<div class="post_t"><h2>php的随机数的安全性分析</h2>
<p>在php中,产生随机数的方法有 rand()函数和mt_rand()函数,官方说mt_rand()函数要比rand()函数的速度快四倍,至于到底是不是这样的?他们两个的区别到底在哪,不是今天要讨论的重点,今天要说的是这两个函数的安全性问题.</p>
<p>说到rand()函数和mt_rand()函数,我们就不得不说到与他们相对应的两个播种随机数种子的函数,srand() 和 mt_srand()<br/>
我们来看如下代码:</p>
<pre class="brush: php; title: ; notranslate" title="">
&lt;?
mt_srand(1234);
srand(123);
echo "rand 函数在种子是1234时产生的随机数序列:\n";
for($i=1;$i&lt;5;$i++){
   echo rand()."\n";
}
echo "mt_rand 函数在种子是1234时产生的随机数序列:\n";
for($i=1;$i&lt;5;$i++){
   echo mt_rand()."\n";
}
?&gt;
</pre>
<p><img alt="1" class="alignnone size-full wp-image-586" height="739" sizes="(max-width: 618px) 100vw, 618px" src="./php的随机数的安全性分析  wonderkun'sblog/1.png" srcset="http://wonderkun.cc/index.html/wp-content/uploads/2017/03/1.png 618w, http://wonderkun.cc/index.html/wp-content/uploads/2017/03/1-251x300.png 251w" width="618"><br/>
测试发现无论是rand()函数还是mt_rand()函数,当随机数种子相同的时候,无论运行多少次,产生的随机数序列都是一样的,所以如果我们在代码中自己播种了随机数种子,但是泄露了这个种子,就会导致产生的随机数序列被别人猜到,造成安全问题.</img></p>
<p>但是在 php  &gt; 4.2.0 的版本中,不再需要手动用 srand() 或 mt_srand() 函数给随机数发生器播种了，已自动完成。也就是说随机数种子不用我们给了,php会自动播种一个种子,这样就不存在种子泄露的问题了,但是这样就安全了吗?</p>
<p>我们继续往下面看:</p>
<h3>mt_rand() 函数的安全性问题</h3>
<pre class="brush: bash; title: ; notranslate" title="">
php -r 'echo getrandmax()."\n".mt_getrandmax()."\n"; echo (pow(2,31)-1)."\n";'
</pre>
<p><img alt="2" class="alignnone size-full wp-image-587" height="246" sizes="(max-width: 1241px) 100vw, 1241px" src="./php的随机数的安全性分析  wonderkun'sblog/2.png" srcset="http://wonderkun.cc/index.html/wp-content/uploads/2017/03/2.png 1241w, http://wonderkun.cc/index.html/wp-content/uploads/2017/03/2-300x59.png 300w, http://wonderkun.cc/index.html/wp-content/uploads/2017/03/2-768x152.png 768w, http://wonderkun.cc/index.html/wp-content/uploads/2017/03/2-1024x203.png 1024w" width="1241"/></p>
<p>在我的 linux 64 位系统中,rand() 和 mt_rand() 产生的最大随机数都是2147483647,<br/>
正好是 2^31-1 , 也就是说随机播种的种子也是在这个范围中,0 – 2147483647 的这个范围是允许我们进行爆破的. 但是用 php爆破比较慢,有大牛已经用c写了一个爆破种子程序php_mt_seed,请参考这里<a href="http://www.openwall.com/php_mt_seed/">http://www.openwall.com/php_mt_seed/</a></p>
<p>下面演示一下它的用法:</p>
<p><img alt="3" class="alignnone size-full wp-image-588" height="501" sizes="(max-width: 950px) 100vw, 950px" src="./php的随机数的安全性分析  wonderkun'sblog/3.png" srcset="http://wonderkun.cc/index.html/wp-content/uploads/2017/03/3.png 950w, http://wonderkun.cc/index.html/wp-content/uploads/2017/03/3-300x158.png 300w, http://wonderkun.cc/index.html/wp-content/uploads/2017/03/3-768x405.png 768w" width="950"/></p>
<p>在例子中,我没有自己播种种子,而是让php自动去播种一个种子并产生一个随机数,然后用 php_mt_seed 这个工具把产生的随机数作为参数,去爆破种子,最后的得到了四个结果.<br/>
经过验证,四个结果都是对的.都会产生这样的一个随机数.</p>
<p>但是还有一个疑问,就是 php manual 中说,自动播种种子是指:在每次调用 mt_rand()函数之前都播种一次种子呢,还是多次调用 mt_rand()函数之前,只播种一次种子呢,这对于我们能否猜到产生的随机数序列至关重要.</p>
<p>看下面的测试:</p>
<p><img alt="4" class="alignnone size-full wp-image-589" height="623" sizes="(max-width: 1094px) 100vw, 1094px" src="./php的随机数的安全性分析  wonderkun'sblog/4.png" srcset="http://wonderkun.cc/index.html/wp-content/uploads/2017/03/4.png 1094w, http://wonderkun.cc/index.html/wp-content/uploads/2017/03/4-300x171.png 300w, http://wonderkun.cc/index.html/wp-content/uploads/2017/03/4-768x437.png 768w, http://wonderkun.cc/index.html/wp-content/uploads/2017/03/4-1024x583.png 1024w" width="1094"/></p>
<p>在测试中,在没有进行手工播种的情况下产生两个连续的随机数,然后去爆破种子,得到了四个可能种子,经过测试发现其中一个种子产生的随机数序列和预期的相同,<strong>所以可以猜想在php中产生一系列的随机数时,只进行了一次播种!</strong></p>
<p>那请考虑下面代码的安全性:</p>
<pre class="brush: php; title: ; notranslate" title="">
&lt;?php
function wp_generate_password($length = 12, $special_chars = true) {
  $chars = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
  if ( $special_chars )
  $chars .= '!@#$%^&amp;*()';

  $password = '';
  for ( $i = 0; $i &lt; $length; $i++ )
  $password .= substr($chars, mt_rand(0, strlen($chars) - 1), 1);
  return $password;
}
$key = wp_generate_password(16, false);
echo "[*] This is a key for public:".$key."\n";

$private = wp_generate_password(10,false);
echo "[*] Create a private key which you don't know:".$private."\n";
?&gt;
</pre>
<p>我们是否可以根据公开的key,猜到 $private 呢?<br/>
运行一次上面的代码:</p>
<pre class="brush: bash; title: ; notranslate" title="">
njctf$ php mtRand.php
[*] This is a key for public:uS66FDD9LCR62UV3
[*] Create a private key which you don\'t know:t3JSUHzYAv
</pre>
<p>下面演示破解过程,首先获得public key在每一位在字符串中的位置:</p>
<pre class="brush: php; title: ; notranslate" title="">
&lt;?php
$str = "uS66FDD9LCR62UV3";
$randStr = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

for($i=0;$i&lt;strlen($str);$i++){
   $pos = strpos($randStr,$str[$i]);
   echo $pos." ".$pos." "."0 ".(strlen($randStr)-1)." ";
   //整理成方便 php_mt_seed 测试的格式
  //php_mt_seed VALUE_OR_MATCH_MIN [MATCH_MAX [RANGE_MIN RANGE_MAX]]
}
echo "\n";
?&gt;
</pre>
<p>然后用 php_mt_seed 进行破解,这个需要的时间还是挺长的,几分钟左右.</p>
<p><img alt="5" class="alignnone size-full wp-image-590" height="261" sizes="(max-width: 1919px) 100vw, 1919px" src="./php的随机数的安全性分析  wonderkun'sblog/5.png" srcset="http://wonderkun.cc/index.html/wp-content/uploads/2017/03/5.png 1919w, http://wonderkun.cc/index.html/wp-content/uploads/2017/03/5-300x41.png 300w, http://wonderkun.cc/index.html/wp-content/uploads/2017/03/5-768x104.png 768w, http://wonderkun.cc/index.html/wp-content/uploads/2017/03/5-1024x139.png 1024w" width="1919"/></p>
<p>已经成功的破解了一个seed,下面看这个seed对不对:</p>
<pre class="brush: php; title: ; notranslate" title="">
&lt;?php
function wp_generate_password($length = 12, $special_chars = true) {
  $chars = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
  if ( $special_chars )
  $chars .= '!@#$%^&amp;*()';

  $password = '';
  for ( $i = 0; $i &lt; $length; $i++ )
  $password .= substr($chars, mt_rand(0, strlen($chars) - 1), 1);
  return $password;
}
mt_srand(4030923041); //手工添加了这个种子
$key = wp_generate_password(16, false);
echo "[*] This is a key for public:".$key."\n";
$private = wp_generate_password(10,false);
echo "[*] Create a private key which you don't know:".$private."\n";
?&gt;
</pre>
<p>跟刚才的结果一模一样 :</p>
<p><img alt="6" class="alignnone size-full wp-image-591" height="171" sizes="(max-width: 898px) 100vw, 898px" src="./php的随机数的安全性分析  wonderkun'sblog/6.png" srcset="http://wonderkun.cc/index.html/wp-content/uploads/2017/03/6.png 898w, http://wonderkun.cc/index.html/wp-content/uploads/2017/03/6-300x57.png 300w, http://wonderkun.cc/index.html/wp-content/uploads/2017/03/6-768x146.png 768w" width="898"/></p>
<p>这样就说明了,我们只需要拿到public key,就可以预测到private key 的值了.</p>
<p>接下来看一个 njctf中的一个例子,只贴部分关键代码:</p>
<pre class="brush: php; title: ; notranslate" title="">
&lt;?php
function random_str($length = "32")
{
    $set = array("a", "A", "b", "B", "c", "C", "d", "D", "e", "E", "f", "F",
        "g", "G", "h", "H", "i", "I", "j", "J", "k", "K", "l", "L",
        "m", "M", "n", "N", "o", "O", "p", "P", "q", "Q", "r", "R",
        "s", "S", "t", "T", "u", "U", "v", "V", "w", "W", "x", "X",
        "y", "Y", "z", "Z", "1", "2", "3", "4", "5", "6", "7", "8", "9");
    $str = '';
    for ($i = 1; $i &lt;= $length; ++$i) {
        $ch = mt_rand(0, count($set) - 1);
        $str .= $set[$ch];
    }
    return $str;
}
session_start();

$seed = rand(0,999999999);
mt_srand($seed);
$ss = mt_rand();
$hash = md5(session_id() . $ss);
setcookie('SESSI0N', $hash, time() + 3600);

$filename = './uP1O4Ds/' . random_str() . '_' . $_FILES['file-upload-field']['name'];
?&gt;
</pre>
<p>我们的目标是猜测出filename.<br/>
这里 $seed 是 rand(0,999999999)生成的,我们不知道,但是$hash = md5(session_id() . $ss);我们却是知道的,在 cookie的SESSION中,当把cookie中的 PHPSESSID 设为空的时候,session_id()就也是空了,通过结hash,就可以获得 mt_rand() 产生的第一个随机数,然后用 php_mt_seed这工工具爆破种子,就可以直接算出文件名了.</p>
<h3>rand() 函数的安全性问题</h3>
<p>rand() 函数在产生随机数的时候没有调用 srand(),则产生的随机数是有规律可询的.<br/>
具体的说明请看这里<a href="http://www.sjoerdlangkemper.nl/2016/02/11/cracking-php-rand/">http://www.sjoerdlangkemper.nl/2016/02/11/cracking-php-rand/</a><br/>
产生的随机数可以用下面这个公式预测 : state[i] = state[i-3] + state[i-31] (一般预测值可能比实际值要差1)<br/>
写下面测试代码,验证一下:</p>
<pre class="brush: php; title: ; notranslate" title="">
&lt;?php
$randStr = array();
for($i=0;$i&lt;50;$i++){  //先产生 32个随机数
    $randStr[$i]=rand(0,30);
    if($i&gt;=31) {
        echo  "$randStr[$i]=(".$randStr[$i-31]."+".$randStr[$i-3].") mod 31"."\n";
    }
}
?&gt;
</pre>
<p>看一下结果:</p>
<p><img alt="7" class="alignnone size-full wp-image-592" height="454" sizes="(max-width: 672px) 100vw, 672px" src="./php的随机数的安全性分析  wonderkun'sblog/7.png" srcset="http://wonderkun.cc/index.html/wp-content/uploads/2017/03/7.png 672w, http://wonderkun.cc/index.html/wp-content/uploads/2017/03/7-300x203.png 300w" width="672"/></p>
<p>发现预测的值,基本都是对的,这样就可以根据之前生成的随机数,预测之后产生的随机数.<br/>
因为这个缺陷,我还出过一个题目,题目在这里<a href="https://github.com/wonderkun/CTF_web/tree/master/web500-2">https://github.com/wonderkun/CTF_web/tree/master/web500-2</a></p>
<p>writeup已经上传,想学习的,赶紧去看.</p>
</div>
<nav id="post_nav">
<span id="p_n_l"><a href="http://wonderkun.cc/index.html/?p=577" rel="prev">← 有意思的线性表操作(捡起我遗忘多年的c语言)</a></span>
<span id="p_n_r"></span>
</nav>
<div class="cmt" id="cmt">
<ol class="cmt_list">
<li class="comment even thread-even depth-1" id="li-comment-708">
<article class="comment" id="comment-708">
<header class="comment-meta comment-author vcard">
<img alt="" class="avatar avatar-44 photo" height="44" src="./php的随机数的安全性分析  wonderkun'sblog/2309510527760d5a44726ca6f7e2352as=44&amp;d=monsterid&amp;r=g" srcset="http://2.gravatar.com/avatar/2309510527760d5a44726ca6f7e2352a?s=88&amp;d=monsterid&amp;r=g 2x" width="44"/><div class="cmt_meta_head"><cite class="fn">idlefire </cite></div><span class="cmt_meta_time"><a href="http://wonderkun.cc/index.html/?p=585#comment-708"><time datetime="2017-03-19T21:25:48+00:00">2017年3月19日 下午9:25</time></a></span> </header>
<section class="comment-content comment">
<p>那个破解脚本有些mt_rand值不能破解…</p>
<a aria-label="回复给idlefire" class="comment-reply-link" href="http://wonderkun.cc/index.html/?p=585&amp;replytocom=708#respond" onclick='return addComment.moveForm( "comment-708", "708", "respond", "585" )' rel="nofollow">回复</a> </section>
</article>
<ol class="children">
<li class="comment byuser comment-author-wonderkun bypostauthor odd alt depth-2" id="li-comment-712">
<article class="comment" id="comment-712">
<header class="comment-meta comment-author vcard">
<img alt="" class="avatar avatar-44 photo" height="44" src="./php的随机数的安全性分析  wonderkun'sblog/596d96c866a847a44edb8e4a2529e4d0s=44&amp;d=monsterid&amp;r=g" srcset="http://2.gravatar.com/avatar/596d96c866a847a44edb8e4a2529e4d0?s=88&amp;d=monsterid&amp;r=g 2x" width="44"/><div class="cmt_meta_head"><cite class="fn">wonderkun<span class="cmt_meta_auth"> 文章作者</span> </cite></div><span class="cmt_meta_time"><a href="http://wonderkun.cc/index.html/?p=585#comment-712"><time datetime="2017-03-20T10:27:31+00:00">2017年3月20日 上午10:27</time></a></span> </header>
<section class="comment-content comment">
<p>额?  是破解需要很长时间呢?还是不能破解呢?   没有仔细的读那个脚本!</p>
<a aria-label="回复给wonderkun" class="comment-reply-link" href="http://wonderkun.cc/index.html/?p=585&amp;replytocom=712#respond" onclick='return addComment.moveForm( "comment-712", "712", "respond", "585" )' rel="nofollow">回复</a> </section>
</article>
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="li-comment-715">
<article class="comment" id="comment-715">
<header class="comment-meta comment-author vcard">
<img alt="" class="avatar avatar-44 photo" height="44" src="./php的随机数的安全性分析  wonderkun'sblog/34be3c7c0655313619d9b91a7e6f1ee6s=44&amp;d=monsterid&amp;r=g" srcset="http://0.gravatar.com/avatar/34be3c7c0655313619d9b91a7e6f1ee6?s=88&amp;d=monsterid&amp;r=g 2x" width="44"/><div class="cmt_meta_head"><cite class="fn"><a class="url" href="http://1" rel="external nofollow">嘿嘿嘿</a> </cite></div><span class="cmt_meta_time"><a href="http://wonderkun.cc/index.html/?p=585#comment-715"><time datetime="2017-03-21T14:01:28+00:00">2017年3月21日 下午2:01</time></a></span> </header>
<section class="comment-content comment">
<p>你用的deepin</p>
<a aria-label="回复给嘿嘿嘿" class="comment-reply-link" href="http://wonderkun.cc/index.html/?p=585&amp;replytocom=715#respond" onclick='return addComment.moveForm( "comment-715", "715", "respond", "585" )' rel="nofollow">回复</a> </section>
</article>
<ol class="children">
<li class="comment byuser comment-author-wonderkun bypostauthor odd alt depth-2" id="li-comment-716">
<article class="comment" id="comment-716">
<header class="comment-meta comment-author vcard">
<img alt="" class="avatar avatar-44 photo" height="44" src="./php的随机数的安全性分析  wonderkun'sblog/596d96c866a847a44edb8e4a2529e4d0s=44&amp;d=monsterid&amp;r=g" srcset="http://2.gravatar.com/avatar/596d96c866a847a44edb8e4a2529e4d0?s=88&amp;d=monsterid&amp;r=g 2x" width="44"/><div class="cmt_meta_head"><cite class="fn">wonderkun<span class="cmt_meta_auth"> 文章作者</span> </cite></div><span class="cmt_meta_time"><a href="http://wonderkun.cc/index.html/?p=585#comment-716"><time datetime="2017-03-21T14:11:06+00:00">2017年3月21日 下午2:11</time></a></span> </header>
<section class="comment-content comment">
<p>是的,觉得很好用.  你也是deepin粉?</p>
<a aria-label="回复给wonderkun" class="comment-reply-link" href="http://wonderkun.cc/index.html/?p=585&amp;replytocom=716#respond" onclick='return addComment.moveForm( "comment-716", "716", "respond", "585" )' rel="nofollow">回复</a> </section>
</article>
</li><!-- #comment-## -->
<li class="comment even depth-2" id="li-comment-733">
<article class="comment" id="comment-733">
<header class="comment-meta comment-author vcard">
<img alt="" class="avatar avatar-44 photo" height="44" src="./php的随机数的安全性分析  wonderkun'sblog/3f12ecc062114b73c9f47ea0085a92f4s=44&amp;d=monsterid&amp;r=g" srcset="http://0.gravatar.com/avatar/3f12ecc062114b73c9f47ea0085a92f4?s=88&amp;d=monsterid&amp;r=g 2x" width="44"/><div class="cmt_meta_head"><cite class="fn"><a class="url" href="http://rxefekalasu.com" rel="external nofollow">Amberly</a> </cite></div><span class="cmt_meta_time"><a href="http://wonderkun.cc/index.html/?p=585#comment-733"><time datetime="2017-03-28T02:54:40+00:00">2017年3月28日 上午2:54</time></a></span> </header>
<section class="comment-content comment">
<p>I’m impressed by your writing. Are you a professional or just very knegaedwolble?</p>
<a aria-label="回复给Amberly" class="comment-reply-link" href="http://wonderkun.cc/index.html/?p=585&amp;replytocom=733#respond" onclick='return addComment.moveForm( "comment-733", "733", "respond", "585" )' rel="nofollow">回复</a> </section>
</article>
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="li-comment-721">
<article class="comment" id="comment-721">
<header class="comment-meta comment-author vcard">
<img alt="" class="avatar avatar-44 photo" height="44" src="./php的随机数的安全性分析  wonderkun'sblog/a1671365949508a78a788d8c4f26aff2s=44&amp;d=monsterid&amp;r=g" srcset="http://1.gravatar.com/avatar/a1671365949508a78a788d8c4f26aff2?s=88&amp;d=monsterid&amp;r=g 2x" width="44"/><div class="cmt_meta_head"><cite class="fn"><a class="url" href="http://heartsky.info" rel="external nofollow">HeartSky</a> </cite></div><span class="cmt_meta_time"><a href="http://wonderkun.cc/index.html/?p=585#comment-721"><time datetime="2017-03-23T19:29:40+00:00">2017年3月23日 下午7:29</time></a></span> </header>
<section class="comment-content comment">
<p>我想问一个问题<br/>
如果一个php文件只有 echo mt_rand(); 这一行代码<br/>
有办法能保证每次访问时不会再次播种吗？</p>
<a aria-label="回复给HeartSky" class="comment-reply-link" href="http://wonderkun.cc/index.html/?p=585&amp;replytocom=721#respond" onclick='return addComment.moveForm( "comment-721", "721", "respond", "585" )' rel="nofollow">回复</a> </section>
</article>
<ol class="children">
<li class="comment byuser comment-author-wonderkun bypostauthor even depth-2" id="li-comment-724">
<article class="comment" id="comment-724">
<header class="comment-meta comment-author vcard">
<img alt="" class="avatar avatar-44 photo" height="44" src="./php的随机数的安全性分析  wonderkun'sblog/596d96c866a847a44edb8e4a2529e4d0s=44&amp;d=monsterid&amp;r=g" srcset="http://2.gravatar.com/avatar/596d96c866a847a44edb8e4a2529e4d0?s=88&amp;d=monsterid&amp;r=g 2x" width="44"/><div class="cmt_meta_head"><cite class="fn">wonderkun<span class="cmt_meta_auth"> 文章作者</span> </cite></div><span class="cmt_meta_time"><a href="http://wonderkun.cc/index.html/?p=585#comment-724"><time datetime="2017-03-25T08:36:13+00:00">2017年3月25日 上午8:36</time></a></span> </header>
<section class="comment-content comment">
<p>这个没有办法，每次访问这个文件都会重新运行，是重新播种的。</p>
<a aria-label="回复给wonderkun" class="comment-reply-link" href="http://wonderkun.cc/index.html/?p=585&amp;replytocom=724#respond" onclick='return addComment.moveForm( "comment-724", "724", "respond", "585" )' rel="nofollow">回复</a> </section>
</article>
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-773">
<article class="comment" id="comment-773">
<header class="comment-meta comment-author vcard">
<img alt="" class="avatar avatar-44 photo" height="44" src="./php的随机数的安全性分析  wonderkun'sblog/86b4209d3e80f4e0d932ee99c8e8bfa7s=44&amp;d=monsterid&amp;r=g" srcset="http://2.gravatar.com/avatar/86b4209d3e80f4e0d932ee99c8e8bfa7?s=88&amp;d=monsterid&amp;r=g 2x" width="44"/><div class="cmt_meta_head"><cite class="fn"><a class="url" href="http://aa" rel="external nofollow">wddee</a> </cite></div><span class="cmt_meta_time"><a href="http://wonderkun.cc/index.html/?p=585#comment-773"><time datetime="2017-04-09T16:19:10+00:00">2017年4月9日 下午4:19</time></a></span> </header>
<section class="comment-content comment">
<p>我想问一个问题<br/>
百度杯的’cat’那题也要用到爆破随机数种子吗？</p>
<a aria-label="回复给wddee" class="comment-reply-link" href="http://wonderkun.cc/index.html/?p=585&amp;replytocom=773#respond" onclick='return addComment.moveForm( "comment-773", "773", "respond", "585" )' rel="nofollow">回复</a> </section>
</article>
<ol class="children">
<li class="comment byuser comment-author-wonderkun bypostauthor even depth-2" id="li-comment-774">
<article class="comment" id="comment-774">
<header class="comment-meta comment-author vcard">
<img alt="" class="avatar avatar-44 photo" height="44" src="./php的随机数的安全性分析  wonderkun'sblog/596d96c866a847a44edb8e4a2529e4d0s=44&amp;d=monsterid&amp;r=g" srcset="http://2.gravatar.com/avatar/596d96c866a847a44edb8e4a2529e4d0?s=88&amp;d=monsterid&amp;r=g 2x" width="44"/><div class="cmt_meta_head"><cite class="fn">wonderkun<span class="cmt_meta_auth"> 文章作者</span> </cite></div><span class="cmt_meta_time"><a href="http://wonderkun.cc/index.html/?p=585#comment-774"><time datetime="2017-04-09T20:11:05+00:00">2017年4月9日 下午8:11</time></a></span> </header>
<section class="comment-content comment">
<p>百度杯cat 是哪个题啊,给个地址呗!</p>
<a aria-label="回复给wonderkun" class="comment-reply-link" href="http://wonderkun.cc/index.html/?p=585&amp;replytocom=774#respond" onclick='return addComment.moveForm( "comment-774", "774", "respond", "585" )' rel="nofollow">回复</a> </section>
</article>
<ol class="children">
<li class="comment odd alt depth-3" id="li-comment-777">
<article class="comment" id="comment-777">
<header class="comment-meta comment-author vcard">
<img alt="" class="avatar avatar-44 photo" height="44" src="./php的随机数的安全性分析  wonderkun'sblog/86b4209d3e80f4e0d932ee99c8e8bfa7s=44&amp;d=monsterid&amp;r=g" srcset="http://2.gravatar.com/avatar/86b4209d3e80f4e0d932ee99c8e8bfa7?s=88&amp;d=monsterid&amp;r=g 2x" width="44"/><div class="cmt_meta_head"><cite class="fn"><a class="url" href="http://aa" rel="external nofollow">wddee</a> </cite></div><span class="cmt_meta_time"><a href="http://wonderkun.cc/index.html/?p=585#comment-777"><time datetime="2017-04-10T23:25:45+00:00">2017年4月10日 下午11:25</time></a></span> </header>
<section class="comment-content comment">
<p><a href="http://www.ichunqiu.com/racing/ctf_57773" rel="nofollow">http://www.ichunqiu.com/racing/ctf_57773</a></p>
<a aria-label="回复给wddee" class="comment-reply-link" href="http://wonderkun.cc/index.html/?p=585&amp;replytocom=777#respond" onclick='return addComment.moveForm( "comment-777", "777", "respond", "585" )' rel="nofollow">回复</a> </section>
</article>
<ol class="children">
<li class="comment byuser comment-author-wonderkun bypostauthor even depth-4" id="li-comment-783">
<article class="comment" id="comment-783">
<header class="comment-meta comment-author vcard">
<img alt="" class="avatar avatar-44 photo" height="44" src="./php的随机数的安全性分析  wonderkun'sblog/596d96c866a847a44edb8e4a2529e4d0s=44&amp;d=monsterid&amp;r=g" srcset="http://2.gravatar.com/avatar/596d96c866a847a44edb8e4a2529e4d0?s=88&amp;d=monsterid&amp;r=g 2x" width="44"/><div class="cmt_meta_head"><cite class="fn">wonderkun<span class="cmt_meta_auth"> 文章作者</span> </cite></div><span class="cmt_meta_time"><a href="http://wonderkun.cc/index.html/?p=585#comment-783"><time datetime="2017-04-12T18:51:11+00:00">2017年4月12日 下午6:51</time></a></span> </header>
<section class="comment-content comment">
<p>不知道啊,我看了这个题了,不知道咋做. 可以来交流一下,或者找个师傅讨论一下.</p>
<a aria-label="回复给wonderkun" class="comment-reply-link" href="http://wonderkun.cc/index.html/?p=585&amp;replytocom=783#respond" onclick='return addComment.moveForm( "comment-783", "783", "respond", "585" )' rel="nofollow">回复</a> </section>
</article>
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
</ol>
<div class="comment-respond" id="respond">
<h3 class="comment-reply-title" id="reply-title"> <small><a href="/index.html/?p=585#respond" id="cancel-comment-reply-link" rel="nofollow" style="display:none;">撤销评论</a></small></h3> <form action="http://wonderkun.cc/index.html/wp-comments-post.php" class="comment-form" id="cmt_form" method="post">
<p class="comment-form-comment"><textarea aria-required="true" cols="45" id="comment" name="comment" required="" rows="8"></textarea></p><div id="cmt_form_meta"><input id="author" name="author" placeholder="称呼" required="required" type="text" value=""/>
<input id="email" name="email" placeholder="邮箱" required="required" type="email" value=""/>
<input id="url" name="url" placeholder="站点" type="text" value=""/></div>
<p class="form-submit"><input class="submit" id="cmt_submit" name="submit" type="submit" value="提交"/> <input id="comment_post_ID" name="comment_post_ID" type="hidden" value="585"/>
<input id="comment_parent" name="comment_parent" type="hidden" value="0"/>
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" type="hidden" value="fac35a5ab0"/></p><p style="display: none;"><input id="ak_js" name="ak_js" type="hidden" value="136"/></p> </form>
</div><!-- #respond -->
</div>
</article>
</div>
</div>
<div id="sidebar">
<div class="widget" id="one">
<h2>近期评论</h2><ul id="recentcomments"><li class="recentcomments"><span class="comment-author-link">wonderkun</span>发表在《<a href="http://wonderkun.cc/index.html/?p=585#comment-783">php的随机数的安全性分析</a>》</li><li class="recentcomments"><span class="comment-author-link"><a class="url" href="http://aa" rel="external nofollow">wddee</a></span>发表在《<a href="http://wonderkun.cc/index.html/?p=585#comment-777">php的随机数的安全性分析</a>》</li><li class="recentcomments"><span class="comment-author-link">wonderkun</span>发表在《<a href="http://wonderkun.cc/index.html/?p=585#comment-774">php的随机数的安全性分析</a>》</li><li class="recentcomments"><span class="comment-author-link"><a class="url" href="http://aa" rel="external nofollow">wddee</a></span>发表在《<a href="http://wonderkun.cc/index.html/?p=585#comment-773">php的随机数的安全性分析</a>》</li><li class="recentcomments"><span class="comment-author-link"><a class="url" href="http://rxefekalasu.com" rel="external nofollow">Amberly</a></span>发表在《<a href="http://wonderkun.cc/index.html/?p=585#comment-733">php的随机数的安全性分析</a>》</li><li class="recentcomments"><span class="comment-author-link">wonderkun</span>发表在《<a href="http://wonderkun.cc/index.html/?p=585#comment-724">php的随机数的安全性分析</a>》</li></ul><h2>友情链接</h2>
<ul class="xoxo blogroll">
<li><a href="http://www.bendawang.site" target="_blank">Bendawang</a></li>
<li><a href="http://www.bertramc.cn/" target="_blank">berTrAM</a></li>
<li><a href="http://www.cnblogs.com/iamstudy/">l3m0n</a></li>
<li><a href="http://www.ifuryst.com/" target="_blank">墨麒麟安全实验</a></li>
<li><a href="http://xiaomange.meximas.com/" rel="me" target="_blank">老博客地址</a></li>
</ul>
<h2>好基友</h2>
<ul class="xoxo blogroll">
<li><a href="http://bear2.cn/" rel="friend colleague" target="_blank">pierre94</a></li>
<li><a href="http://range.pw" rel="friend met colleague co-resident" target="_blank">range</a></li>
<li><a href="http://www.yibeizifd.cc/%20%20" target="_blank">yibeizifd</a></li>
<li><a href="http://yichin.url.ph/" rel="friend colleague" target="_blank">yichin</a></li>
</ul>
</div>
<div class="widget" id="two">
</div>
<div class="clearfix"></div>
</div><footer id="footer" role="contentinfo">
<a href="http://dimpurr.com" title="Dimpurr (钉子)">Dimpurr</a>'s 
<a href="http://blog.dimpurr.com/clearision" title="Clearision">Clearision</a><br/>
Powered by <a href="http://wordpress.org/" title="WordPress">WordPress</a>
<script src="./php的随机数的安全性分析  wonderkun'sblog/script.js" type="text/javascript"></script>
<script src="./php的随机数的安全性分析  wonderkun'sblog/form.jsver=3.1.10" type="text/javascript"></script>
<script src="./php的随机数的安全性分析  wonderkun'sblog/shCore.jsver=3.0.9b" type="text/javascript"></script>
<script src="./php的随机数的安全性分析  wonderkun'sblog/shBrushPhp.jsver=3.0.9b" type="text/javascript"></script>
<script src="./php的随机数的安全性分析  wonderkun'sblog/shBrushBash.jsver=3.0.9b" type="text/javascript"></script>
<script type="text/javascript">
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://wonderkun.cc/index.html/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://wonderkun.cc/index.html/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeRDark.css?ver=3.0.9b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '帮助';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = '无法找到Brush：';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush不能设置 html-script选项';
	SyntaxHighlighter.defaults['light'] = true;
	SyntaxHighlighter.defaults['pad-line-numbers'] = 3;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();
</script>
<script src="./php的随机数的安全性分析  wonderkun'sblog/wp-embed.min.jsver=4.5.9" type="text/javascript"></script>
</footer>
</div>
</body>
</html>